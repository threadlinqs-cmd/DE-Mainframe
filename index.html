<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DE-MainFrame V11.15</title>
    <link rel="icon" type="image/png" href="assets/DE-Mainframe-favicon.png">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="boot-screen" class="boot-screen">
        <div class="boot-content">
            <img src="assets/DE-Mainframe-logo.png" alt="DE-MainFrame" class="boot-logo-img">
            <p class="boot-version">V11.15</p>
            <div class="boot-loader"></div>
            <p id="boot-status" class="boot-status">Initializing...</p>
        </div>
    </div>

    <div id="app" class="app hidden">
        <header class="header">
            <div class="header-left">
                <a href="#" onclick="switchView('library'); return false;" class="logo-link">
                    <img src="assets/DE-Mainframe-logo.png" alt="DE-MainFrame" class="header-logo">
                </a>
                <span class="version">V11.15</span>
                <button class="btn-new-ui" onclick="window.location.href='docs/new-ui/'" title="Try the New UI">‚ú® New UI</button>
            </div>
            <nav class="nav">
                <button class="nav-btn active" data-view="library">Library</button>
                <button class="nav-btn" data-view="editor">Editor</button>
                <button class="nav-btn" data-view="revalidation">Revalidation</button>
                <button class="nav-btn" data-view="history">History</button>
                <button class="nav-btn" data-view="resources">Resources</button>
                <button class="nav-btn" data-view="macros">Macros</button>
                <button class="nav-btn" data-view="reports">Reports</button>
            </nav>
            <div class="header-right">
                <div id="sync-status" class="sync-status disconnected"><span class="sync-dot"></span><span class="sync-text">Loading...</span></div>
                <button id="btn-splunk-search" class="btn-icon btn-splunk-icon" title="Open Splunk Search"><img src="assets/splunk-icon.svg" alt="Splunk" class="header-splunk-icon"></button>
                <button id="btn-config" class="btn-icon" title="Settings">‚öôÔ∏è</button>
                <button id="btn-theme" class="btn-icon" title="Toggle Theme">‚òÄÔ∏è</button>
                <button id="btn-refresh" class="btn-icon" title="Refresh Data">üîÑ</button>
                <button id="btn-import" class="btn-icon" title="Import">üì•</button>
                <button id="btn-export" class="btn-icon" title="Export All">üì§</button>
                <button id="btn-new" class="btn-icon" title="New Detection">‚ûï</button>
            </div>
        </header>

        <div id="view-library" class="view active">
            <div class="library-layout-v2">
                <!-- Main content area - Detection Document -->
                <div class="library-main">
                    <div id="detail-placeholder" class="detail-placeholder"><span class="placeholder-icon">üìã</span><p>Select a detection from the sidebar to view documentation</p></div>
                    <div id="library-detail-content" class="library-detail-content hidden">
                        <div class="detail-header">
                            <div class="detail-actions">
                                <button id="btn-detail-correlation" class="btn-splunk" title="Edit Correlation Search in Splunk"><img src="assets/splunk-icon.svg" alt="" class="btn-icon-img"> Correlation</button>
                                <button id="btn-detail-tune" class="btn-tune">üîß Tune</button>
                                <button id="btn-detail-retrofit" class="btn-retrofit">‚ö° Retrofit</button>
                                <button id="btn-detail-metadata" class="btn-secondary">üìã Metadata</button>
                                <button id="btn-detail-edit" class="btn-primary">‚úèÔ∏è Edit</button>
                                <button id="btn-detail-delete" class="btn-danger">üóëÔ∏è</button>
                            </div>
                        </div>
                        <div id="library-detail-body" class="detail-body"></div>
                    </div>
                </div>
                <!-- Sidebar - Filters + Detection List -->
                <div class="library-sidebar">
                    <div class="library-search">
                        <input type="text" id="search-input" class="search-input" placeholder="üîç Search detections...">
                    </div>
                    <div class="library-filters">
                        <div class="filter-row">
                            <select id="filter-severity" class="filter-select"><option value="">All Severities</option><option value="critical">Critical</option><option value="high">High</option><option value="medium">Medium</option><option value="low">Low</option><option value="informational">Informational</option></select>
                            <select id="filter-status" class="filter-select"><option value="">All Status</option><option value="valid">Valid</option><option value="incomplete">Incomplete</option><option value="needs-tune">Needs Tune</option><option value="needs-retrofit">Needs Retrofit</option></select>
                        </div>
                        <div class="filter-row">
                            <select id="filter-domain" class="filter-select"><option value="">All Domains</option><option value="access">Access</option><option value="endpoint">Endpoint</option><option value="network">Network</option><option value="threat">Threat</option><option value="identity">Identity</option><option value="audit">Audit</option></select>
                            <select id="filter-datasource" class="filter-select"><option value="">All Datasources</option></select>
                        </div>
                        <div class="filter-row">
                            <select id="filter-sort" class="filter-select"><option value="name-asc">Name A-Z</option><option value="name-desc">Name Z-A</option><option value="modified-desc">Recently Modified</option><option value="risk-desc">Highest Risk</option></select>
                        </div>
                        <details class="advanced-filters">
                            <summary>More Filters</summary>
                            <div class="advanced-filter-content">
                                <select id="filter-sourcetype" class="filter-select"><option value="">All Sourcetypes</option></select>
                                <select id="filter-mitre" class="filter-select"><option value="">All MITRE</option></select>
                                <select id="filter-origin" class="filter-select"><option value="">All Origins</option></select>
                                <select id="filter-main-search-field" class="filter-select"><option value="">Main Search Fields</option></select>
                                <select id="filter-search-function" class="filter-select"><option value="">Search Functions</option></select>
                                <select id="filter-drilldown-var" class="filter-select"><option value="">Drilldown Vars</option></select>
                            </div>
                        </details>
                    </div>
                    <div class="library-list-header">
                        <span id="library-count">0 detections</span>
                    </div>
                    <div id="library-list" class="library-list"></div>
                </div>
            </div>
        </div>

        <div id="view-editor" class="view">
            <div class="editor-layout-v2">
                <div class="editor-main">
                    <div class="editor-header">
                        <h2 id="editor-detection-name">New Detection</h2>
                        <div class="editor-tabs">
                            <button class="editor-tab active" data-mode="form">Form</button>
                            <button class="editor-tab" data-mode="json">JSON</button>
                            <button class="editor-tab" data-mode="metadata">Metadata</button>
                        </div>
                    </div>
                    <div id="editor-form" class="editor-content active">
                        <form id="detection-form" class="detection-form-v2">
                            <!-- 1. Roles & Ownership -->
                            <div class="form-section" data-section="1">
                                <div class="section-header collapsible" onclick="toggleSection(1)"><span class="collapse-icon">‚ñº</span> 1. Roles & Ownership</div>
                                <div class="section-content">
                                <div class="roles-grid-v2">
                                    <div class="role-card"><div class="role-title">Requestor</div><input type="text" id="role-requestor-name" placeholder="Name"><input type="text" id="role-requestor-title" placeholder="Title"></div>
                                    <div class="role-card"><div class="role-title">Business Owner</div><input type="text" id="role-business-name" placeholder="Name"><input type="text" id="role-business-title" placeholder="Title"></div>
                                    <div class="role-card"><div class="role-title">Technical Owner</div><input type="text" id="role-technical-name" placeholder="Name"><input type="text" id="role-technical-title" placeholder="Title"></div>
                                </div>
                                </div>
                            </div>
                            <!-- 2. Basic Information -->
                            <div class="form-section" data-section="2">
                                <div class="section-header collapsible" onclick="toggleSection(2)"><span class="collapse-icon">‚ñº</span> 2. Basic Information</div>
                                <div class="section-content">
                                <div class="form-grid-4">
                                    <div class="form-group"><label>File Name</label><input type="text" id="field-file_name" placeholder="Auto-generated" readonly class="readonly-field"></div>
                                    <div class="form-group"><label>Schema Version</label><input type="text" id="field-schema_version" value="1.2" readonly class="readonly-field"></div>
                                    <div class="form-group"><label>Origin *</label><select id="field-origin" required><option value="custom">Custom</option><option value="escu">ESCU</option><option value="sigma">Sigma</option></select></div>
                                    <div class="form-group"><label>Security Domain *</label><select id="field-security_domain" required><option value="">Select...</option><option value="access">Access</option><option value="endpoint">Endpoint</option><option value="network">Network</option><option value="threat">Threat</option><option value="identity">Identity</option><option value="audit">Audit</option></select></div>
                                </div>
                                <div class="form-grid-2 equal-cols">
                                    <div class="form-group">
                                        <label>MITRE Technique IDs *</label>
                                        <div class="tag-input-container mitre-full">
                                            <div id="mitre-tags" class="tags tags-inline"></div>
                                            <input type="text" id="mitre-input" placeholder="T1234 or T1234.001 + Enter">
                                        </div>
                                    </div>
                                    <div class="form-group"><label>Detection Name *</label><input type="text" id="field-detection_name" required></div>
                                </div>
                                <div class="form-group full"><label>Objective *</label><textarea id="field-objective" rows="3" required></textarea></div>
                                <div class="form-grid-2">
                                    <div class="form-group"><label>Description *</label><textarea id="field-description" rows="3" required></textarea></div>
                                    <div class="form-group"><label>Assumptions & Potential Impact *</label><textarea id="field-assumptions" rows="3" required></textarea></div>
                                </div>
                                <div class="form-group full">
                                    <label>Required Data Sources (type and press Enter)</label>
                                    <div class="tag-input-container">
                                        <div id="datasource-tags" class="tags"></div>
                                        <input type="text" id="datasource-input" placeholder="Add data source...">
                                    </div>
                                    <small class="field-hint">Auto-populated from Search String. You can also add manually.</small>
                                </div>
                                </div>
                            </div>
                            <!-- 3. Search Configuration -->
                            <div class="form-section" data-section="3">
                                <div class="section-header collapsible" onclick="toggleSection(3)"><span class="collapse-icon">‚ñº</span> 3. Search Configuration</div>
                                <div class="section-content">
                                <div class="form-group full"><label>Search String (SPL) *</label><textarea id="field-search_string" rows="10" required class="spl-input"></textarea></div>
                                <div class="form-grid-2">
                                    <div class="form-group"><label>Splunk App Context</label><input type="text" id="field-splunk_app_context"></div>
                                    <div class="form-group"><label>Search Duration</label><input type="text" id="field-search_duration" placeholder="-30d@d to +24h@h"></div>
                                </div>
                                </div>
                            </div>
                            <!-- 4. Analyst Response -->
                            <div class="form-section" data-section="4">
                                <div class="section-header collapsible" onclick="toggleSection(4)"><span class="collapse-icon">‚ñº</span> 4. Analyst Response</div>
                                <div class="section-content">
                                <div class="form-group full"><label>Analyst Next Steps *</label><textarea id="field-analyst_next_steps" rows="6" placeholder="Enter numbered steps or bullet points..." required></textarea></div>
                                <div class="form-group full"><label>Blind Spots / False Positives *</label><textarea id="field-blind_spots" rows="3" required></textarea></div>
                                </div>
                            </div>
                            <!-- 5. Notable Event - Splunk -->
                            <div class="form-section collapsed" data-section="5">
                                <div class="section-header collapsible" onclick="toggleSection(5)"><span class="collapse-icon">‚ñ∂</span> 5. Notable Event <span class="splunk-label">- Splunk</span></div>
                                <div class="section-content">
                                <div class="form-group full"><label>Notable Title *</label><input type="text" id="field-notable_title" required></div>
                                <div class="form-group full"><label>Notable Description *</label><textarea id="field-notable_description" rows="2" required></textarea></div>
                                <div class="form-grid-2">
                                    <div class="form-group"><label>Risk Object Field *</label><input type="text" id="field-risk_object_field" required></div>
                                    <div class="form-group"><label>Risk Object Type *</label><select id="field-risk_object_type" required><option value="">Select...</option><option value="system">System</option><option value="user">User</option><option value="other">Other</option></select></div>
                                </div>
                                </div>
                            </div>
                            <!-- 6. Classification & Scheduling - Splunk -->
                            <div class="form-section collapsed" data-section="6">
                                <div class="section-header collapsible" onclick="toggleSection(6)"><span class="collapse-icon">‚ñ∂</span> 6. Classification & Scheduling <span class="splunk-label">- Splunk</span></div>
                                <div class="section-content">
                                <div class="form-grid-4">
                                    <div class="form-group"><label>Severity *</label><select id="field-severity" required><option value="">Select...</option><option value="critical">Critical</option><option value="high">High</option><option value="medium">Medium</option><option value="low">Low</option><option value="informational">Informational</option></select></div>
                                    <div class="form-group"><label>Risk Score *</label><input type="number" id="field-risk_score" min="0" max="100" required></div>
                                    <div class="form-group"><label>First Created</label><input type="date" id="field-first_created"></div>
                                    <div class="form-group"><label>Last Modified</label><input type="text" id="field-last_modified" readonly class="readonly-field"></div>
                                </div>
                                <div class="form-grid-4">
                                    <div class="form-group"><label>Cron Schedule</label><input type="text" id="field-cron_schedule" placeholder="*/15 * * * *"></div>
                                    <div class="form-group"><label>Schedule Window</label><input type="text" id="field-schedule_window"></div>
                                    <div class="form-group"><label>Schedule Priority</label><select id="field-schedule_priority"><option value="default">Default</option><option value="higher">Higher</option><option value="highest">Highest</option></select></div>
                                    <div class="form-group"><label>Trigger Condition</label><input type="text" id="field-trigger_condition"></div>
                                </div>
                                <div class="form-grid-3">
                                    <div class="form-group"><label>Throttle Enabled</label><select id="field-throttling_enabled"><option value="0">No</option><option value="1">Yes</option></select></div>
                                    <div class="form-group"><label>Throttle Fields</label><input type="text" id="field-throttling_fields"></div>
                                    <div class="form-group"><label>Throttle Period</label><input type="text" id="field-throttling_period" placeholder="3600s"></div>
                                </div>
                                </div>
                            </div>
                            <!-- 7. Drilldowns -->
                            <div class="form-section" data-section="7">
                                <div class="section-header collapsible" onclick="toggleSection(7)"><span class="collapse-icon">‚ñº</span> 7. Drilldowns</div>
                                <div class="section-content">
                                <div class="drilldown-card">
                                    <div class="drilldown-header"><span>Legacy Drilldown</span></div>
                                    <div class="form-grid-3">
                                        <div class="form-group"><label>Name</label><input type="text" id="field-drilldown_legacy_name"></div>
                                        <div class="form-group"><label>Earliest</label><input type="text" id="field-drilldown_legacy_earliest"></div>
                                        <div class="form-group"><label>Latest</label><input type="text" id="field-drilldown_legacy_latest"></div>
                                    </div>
                                    <div class="form-group full"><label>Search</label><textarea id="field-drilldown_legacy_search" rows="3" placeholder="Use $variable$ for tokens"></textarea></div>
                                </div>
                                <div id="drilldowns-container"></div>
                                <button type="button" id="btn-add-drilldown" class="btn-secondary">+ Add Drilldown</button>
                                </div>
                            </div>
                            
                            <!-- 8. Proposed Test Plan -->
                            <div class="form-section collapsed" data-section="8">
                                <div class="section-header collapsible" onclick="toggleSection(8)"><span class="collapse-icon">‚ñ∂</span> 8. Proposed Test Plan</div>
                                <div class="section-content">
                                <div class="form-group full">
                                    <label>Test Plan</label>
                                    <textarea id="field-proposed_test_plan" rows="6" class="code-textarea" placeholder="Document the proposed test plan for validating this detection..."></textarea>
                                </div>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div id="editor-json" class="editor-content">
                        <div class="json-toolbar">
                            <button id="btn-copy-json" class="btn-secondary">üìã Copy</button>
                            <button id="btn-format-json" class="btn-secondary">üîÑ Refresh</button>
                        </div>
                        <pre id="json-display" class="json-display json-syntax"></pre>
                    </div>
                    <div id="editor-metadata" class="editor-content">
                        <div class="json-toolbar">
                            <button id="btn-copy-metadata" class="btn-secondary">üìã Copy</button>
                            <button id="btn-refresh-metadata" class="btn-secondary">üîÑ Refresh</button>
                        </div>
                        <pre id="metadata-display" class="json-display json-syntax"></pre>
                    </div>
                </div>
                <div class="editor-sidebar">
                    <div class="sidebar-section"><h3>Validation</h3><div id="validation-status"></div><div id="validation-errors" class="validation-errors"></div></div>
                    <div class="sidebar-section"><h3>Parsed Metadata</h3><div id="parsed-metadata" class="parsed-metadata"></div></div>
                    <div class="sidebar-actions">
                        <button id="btn-save" class="btn-primary">üíæ Save</button>
                        <button id="btn-metadata-editor" class="btn-secondary">üìã Metadata</button>
                        <button id="btn-download" class="btn-secondary">‚¨áÔ∏è Download</button>
                        <button id="btn-clear" class="btn-secondary">üóëÔ∏è Clear</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="view-config" class="view">
            <div class="config-container config-fullscreen">
                <div class="config-section">
                    <h2>Built-in SPL Parsing Rules</h2>
                    <p class="config-description">These parsing rules are automatically applied to all detection search strings and drilldowns.</p>
                    <div class="builtin-parsing-info">
                        <div class="parsing-rule-card">
                            <h4>üìä Indexes</h4>
                            <p>Extracts index names from <code>index=</code> assignments</p>
                            <div class="parsing-example">
                                <strong>Pattern:</strong> <code>index=&lt;value&gt;</code><br>
                                <strong>Example:</strong> <code>index=wineventlog OR index=sysmon</code><br>
                                <strong>Result:</strong> <span class="tag-preview">wineventlog</span> <span class="tag-preview">sysmon</span>
                            </div>
                        </div>
                        <div class="parsing-rule-card">
                            <h4>üìÅ Sourcetypes</h4>
                            <p>Extracts sourcetype values from <code>sourcetype=</code> assignments</p>
                            <div class="parsing-example">
                                <strong>Pattern:</strong> <code>sourcetype=&lt;value&gt;</code><br>
                                <strong>Example:</strong> <code>sourcetype="WinEventLog:Security"</code><br>
                                <strong>Result:</strong> <span class="tag-preview">WinEventLog:Security</span>
                            </div>
                        </div>
                        <div class="parsing-rule-card">
                            <h4>üî¢ Event Codes</h4>
                            <p>Extracts Windows Event IDs from EventCode fields</p>
                            <div class="parsing-example">
                                <strong>Pattern:</strong> <code>EventCode=&lt;value&gt;</code> or <code>EventCode IN (...)</code><br>
                                <strong>Example:</strong> <code>EventCode IN (4624, 4625, 4648)</code><br>
                                <strong>Result:</strong> <span class="tag-preview">4624</span> <span class="tag-preview">4625</span> <span class="tag-preview">4648</span>
                            </div>
                        </div>
                        <div class="parsing-rule-card">
                            <h4>üîß SPL Functions</h4>
                            <p>Extracts all SPL commands/functions following pipe characters</p>
                            <div class="parsing-example">
                                <strong>Pattern:</strong> <code>| &lt;command&gt;</code><br>
                                <strong>Example:</strong> <code>| eval x=1 | stats count by user | where count>5</code><br>
                                <strong>Result:</strong> <span class="tag-preview">eval</span> <span class="tag-preview">stats</span> <span class="tag-preview">where</span>
                            </div>
                        </div>
                        <div class="parsing-rule-card">
                            <h4>üìä Stats By Fields</h4>
                            <p>Extracts field names used after <code>by</code> clause in stats/chart commands</p>
                            <div class="parsing-example">
                                <strong>Pattern:</strong> <code>| stats ... by &lt;field1&gt;, &lt;field2&gt;</code><br>
                                <strong>Example:</strong> <code>| stats count by src_user, dest_host, action</code><br>
                                <strong>Result:</strong> <span class="tag-preview">src_user</span> <span class="tag-preview">dest_host</span> <span class="tag-preview">action</span>
                            </div>
                        </div>
                        <div class="parsing-rule-card">
                            <h4>üîç Main Search Fields</h4>
                            <p>Extracts fields used in the search phase (before first pipe) with operators: =, !=, IN, like</p>
                            <div class="parsing-example">
                                <strong>Pattern:</strong> <code>&lt;field&gt;=&lt;value&gt;</code>, <code>&lt;field&gt; IN (...)</code><br>
                                <strong>Example:</strong> <code>Cisco_ASA_message_id IN (113005) AND src!="10.*"</code><br>
                                <strong>Result:</strong> <span class="tag-preview">Cisco_ASA_message_id</span> <span class="tag-preview">src</span>
                            </div>
                        </div>
                        <div class="parsing-rule-card">
                            <h4>üìê Macros</h4>
                            <p>Extracts macro names enclosed in backticks</p>
                            <div class="parsing-example">
                                <strong>Pattern:</strong> <code>`macro_name`</code> or <code>`macro_name(args)`</code><br>
                                <strong>Example:</strong> <code>`get_notable_index` `cim_authentication_indexes`</code><br>
                                <strong>Result:</strong> <span class="tag-preview">get_notable_index</span> <span class="tag-preview">cim_authentication_indexes</span>
                            </div>
                        </div>
                        <div class="parsing-rule-card">
                            <h4>üìã Lookups</h4>
                            <p>Extracts lookup table names from lookup commands</p>
                            <div class="parsing-example">
                                <strong>Pattern:</strong> <code>| lookup &lt;name&gt;</code> or <code>| inputlookup &lt;name&gt;</code><br>
                                <strong>Example:</strong> <code>| lookup asset_lookup ip OUTPUT asset_type</code><br>
                                <strong>Result:</strong> <span class="tag-preview">asset_lookup</span>
                            </div>
                        </div>
                        <div class="parsing-rule-card">
                            <h4>üìù Eval Fields</h4>
                            <p>Extracts field names created by eval commands</p>
                            <div class="parsing-example">
                                <strong>Pattern:</strong> <code>| eval &lt;field_name&gt;=...</code><br>
                                <strong>Example:</strong> <code>| eval risk_score=severity*10, is_critical=if(severity>8,1,0)</code><br>
                                <strong>Result:</strong> <span class="tag-preview">risk_score</span> <span class="tag-preview">is_critical</span>
                            </div>
                        </div>
                        <div class="parsing-rule-card">
                            <h4>üîó Drilldown Variables</h4>
                            <p>Extracts token variables from drilldown searches</p>
                            <div class="parsing-example">
                                <strong>Pattern:</strong> <code>$variable_name$</code><br>
                                <strong>Example:</strong> <code>index=main host=$dest$ user=$src_user$</code><br>
                                <strong>Result:</strong> <span class="tag-preview variable">$dest$</span> <span class="tag-preview variable">$src_user$</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="config-section config-disabled">
                    <h2>Custom SPL Parsing Rules <span class="coming-soon-badge">Coming Soon</span></h2>
                    <p class="config-description">Define custom rules to extract tags from SPL searches based on field patterns.</p>
                    <div class="rule-form">
                        <input type="text" id="rule-field" placeholder="Field (e.g., index)" disabled class="disabled-input">
                        <input type="text" id="rule-value" placeholder="Regex (e.g., azure_cloud)" disabled class="disabled-input">
                        <input type="text" id="rule-category" placeholder="Category" disabled class="disabled-input">
                        <input type="text" id="rule-tag" placeholder="Tag Name" disabled class="disabled-input">
                        <button id="btn-add-rule" class="btn-primary" disabled>Add Rule</button>
                    </div>
                    <div id="parsing-rules-list" class="parsing-rules-list"></div>
                </div>
            </div>
        </div>

        <div id="view-revalidation" class="view">
            <div class="revalidation-container">
                <div class="reval-header">
                    <div class="reval-header-main">
                        <h2>Detection Revalidation</h2>
                        <p>Identify detections missing required fields. Check fields below to filter the list.</p>
                    </div>
                </div>
                
                <div class="reval-stats">
                    <div class="reval-stat clickable" data-filter="all"><div id="reval-stat-total" class="reval-stat-value">0</div><div class="reval-stat-label">Total</div></div>
                    <div class="reval-stat valid clickable" data-filter="valid"><div id="reval-stat-valid" class="reval-stat-value">0</div><div class="reval-stat-label">Valid</div></div>
                    <div class="reval-stat incomplete clickable" data-filter="incomplete"><div id="reval-stat-incomplete" class="reval-stat-value">0</div><div class="reval-stat-label">Incomplete</div></div>
                    <div class="reval-stat tune clickable" data-filter="need-tune"><div id="reval-stat-tune" class="reval-stat-value">0</div><div class="reval-stat-label">Need Tune</div></div>
                    <div class="reval-stat retrofit clickable" data-filter="need-retrofit"><div id="reval-stat-retrofit" class="reval-stat-value">0</div><div class="reval-stat-label">Need Retrofit</div></div>
                </div>
                <div class="reval-filters-panel">
                    <div class="reval-config-section">
                        <h4>Filter by Missing Fields <span class="filter-hint">(click to filter list)</span></h4>
                        <div class="reval-fields-grid">
                            <div class="reval-field-group">
                                <h5>Mandatory Fields</h5>
                                <div id="mandatory-fields-checks" class="field-checks"></div>
                            </div>
                            <div class="reval-field-group">
                                <h5>Key Fields</h5>
                                <div id="key-fields-checks" class="field-checks"></div>
                            </div>
                        </div>
                    </div>
                    <div class="reval-actions">
                        <button id="btn-clear-filters" class="btn-secondary">Clear Filters</button>
                        <button id="btn-run-revalidation" class="btn-primary">üîÑ Refresh Analysis</button>
                        <button onclick="openSplunkEmpty()" class="btn-splunk"><img src="assets/splunk-icon.svg" alt="" class="btn-icon-img"> Reval Dashboard</button>
                        <button onclick="openHealthDashboard()" class="btn-health">üè• UC Health Dashboard</button>
                    </div>
                </div>
                <div class="reval-results-header">
                    <input type="text" id="reval-search" class="search-input" placeholder="üîç Search by detection name...">
                    <span id="reval-results-count">0 detections</span>
                    <select id="reval-sort" class="filter-select">
                        <option value="name">Sort: Name</option>
                        <option value="missing">Sort: Most Missing Fields</option>
                        <option value="severity">Sort: Severity</option>
                        <option value="ttl">Sort: TTL (Expiring Soon)</option>
                    </select>
                </div>
                <div id="revalidation-results" class="revalidation-results"></div>
            </div>
        </div>

        <div id="view-history" class="view">
            <div class="history-layout-v2">
                <!-- Main Timeline View -->
                <div class="history-main">
                    <div class="history-main-header">
                        <h3 id="history-detail-title">Select a detection to view history</h3>
                        <div class="history-type-filters">
                            <button class="history-type-btn active" data-type="all">All</button>
                            <button class="history-type-btn" data-type="tune">Tunes</button>
                            <button class="history-type-btn" data-type="retrofit">Retrofits</button>
                            <button class="history-type-btn" data-type="revalidation">Revalidations</button>
                            <button class="history-type-btn" data-type="version">Versions</button>
                        </div>
                    </div>
                    <div class="history-stats-bar">
                        <div class="history-stat"><span id="history-total-entries">0</span> Total</div>
                        <div class="history-stat tune"><span id="history-tune-count">0</span> Tunes</div>
                        <div class="history-stat retrofit"><span id="history-retrofit-count">0</span> Retrofits</div>
                        <div class="history-stat revalidation"><span id="history-reval-count">0</span> Revalidations</div>
                    </div>
                    <div id="history-timeline" class="history-timeline-v2"></div>
                </div>
                <!-- Sidebar - Detection List -->
                <div class="history-sidebar">
                    <div class="history-search">
                        <input type="text" id="history-detection-search" placeholder="üîç Search detections..." class="search-input">
                    </div>
                    <div class="history-filters">
                        <select id="history-domain-filter" class="filter-select">
                            <option value="">All Domains</option>
                            <option value="access">Access</option>
                            <option value="endpoint">Endpoint</option>
                            <option value="network">Network</option>
                            <option value="threat">Threat</option>
                            <option value="identity">Identity</option>
                        </select>
                        <select id="history-has-history-filter" class="filter-select">
                            <option value="">Any History</option>
                            <option value="yes">Has History</option>
                            <option value="no">No History</option>
                        </select>
                        <select id="history-sort-filter" class="filter-select">
                            <option value="name">Sort: Name</option>
                            <option value="history-count">Sort: History Count</option>
                            <option value="recent">Sort: Recent Activity</option>
                        </select>
                        <details class="advanced-filters">
                            <summary>More Filters</summary>
                            <div class="advanced-filter-content">
                                <select id="history-analyst-filter" class="filter-select"><option value="">All Analysts</option></select>
                                <select id="history-reason-filter" class="filter-select"><option value="">All Reasons</option></select>
                                <select id="history-field-filter" class="filter-select"><option value="">All Fields</option></select>
                            </div>
                        </details>
                    </div>
                    <div class="history-list-header">
                        <span id="history-list-count">0 detections</span>
                    </div>
                    <div id="history-detection-list" class="history-detection-list-v2"></div>
                </div>
            </div>
        </div>

        <div id="view-resources" class="view">
            <div class="resources-container">
                <div class="resources-header">
                    <h2>üìö Resources</h2>
                    <p>Useful links, dashboards, and tools for the team</p>
                </div>
                <div class="resources-toolbar">
                    <div class="resources-search">
                        <input type="text" id="resources-search-input" class="search-input" placeholder="üîç Search resources...">
                    </div>
                    <div class="resources-filters">
                        <select id="resources-category-filter" class="filter-select">
                            <option value="">All Categories</option>
                            <option value="Dashboard">Dashboard</option>
                            <option value="external url">External URL</option>
                            <option value="internal url">Internal URL</option>
                        </select>
                    </div>
                    <span id="resources-count" class="results-count">0 resources</span>
                    <button id="btn-add-resource" class="btn-primary">‚ûï Add Resource</button>
                </div>
                <div id="resources-grid" class="resources-list"></div>
            </div>
        </div>

        <div id="view-macros" class="view">
            <div class="macros-container">
                <div class="macros-header">
                    <h2>üìê Macros</h2>
                    <p>Manage SPL macros for detection validation</p>
                </div>
                <div class="macros-toolbar">
                    <div class="macros-search">
                        <input type="text" id="macros-search-input" class="search-input" placeholder="üîç Search macros...">
                    </div>
                    <span id="macros-count" class="results-count">0 macros</span>
                    <button id="btn-add-macro" class="btn-primary">‚ûï Add Macro</button>
                </div>
                <div id="macros-grid" class="macros-list"></div>
            </div>
        </div>

        <div id="view-reports" class="view">
            <div class="reports-container">
                <div class="reports-tabs">
                    <button class="reports-tab active" data-tab="overview">Overview</button>
                    <button class="reports-tab" data-tab="coverage">Detection Coverage</button>
                    <button class="reports-tab" data-tab="revalidations">Revalidations</button>
                    <button class="reports-tab" data-tab="metadata">Detection Metadata</button>
                </div>
                
                <!-- Overview Tab (formerly Dashboard) -->
                <div id="reports-overview" class="reports-tab-content active">
                    <div class="dashboard-grid">
                        <div class="stats-row">
                            <div class="stat-card"><div id="stat-total" class="stat-value">0</div><div class="stat-label">Total</div></div>
                            <div class="stat-card critical"><div id="stat-critical" class="stat-value">0</div><div class="stat-label">Critical</div></div>
                            <div class="stat-card high"><div id="stat-high" class="stat-value">0</div><div class="stat-label">High</div></div>
                            <div class="stat-card medium"><div id="stat-medium" class="stat-value">0</div><div class="stat-label">Medium</div></div>
                            <div class="stat-card low"><div id="stat-low" class="stat-value">0</div><div class="stat-label">Low</div></div>
                            <div class="stat-card info"><div id="stat-info" class="stat-value">0</div><div class="stat-label">Info</div></div>
                        </div>
                        <div class="charts-row">
                            <div class="chart-card"><h3>Severity Distribution</h3><div id="chart-severity" class="labeled-bar-chart"></div></div>
                            <div class="chart-card"><h3>Risk Score Distribution</h3><div id="chart-risk" class="labeled-bar-chart"></div></div>
                            <div class="chart-card"><h3>Security Domains</h3><div id="chart-domain" class="labeled-bar-chart"></div></div>
                        </div>
                        <div class="charts-row">
                            <div class="chart-card"><h3>Data Sources</h3><div id="chart-datasources" class="chart-bars"></div></div>
                            <div class="chart-card"><h3>MITRE Techniques</h3><div id="chart-mitre" class="chart-bars"></div></div>
                        </div>
                        <div class="lists-row">
                            <div class="list-card"><h3>Recently Modified</h3><div id="list-recent" class="list-items"></div></div>
                            <div class="list-card tune"><h3>Recent Tunes</h3><div id="list-recent-tunes" class="list-items"></div></div>
                            <div class="list-card retrofit"><h3>Recent Retrofits</h3><div id="list-recent-retrofits" class="list-items"></div></div>
                        </div>
                    </div>
                </div>
                
                <div id="reports-coverage" class="reports-tab-content hidden">
                    <h2>Detection Coverage Report</h2>
                    <div class="reports-summary">
                        <div class="report-stat"><div id="report-coverage-mitre" class="report-stat-value">0%</div><div class="report-stat-label">MITRE Coverage</div></div>
                        <div class="report-stat"><div id="report-coverage-drilldowns" class="report-stat-value">0%</div><div class="report-stat-label">Has Drilldowns</div></div>
                        <div class="report-stat"><div id="report-avg-risk" class="report-stat-value">0</div><div class="report-stat-label">Avg Risk Score</div></div>
                        <div class="report-stat"><div id="report-total" class="report-stat-value">0</div><div class="report-stat-label">Total Detections</div></div>
                    </div>
                    <div id="report-extra-stats" class="reports-summary extra-stats"></div>
                    <div class="reports-grid">
                        <div class="report-card"><h3>Data Sources</h3><div id="report-datasources" class="report-chart"></div></div>
                        <div class="report-card"><h3>Platforms</h3><div id="report-platforms" class="report-chart"></div></div>
                        <div class="report-card"><h3>Security Domains</h3><div id="report-domains" class="report-chart"></div></div>
                        <div class="report-card"><h3>Origins</h3><div id="report-origins" class="report-chart"></div></div>
                    </div>
                    <div class="report-card full-width"><h3>MITRE ATT&CK Coverage</h3><div id="report-mitre-heatmap" class="mitre-heatmap"></div></div>
                    <div class="reports-grid">
                        <div class="report-card"><h3>Severity Breakdown</h3><div id="report-severity" class="report-chart"></div></div>
                        <div class="report-card"><h3>Quality Metrics</h3><div id="report-quality" class="report-chart"></div></div>
                    </div>
                </div>
                
                <div id="reports-revalidations" class="reports-tab-content hidden">
                    <h2>Revalidation Report</h2>
                    <div class="reports-summary">
                        <div class="report-stat"><div id="reval-report-total" class="report-stat-value">0</div><div class="report-stat-label">Total Detections</div></div>
                        <div class="report-stat valid"><div id="reval-report-valid" class="report-stat-value">0</div><div class="report-stat-label">Fully Valid</div></div>
                        <div class="report-stat tune"><div id="reval-report-tune" class="report-stat-value">0</div><div class="report-stat-label">Need Tune</div></div>
                        <div class="report-stat retrofit"><div id="reval-report-retrofit" class="report-stat-value">0</div><div class="report-stat-label">Need Retrofit</div></div>
                    </div>
                    <div class="reports-grid">
                        <div class="report-card">
                            <h3>Missing Fields Summary</h3>
                            <div id="reval-report-fields" class="reval-report-fields"></div>
                        </div>
                        <div class="report-card">
                            <h3>TTL Status</h3>
                            <div id="reval-report-ttl" class="reval-report-ttl"></div>
                        </div>
                    </div>
                    <div class="reports-summary" style="margin-top: 20px;">
                        <div class="report-stat"><div id="reval-report-history-total" class="report-stat-value">0</div><div class="report-stat-label">Total History Entries</div></div>
                        <div class="report-stat tune"><div id="reval-report-tunes" class="report-stat-value">0</div><div class="report-stat-label">Total Tunes</div></div>
                        <div class="report-stat retrofit"><div id="reval-report-retrofits" class="report-stat-value">0</div><div class="report-stat-label">Total Retrofits</div></div>
                        <div class="report-stat"><div id="reval-report-analysts" class="report-stat-value">0</div><div class="report-stat-label">Unique Analysts</div></div>
                    </div>
                    <div class="reports-grid">
                        <div class="report-card"><h3>Activity by Analyst</h3><div id="reval-report-analyst-chart" class="report-chart"></div></div>
                        <div class="report-card"><h3>Activity by Reason</h3><div id="reval-report-reason-chart" class="report-chart"></div></div>
                    </div>
                    <div class="report-card full-width">
                        <h3>Recent Activity Timeline</h3>
                        <div id="reval-report-timeline" class="meta-report-timeline"></div>
                    </div>
                </div>
                
                <div id="reports-metadata" class="reports-tab-content hidden">
                    <h2>Detection Metadata Report</h2>
                    <p class="report-subtitle">Statistics based on parsed values from detection metadata files</p>
                    <div class="reports-summary">
                        <div class="report-stat"><div id="meta-report-detections" class="report-stat-value">0</div><div class="report-stat-label">Detections with Metadata</div></div>
                        <div class="report-stat"><div id="meta-report-indexes" class="report-stat-value">0</div><div class="report-stat-label">Unique Indexes</div></div>
                        <div class="report-stat"><div id="meta-report-sourcetypes" class="report-stat-value">0</div><div class="report-stat-label">Unique Sourcetypes</div></div>
                        <div class="report-stat"><div id="meta-report-functions" class="report-stat-value">0</div><div class="report-stat-label">Unique Functions</div></div>
                    </div>
                    <div class="reports-grid">
                        <div class="report-card"><h3>Top Indexes</h3><div id="meta-report-index-chart" class="report-chart"></div></div>
                        <div class="report-card"><h3>Top Sourcetypes</h3><div id="meta-report-sourcetype-chart" class="report-chart"></div></div>
                    </div>
                    <div class="reports-grid">
                        <div class="report-card"><h3>Main Search Fields</h3><div id="meta-report-fields-chart" class="report-chart"></div></div>
                        <div class="report-card"><h3>Search Functions</h3><div id="meta-report-func-chart" class="report-chart"></div></div>
                    </div>
                    <div class="reports-grid">
                        <div class="report-card"><h3>Macros Used</h3><div id="meta-report-macros-chart" class="report-chart"></div></div>
                        <div class="report-card"><h3>Lookups Used</h3><div id="meta-report-lookups-chart" class="report-chart"></div></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Password Protection Modal -->
    <div id="modal-password" class="modal password-modal">
        <div class="modal-overlay no-close"></div>
        <div class="modal-content small password-modal-content">
            <div class="modal-header">
                <div class="password-lock-icon">üîí</div>
                <h3>DE-MainFrame Access</h3>
            </div>
            <div class="modal-body">
                <p class="password-prompt">Enter password to continue</p>
                <div class="form-group">
                    <input type="password" id="password-input" class="password-input" placeholder="Password" autocomplete="off">
                </div>
                <p id="password-error" class="password-error hidden">Incorrect password</p>
            </div>
            <div class="modal-footer">
                <button id="btn-password-submit" class="btn-primary" onclick="validatePassword()">Unlock</button>
            </div>
        </div>
    </div>

    <div id="modal-settings" class="modal hidden">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <div class="modal-header"><h3>GitHub Settings</h3><button class="modal-close">√ó</button></div>
            <div class="modal-body">
                <div class="form-group"><label>GitHub URL</label><input type="text" id="setting-github-url" placeholder="https://github.com or https://github.enterprise.com"></div>
                <div class="form-group"><label>Repository (owner/repo)</label><input type="text" id="setting-repo" placeholder="username/detection-repo"></div>
                <div class="form-group"><label>Branch</label><input type="text" id="setting-branch" value="main"></div>
                <div class="form-group"><label>Personal Access Token</label><input type="password" id="setting-token" placeholder="ghp_..."></div>
                <div class="form-group"><label>Detections Path</label><input type="text" id="setting-detections-path" placeholder="detections"><small class="form-hint">Folder name only (e.g., "detections"), not a full URL</small></div>
                <div class="form-group"><label>Metadata Path</label><input type="text" id="setting-metadata-path" placeholder="metadata"><small class="form-hint">Folder name only (e.g., "metadata"), not a full URL</small></div>
                <div id="settings-status" class="settings-status"></div>
            </div>
            <div class="modal-footer">
                    <button id="btn-migrate-filenames" class="btn-secondary" title="Rename existing files to follow naming convention">Migrate File Names</button>
                    <button id="btn-reparse-all" class="btn-secondary" title="Re-parse all detection SPL and update metadata">üîÑ Re-parse All</button>
                    <button id="btn-test-connection" class="btn-secondary">Test Connection</button>
                    <button id="btn-save-settings" class="btn-primary">Save & Connect</button>
                </div>
        </div>
    </div>

    <div id="modal-import" class="modal hidden"><div class="modal-overlay"></div><div class="modal-content"><div class="modal-header"><h3>Import Detections</h3><button class="modal-close">√ó</button></div><div class="modal-body"><div id="import-dropzone" class="import-dropzone"><span class="dropzone-icon">üìÅ</span><p>Drop JSON files here or click to browse</p><input type="file" id="import-file-input" accept=".json" multiple hidden></div><div id="import-progress" class="import-progress hidden"><div class="progress-bar"><div id="import-progress-fill" class="progress-fill"></div></div><p id="import-progress-text">Processing...</p></div><div id="import-results" class="import-results hidden"></div></div></div></div>

    <div id="modal-tune" class="modal hidden">
        <div class="modal-overlay"></div>
        <div class="modal-content modal-wide">
            <div class="modal-header"><h3>üîß Record Tuning</h3><button class="modal-close">√ó</button></div>
            <div class="modal-body">
                <p class="modal-detection-label">Detection: <strong id="tune-detection-name"></strong></p>
                <div class="form-row">
                    <div class="form-group">
                        <label>JIRA Issue *</label>
                        <div class="jira-input-wrapper">
                            <span class="jira-prefix">MRDP-</span>
                            <input type="text" id="tune-jira" maxlength="4" pattern="[0-9]{4}" placeholder="1234" class="jira-input">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Analyst Name *</label>
                        <input type="text" id="tune-analyst" placeholder="Your name">
                    </div>
                </div>
                <div class="form-group">
                    <label>What was tuned? *</label>
                    <textarea id="tune-description" rows="3" placeholder="Describe the tuning changes..."></textarea>
                </div>
                <div class="form-group">
                    <label>Reason</label>
                    <select id="tune-reason">
                        <option value="">Select...</option>
                        <option value="false_positives">Reduce False Positives</option>
                        <option value="performance">Performance Optimization</option>
                        <option value="coverage">Expand Coverage</option>
                        <option value="threshold">Adjust Threshold</option>
                        <option value="data_source">Data Source Change</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Fields Modified</label>
                    <div class="multi-select-wrapper" id="tune-fields-wrapper">
                        <div class="multi-select-display" id="tune-fields-display" onclick="toggleMultiSelect('tune-fields')">
                            <span class="placeholder">Select fields...</span>
                        </div>
                        <div class="multi-select-dropdown hidden" id="tune-fields-dropdown"></div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary modal-close">Cancel</button>
                <button id="btn-submit-tune" class="btn-tune">Continue to Edit</button>
            </div>
        </div>
    </div>

    <div id="modal-retrofit" class="modal hidden">
        <div class="modal-overlay"></div>
        <div class="modal-content modal-wide">
            <div class="modal-header"><h3>‚ö° Record Retrofit</h3><button class="modal-close">√ó</button></div>
            <div class="modal-body">
                <p class="modal-detection-label">Detection: <strong id="retrofit-detection-name"></strong></p>
                <div class="form-row">
                    <div class="form-group">
                        <label>JIRA Issue *</label>
                        <div class="jira-input-wrapper">
                            <span class="jira-prefix">MRDP-</span>
                            <input type="text" id="retrofit-jira" maxlength="4" pattern="[0-9]{4}" placeholder="1234" class="jira-input">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Analyst Name *</label>
                        <input type="text" id="retrofit-analyst" placeholder="Your name">
                    </div>
                </div>
                <div class="form-group">
                    <label>What was retrofitted? *</label>
                    <textarea id="retrofit-description" rows="3" placeholder="Describe the retrofit changes..."></textarea>
                </div>
                <div class="form-group">
                    <label>Type</label>
                    <select id="retrofit-type">
                        <option value="schema">Schema Update</option>
                        <option value="metadata">Metadata Addition</option>
                        <option value="mitre">MITRE Mapping</option>
                        <option value="drilldown">Drilldown Addition</option>
                        <option value="documentation">Documentation</option>
                        <option value="revalidation">Annual Revalidation</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Fields Modified</label>
                    <div class="multi-select-wrapper" id="retrofit-fields-wrapper">
                        <div class="multi-select-display" id="retrofit-fields-display" onclick="toggleMultiSelect('retrofit-fields')">
                            <span class="placeholder">Select fields...</span>
                        </div>
                        <div class="multi-select-dropdown hidden" id="retrofit-fields-dropdown"></div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary modal-close">Cancel</button>
                <button id="btn-submit-retrofit" class="btn-retrofit">Continue to Edit</button>
            </div>
        </div>
    </div>

    <div id="modal-metadata" class="modal hidden">
        <div class="modal-overlay"></div>
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3>üìã Detection Metadata</h3>
                <div class="modal-header-actions">
                    <div class="metadata-view-toggle">
                        <button class="toggle-btn active" data-view="formatted">Formatted</button>
                        <button class="toggle-btn" data-view="json">JSON</button>
                    </div>
                    <button class="modal-close">√ó</button>
                </div>
            </div>
            <div class="modal-body">
                <div id="metadata-detection-name" class="metadata-title"></div>
                <div id="metadata-formatted" class="metadata-formatted"></div>
                <div id="metadata-json" class="metadata-json hidden">
                    <pre id="metadata-json-content" class="json-display"></pre>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary btn-copy-json" onclick="copyMetadataJson()">üìã Copy JSON</button>
                <button class="btn-close-modal modal-close">Close</button>
            </div>
        </div>
    </div>

    <div id="modal-resource" class="modal hidden">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="resource-modal-title">‚ûï Add Resource</h3>
                <button class="modal-close">√ó</button>
            </div>
            <div class="modal-body">
                <form id="resource-form" class="resource-form">
                    <div class="form-group">
                        <label>Name *</label>
                        <input type="text" id="resource-name" required placeholder="Resource name">
                    </div>
                    <div class="form-group">
                        <label>Description *</label>
                        <textarea id="resource-description" rows="3" required placeholder="Brief description"></textarea>
                    </div>
                    <div class="form-group">
                        <label>URL *</label>
                        <input type="url" id="resource-url" required placeholder="https://...">
                    </div>
                    <div class="form-group">
                        <label>Category *</label>
                        <div class="category-input-wrapper">
                            <select id="resource-category" required>
                                <option value="">Select category...</option>
                                <option value="Dashboard">Dashboard</option>
                                <option value="external url">External URL</option>
                                <option value="internal url">Internal URL</option>
                            </select>
                            <button type="button" id="btn-add-category" class="btn-icon-small" title="Add new category">‚ûï</button>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Added By *</label>
                        <input type="text" id="resource-added-by" required placeholder="Your name">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-secondary modal-close">Cancel</button>
                <button type="button" id="btn-save-resource" class="btn-primary">üíæ Save Resource</button>
            </div>
        </div>
    </div>

    <div id="modal-confirm" class="modal hidden"><div class="modal-overlay"></div><div class="modal-content small"><div class="modal-header"><h3>Confirm</h3><button class="modal-close">√ó</button></div><div class="modal-body"><p id="confirm-message">Are you sure?</p></div><div class="modal-footer"><button id="btn-confirm-no" class="btn-secondary">Cancel</button><button id="btn-confirm-yes" class="btn-danger">Confirm</button></div></div></div>

    <div id="modal-macro" class="modal hidden">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="macro-modal-title">‚ûï Add Macro</h3>
                <button class="modal-close">√ó</button>
            </div>
            <div class="modal-body">
                <form id="macro-form" class="macro-form">
                    <div class="form-group">
                        <label>Macro Name *</label>
                        <input type="text" id="macro-name" required placeholder="macro_name">
                        <small class="form-hint">Enter without backticks (e.g., "get_notable_index" not "`get_notable_index`")</small>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-secondary modal-close">Cancel</button>
                <button type="button" id="btn-save-macro" class="btn-primary">üíæ Save Macro</button>
            </div>
        </div>
    </div>

    <div id="toast-container" class="toast-container"></div>
    <script src="app.js?v=11.16"></script>
</body>
</html>
