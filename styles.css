/* DE-MAINFRAME V6 */
:root {
    --bg-primary: #0d1117;
    --bg-secondary: #161b22;
    --bg-tertiary: #21262d;
    --bg-card: #1c2128;
    --border-color: #30363d;
    --text-primary: #e6edf3;
    --text-secondary: #8b949e;
    --text-muted: #6e7681;
    --accent: #58a6ff;
    --accent-hover: #79b8ff;
    --critical: #f85149;
    --high: #f0883e;
    --medium: #d29922;
    --low: #3fb950;
    --info: #58a6ff;
    --tune-color: #f0883e;
    --retrofit-color: #a371f7;
    --success: #3fb950;
    --warning: #d29922;
    --error: #f85149;
}

body.light-mode {
    --bg-primary: #ffffff;
    --bg-secondary: #f6f8fa;
    --bg-tertiary: #eaeef2;
    --bg-card: #ffffff;
    --border-color: #d0d7de;
    --text-primary: #1f2328;
    --text-secondary: #57606a;
    --text-muted: #8c959f;
    --accent: #0969da;
    --accent-hover: #0550ae;
}

* { box-sizing: border-box; margin: 0; padding: 0; }
html, body { height: 100%; }
body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: var(--bg-primary); color: var(--text-primary); line-height: 1.5; transition: background-color 0.3s, color 0.3s; }

.boot-screen { position: fixed; inset: 0; background: var(--bg-primary); display: flex; align-items: center; justify-content: center; z-index: 9999; }
.boot-content { text-align: center; }
.boot-logo { font-size: 64px; margin-bottom: 16px; animation: pulse 1.5s ease-in-out infinite; }
.boot-title { font-size: 28px; font-weight: 600; }
.boot-version { color: var(--text-muted); margin-bottom: 24px; }
.boot-loader { width: 200px; height: 3px; background: var(--bg-tertiary); border-radius: 3px; margin: 0 auto 16px; overflow: hidden; }
.boot-loader::after { content: ''; display: block; width: 40%; height: 100%; background: linear-gradient(90deg, var(--accent), var(--retrofit-color)); border-radius: 3px; animation: load 1.5s ease-in-out infinite; }
.boot-status { color: var(--text-secondary); font-size: 13px; }
@keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
@keyframes load { 0% { transform: translateX(-100%); } 100% { transform: translateX(350%); } }

.app { display: flex; flex-direction: column; height: 100vh; }
.hidden { display: none !important; }

.header { display: flex; align-items: center; justify-content: space-between; padding: 12px 20px; background: var(--bg-secondary); border-bottom: 1px solid var(--border-color); }
.header-left { display: flex; align-items: center; gap: 12px; }
.logo { font-size: 24px; }
.title { font-size: 18px; font-weight: 600; }
.version { font-size: 11px; color: var(--text-muted); background: var(--bg-tertiary); padding: 2px 8px; border-radius: 10px; }
.btn-new-ui { background: linear-gradient(135deg, #a371f7 0%, #58a6ff 100%); border: none; color: #fff; padding: 6px 12px; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 500; transition: all 0.2s; box-shadow: 0 2px 8px rgba(163, 113, 247, 0.3); }
.btn-new-ui:hover { transform: translateY(-1px); box-shadow: 0 4px 12px rgba(163, 113, 247, 0.4); filter: brightness(1.1); }
.nav { display: flex; gap: 4px; }
.nav-btn { background: transparent; border: none; color: var(--text-secondary); padding: 8px 14px; border-radius: 6px; cursor: pointer; font-size: 13px; transition: all 0.2s; }
.nav-btn:hover { background: var(--bg-tertiary); color: var(--text-primary); }
.nav-btn.active { background: var(--accent); color: #fff; }
.header-right { display: flex; align-items: center; gap: 8px; }
.sync-status { display: flex; align-items: center; gap: 6px; font-size: 12px; padding: 6px 10px; border-radius: 6px; background: var(--bg-tertiary); }
.sync-dot { width: 8px; height: 8px; border-radius: 50%; }
.sync-status.connected .sync-dot { background: var(--success); }
.sync-status.disconnected .sync-dot { background: var(--text-muted); }
.sync-status.syncing .sync-dot { background: var(--warning); animation: pulse 1s infinite; }
.sync-status.error .sync-dot { background: var(--error); }
.sync-status.warning .sync-dot { background: var(--warning); }
.sync-status.idle .sync-dot { background: var(--success); }
.btn-icon { background: var(--bg-tertiary); border: 1px solid var(--border-color); color: var(--text-primary); width: 36px; height: 36px; border-radius: 6px; cursor: pointer; font-size: 16px; transition: all 0.2s; }
.btn-icon:hover { background: var(--accent); border-color: var(--accent); }

.view { display: none; flex: 1; overflow: hidden; }
.view.active { display: flex; flex-direction: column; }

/* Dashboard */
.dashboard-grid { padding: 20px; overflow-y: auto; display: flex; flex-direction: column; gap: 20px; }
.stats-row { display: grid; grid-template-columns: repeat(6, 1fr); gap: 12px; }
.stat-card { background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 8px; padding: 16px; text-align: center; }
.stat-value { font-size: 28px; font-weight: 700; color: var(--text-primary); }
.stat-label { font-size: 12px; color: var(--text-secondary); margin-top: 4px; }
.stat-card.critical .stat-value { color: var(--critical); }
.stat-card.high .stat-value { color: var(--high); }
.stat-card.medium .stat-value { color: var(--medium); }
.stat-card.low .stat-value { color: var(--low); }
.stat-card.info .stat-value { color: var(--info); }
.charts-row { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; }
.chart-card { background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 8px; padding: 16px; }
.chart-card h3 { font-size: 14px; color: var(--text-secondary); margin-bottom: 12px; }
.lists-row { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; }
.list-card { background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 8px; padding: 16px; }
.list-card h3 { font-size: 14px; color: var(--text-secondary); margin-bottom: 12px; }
.list-card.tune { border-left: 3px solid var(--tune-color); }
.list-card.retrofit { border-left: 3px solid var(--retrofit-color); }
.list-item { padding: 10px; border-radius: 6px; cursor: pointer; transition: background 0.2s; display: flex; justify-content: space-between; align-items: center; }
.list-item:hover { background: var(--bg-tertiary); }
.list-item-name { font-size: 13px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 200px; }
.list-item-meta { font-size: 11px; color: var(--text-muted); }
.list-item-meta.tune { color: var(--tune-color); }
.list-item-meta.retrofit { color: var(--retrofit-color); }
.list-empty { color: var(--text-muted); font-size: 13px; text-align: center; padding: 20px; }

.labeled-bar-chart { display: flex; flex-direction: column; gap: 8px; }
.labeled-bar-item { display: grid; grid-template-columns: 80px 1fr 40px; align-items: center; gap: 8px; }
.bar-label { font-size: 11px; color: var(--text-secondary); text-transform: capitalize; text-align: right; }
.bar-track { height: 16px; background: var(--bg-tertiary); border-radius: 4px; overflow: hidden; }
.bar-fill { height: 100%; border-radius: 4px; transition: width 0.5s; }
.bar-value { font-size: 12px; font-weight: 500; }
.chart-bars { display: flex; flex-direction: column; gap: 8px; }
.chart-bar-horizontal { display: grid; grid-template-columns: 100px 1fr 40px; align-items: center; gap: 8px; }
.chart-bar-label { font-size: 11px; color: var(--text-secondary); text-overflow: ellipsis; overflow: hidden; white-space: nowrap; }
.chart-bar-fill { height: 20px; background: var(--accent); border-radius: 4px; transition: width 0.5s; }
.chart-bar-value { font-size: 12px; }
.chart-bar-fill.success { background: var(--success); }
.chart-bar-fill.warning { background: var(--warning); }
.chart-bar-fill.error { background: var(--error); }

/* Library */
.library-layout { display: flex; flex: 1; overflow: hidden; }
.library-detail-pane { flex: 1; display: flex; flex-direction: column; border-right: 1px solid var(--border-color); overflow: hidden; }
.library-list-pane { width: 400px; display: flex; flex-direction: column; background: var(--bg-secondary); }
.filter-bar { display: flex; flex-wrap: wrap; gap: 8px; padding: 12px; border-bottom: 1px solid var(--border-color); background: var(--bg-tertiary); }
.search-input { flex: 1; min-width: 150px; padding: 8px 12px; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-secondary); color: var(--text-primary); font-size: 13px; }
.search-input:focus { outline: none; border-color: var(--accent); }
.filter-select { padding: 8px; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-secondary); color: var(--text-primary); font-size: 12px; cursor: pointer; }
.library-list { flex: 1; overflow-y: auto; padding: 8px; }
.library-list-item { padding: 12px; border-radius: 6px; cursor: pointer; transition: background 0.2s; margin-bottom: 4px; border: 1px solid transparent; }
.library-list-item:hover { background: var(--bg-tertiary); }
.library-list-item.selected { background: var(--bg-tertiary); border-color: var(--accent); }
.library-list-item-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px; }
.library-list-item-name { font-size: 13px; font-weight: 500; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 280px; }
.library-list-item-severity { font-size: 10px; padding: 2px 8px; border-radius: 10px; font-weight: 500; }
.library-list-item-meta { display: flex; gap: 12px; font-size: 11px; color: var(--text-muted); }
.detail-placeholder { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; color: var(--text-muted); }
.placeholder-icon { font-size: 48px; margin-bottom: 12px; opacity: 0.5; }
.library-detail-content { flex: 1; display: flex; flex-direction: column; overflow: hidden; }
.detail-header { display: flex; justify-content: space-between; align-items: center; padding: 16px 20px; border-bottom: 1px solid var(--border-color); background: var(--bg-secondary); }
.detail-header h2 { font-size: 18px; font-weight: 600; }
.detail-actions { display: flex; gap: 8px; }
.detail-body { flex: 1; overflow-y: auto; padding: 20px; }
.detail-section { margin-bottom: 20px; }
.detail-section h4 { font-size: 12px; color: var(--text-muted); text-transform: uppercase; margin-bottom: 8px; }
.detail-value { font-size: 14px; line-height: 1.6; }
.detail-tags { display: flex; flex-wrap: wrap; gap: 6px; }
.metadata-row { display: flex; flex-wrap: wrap; align-items: center; gap: 6px; margin-bottom: 8px; }
.metadata-label { font-size: 11px; color: var(--text-muted); min-width: 80px; }

/* CODE BLOCKS - for search string, analyst steps, drilldowns */
.code-block { 
    font-family: 'SF Mono', Monaco, Consolas, monospace; 
    font-size: 12px; 
    background: var(--bg-tertiary); 
    padding: 12px; 
    border-radius: 6px; 
    white-space: pre-wrap; 
    word-break: break-all; 
    overflow-x: auto;
    border: 1px solid var(--border-color);
    line-height: 1.6;
}

/* ROLES DISPLAY AT TOP OF LIBRARY DETAIL */
.roles-section { margin-bottom: 20px; }
.roles-display { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }
.role-display-item { background: var(--bg-tertiary); padding: 12px; border-radius: 6px; text-align: center; }
.role-display-title { font-size: 10px; color: var(--text-muted); text-transform: uppercase; margin-bottom: 4px; }
.role-display-name { font-size: 14px; font-weight: 500; color: var(--text-primary); }
.role-display-subtitle { font-size: 11px; color: var(--text-secondary); display: block; margin-top: 2px; }

/* DRILLDOWN DETAIL WITH VARIABLES AT BOTTOM */
.detail-drilldown { background: var(--bg-tertiary); padding: 12px; border-radius: 6px; margin-bottom: 8px; }
.detail-drilldown-name { font-weight: 500; margin-bottom: 6px; }
.detail-drilldown-time { font-size: 11px; color: var(--text-muted); margin-bottom: 8px; }
.detail-drilldown-search { margin-bottom: 8px; }
.detail-drilldown-vars { display: flex; flex-wrap: wrap; gap: 6px; align-items: center; padding-top: 8px; border-top: 1px solid var(--border-color); margin-top: 8px; }
.vars-label { font-size: 10px; color: var(--text-muted); text-transform: uppercase; margin-right: 4px; }

/* Tags */
.card-tag { display: inline-block; padding: 2px 8px; border-radius: 4px; font-size: 11px; background: var(--bg-tertiary); color: var(--text-secondary); }
.card-tag.datasource { background: rgba(88, 166, 255, 0.15); color: var(--accent); }
.card-tag.macro { background: rgba(163, 113, 247, 0.15); color: var(--retrofit-color); font-family: monospace; }
.card-tag.macro.clickable { cursor: pointer; transition: all 0.2s ease; }
.card-tag.macro.clickable:hover { background: rgba(163, 113, 247, 0.3); transform: translateY(-1px); box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2); }
.card-tag.macro.macro-missing { background: rgba(210, 153, 34, 0.15); color: var(--warning); border: 1px dashed var(--warning); }
.card-tag.macro.macro-missing:hover { background: rgba(210, 153, 34, 0.3); }
.card-tag.macro.macro-deprecated { text-decoration: line-through; opacity: 0.7; }
.card-tag.macro.macro-deprecated:hover { opacity: 1; }
.card-tag.comment { background: rgba(99, 110, 123, 0.2); color: var(--text-muted); font-style: italic; }
.card-tag.mitre { background: rgba(240, 136, 62, 0.15); color: var(--tune-color); }
.card-tag.field { background: rgba(63, 185, 80, 0.15); color: var(--success); }
.card-tag.custom { background: rgba(163, 113, 247, 0.15); color: var(--retrofit-color); }
.card-tag.variable { background: rgba(240, 136, 62, 0.2); color: var(--tune-color); font-family: monospace; }
.card-severity { display: inline-block; padding: 2px 10px; border-radius: 10px; font-size: 11px; font-weight: 500; text-transform: capitalize; }
.card-severity.critical { background: rgba(248, 81, 73, 0.2); color: var(--critical); }
.card-severity.high { background: rgba(240, 136, 62, 0.2); color: var(--high); }
.card-severity.medium { background: rgba(210, 153, 34, 0.2); color: var(--medium); }
.card-severity.low { background: rgba(63, 185, 80, 0.2); color: var(--low); }
.card-severity.informational { background: rgba(88, 166, 255, 0.2); color: var(--info); }

/* Editor */
.editor-layout { display: flex; flex: 1; overflow: hidden; }
.editor-main { flex: 1; display: flex; flex-direction: column; overflow: hidden; }
.editor-header { display: flex; justify-content: space-between; align-items: center; padding: 12px 20px; border-bottom: 1px solid var(--border-color); background: var(--bg-secondary); gap: 12px; }
.editor-header h2 { font-size: 16px; font-weight: 600; }
.editor-tabs { display: flex; gap: 4px; }
.editor-tab { background: transparent; border: none; color: var(--text-secondary); padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 13px; }
.editor-tab:hover { background: var(--bg-tertiary); }
.editor-tab.active { background: var(--accent); color: #fff; }

/* MODE INDICATOR - TUNE/RETROFIT */
.mode-indicator { padding: 4px 12px; border-radius: 4px; font-size: 12px; font-weight: 600; margin-left: 12px; }
.mode-indicator.tune { background: rgba(240, 136, 62, 0.2); color: var(--tune-color); }
.mode-indicator.retrofit { background: rgba(163, 113, 247, 0.2); color: var(--retrofit-color); }

.editor-content { display: none; flex: 1; overflow-y: auto; padding: 20px; }
.editor-content.active { display: block; }
.editor-sidebar { width: 280px; background: var(--bg-secondary); border-left: 1px solid var(--border-color); display: flex; flex-direction: column; overflow: hidden; }
.sidebar-section { padding: 16px; border-bottom: 1px solid var(--border-color); }
.sidebar-section h3 { font-size: 13px; font-weight: 600; margin-bottom: 12px; }
.sidebar-actions { padding: 16px; margin-top: auto; display: flex; flex-direction: column; gap: 8px; }
.validation-indicator { padding: 8px 12px; border-radius: 6px; font-size: 13px; font-weight: 500; }
.validation-indicator.valid { background: rgba(63, 185, 80, 0.15); color: var(--success); }
.validation-indicator.invalid { background: rgba(248, 81, 73, 0.15); color: var(--error); }
.validation-errors { margin-top: 8px; }
.validation-error { font-size: 12px; color: var(--error); padding: 4px 0; }
.validation-error-link { color: #58a6ff; text-decoration: underline; cursor: pointer; }
.validation-error-link:hover { color: #79c0ff; }

/* Form */
.detection-form { max-width: 900px; }
.form-section { margin-bottom: 24px; }
.section-header { font-size: 14px; font-weight: 600; padding-bottom: 8px; margin-bottom: 16px; border-bottom: 1px solid var(--border-color); cursor: pointer; }
.form-row { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-bottom: 12px; }
.form-group { display: flex; flex-direction: column; gap: 4px; }
.form-group.full { grid-column: span 3; }
.form-group label { font-size: 12px; color: var(--text-secondary); }
.form-group input, .form-group select, .form-group textarea { padding: 8px 12px; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-tertiary); color: var(--text-primary); font-size: 13px; }
.form-group input:focus, .form-group select:focus, .form-group textarea:focus { outline: none; border-color: var(--accent); }
.form-group textarea { resize: vertical; font-family: inherit; }
.form-group textarea.spl-input { font-family: 'SF Mono', Monaco, monospace; font-size: 12px; }
.form-hint { font-size: 11px; color: var(--text-muted); margin-top: 4px; }
.roles-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }
.role-card { background: var(--bg-tertiary); padding: 12px; border-radius: 6px; }
.role-title { font-size: 12px; font-weight: 500; color: var(--text-secondary); margin-bottom: 8px; }
.role-card input { width: 100%; padding: 6px 8px; margin-bottom: 6px; border: 1px solid var(--border-color); border-radius: 4px; background: var(--bg-secondary); color: var(--text-primary); font-size: 12px; }
.tag-input-container { background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; padding: 8px; }
.tags { display: flex; flex-wrap: wrap; gap: 6px; margin-bottom: 8px; }
.tag { display: inline-flex; align-items: center; gap: 4px; background: var(--accent); color: #fff; padding: 4px 8px; border-radius: 4px; font-size: 12px; }
.tag-remove { cursor: pointer; opacity: 0.7; }
.tag-remove:hover { opacity: 1; }
#mitre-input { width: 100%; border: none; background: transparent; color: var(--text-primary); font-size: 13px; outline: none; }
.drilldown-card { background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 8px; padding: 16px; margin-bottom: 12px; }
.drilldown-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; font-weight: 500; }
.drilldown-remove { cursor: pointer; color: var(--error); font-size: 18px; }
.json-toolbar { display: flex; gap: 8px; margin-bottom: 12px; }
.json-display { background: var(--bg-tertiary); padding: 16px; border-radius: 8px; font-family: 'SF Mono', Monaco, monospace; font-size: 12px; overflow: auto; white-space: pre-wrap; max-height: calc(100vh - 200px); }

.parsed-metadata { display: flex; flex-direction: column; gap: 12px; max-height: 400px; overflow-y: auto; }
.metadata-group { display: flex; flex-direction: column; gap: 4px; }
.metadata-group .metadata-label { font-size: 10px; color: var(--text-muted); text-transform: uppercase; }
.metadata-values { display: flex; flex-wrap: wrap; gap: 4px; }
.metadata-tag { display: inline-block; padding: 2px 6px; background: var(--bg-tertiary); border-radius: 3px; font-size: 11px; color: var(--text-secondary); }
.metadata-tag.mitre { background: rgba(240, 136, 62, 0.15); color: var(--tune-color); }
.metadata-tag.comment { background: rgba(99, 110, 123, 0.2); color: var(--text-muted); font-style: italic; }
.no-data { color: var(--text-muted); font-size: 12px; font-style: italic; }

/* Config */
.config-container { padding: 24px; max-width: 900px; margin: 0 auto; overflow-y: auto; flex: 1; }
.config-section { background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 8px; padding: 24px; }
.config-section h2 { font-size: 18px; margin-bottom: 8px; }
.config-description { color: var(--text-secondary); font-size: 14px; margin-bottom: 20px; }
.rule-form { display: grid; grid-template-columns: repeat(4, 1fr) auto; gap: 12px; margin-bottom: 20px; }
.rule-form input { padding: 8px 12px; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-tertiary); color: var(--text-primary); font-size: 13px; }
.parsing-rules-list { display: flex; flex-direction: column; gap: 8px; margin-bottom: 20px; }
.parsing-rule { display: flex; align-items: center; gap: 12px; padding: 12px; background: var(--bg-tertiary); border-radius: 6px; }
.parsing-rule code { font-family: 'SF Mono', Monaco, monospace; font-size: 12px; color: var(--accent); flex: 1; }
.tag-category { font-size: 11px; color: var(--text-muted); padding: 2px 8px; background: var(--bg-secondary); border-radius: 4px; }
.tag-value { font-size: 12px; color: var(--retrofit-color); padding: 2px 8px; background: rgba(163, 113, 247, 0.15); border-radius: 4px; }
.rule-actions { display: flex; gap: 8px; }
.rule-delete { cursor: pointer; }
.config-actions { display: flex; gap: 12px; }

/* Revalidation */
.revalidation-container { padding: 24px; overflow-y: auto; flex: 1; }
.reval-header { margin-bottom: 20px; }
.reval-header h2 { font-size: 20px; margin-bottom: 4px; }
.reval-header p { color: var(--text-secondary); }
.reval-stats { display: grid; grid-template-columns: repeat(5, 1fr); gap: 12px; margin-bottom: 24px; }
.reval-stat { background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 8px; padding: 16px; text-align: center; }
.reval-stat-value { font-size: 28px; font-weight: 700; }
.reval-stat-label { font-size: 12px; color: var(--text-secondary); }
.reval-stat.valid .reval-stat-value { color: var(--success); }
.reval-stat.incomplete .reval-stat-value { color: var(--warning); }
.reval-stat.tune .reval-stat-value { color: var(--tune-color); }
.reval-stat.retrofit .reval-stat-value { color: var(--retrofit-color); }
.clickable-stat { cursor: pointer; transition: all 0.2s; }
.clickable-stat:hover { text-decoration: underline; }
.clickable-stat.active { text-decoration: underline; text-decoration-thickness: 3px; }
.reval-config { display: grid; grid-template-columns: 1fr 1fr auto; gap: 20px; margin-bottom: 24px; padding: 20px; background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 8px; align-items: end; }
.reval-config-section h4 { font-size: 13px; color: var(--text-secondary); margin-bottom: 12px; }
.field-checks-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; }
.field-check-item { display: flex; align-items: center; gap: 8px; font-size: 12px; cursor: pointer; padding: 4px 8px; border-radius: 4px; transition: background 0.2s; }
.field-check-item:hover { background: var(--bg-tertiary); }
.field-check-label { flex: 1; }
.field-count-badge { font-size: 10px; padding: 2px 6px; border-radius: 10px; font-weight: 500; }
.field-count-badge.success { background: rgba(63, 185, 80, 0.2); color: var(--success); }
.field-count-badge.warning { background: rgba(210, 153, 34, 0.2); color: var(--warning); }
.field-count-badge.error { background: rgba(248, 81, 73, 0.2); color: var(--error); }
.revalidation-results { display: flex; flex-direction: column; gap: 8px; }
.reval-item { display: flex; align-items: center; gap: 16px; padding: 16px; background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 8px; }
.reval-item.needs-tune { border-left: 3px solid var(--tune-color); }
.reval-item.needs-retrofit { border-left: 3px solid var(--retrofit-color); }
.reval-item.is-valid { border-left: 3px solid var(--success); }
.reval-item-info { flex: 1; }
.reval-item-name { font-weight: 500; margin-bottom: 4px; }
.reval-item-counts { display: flex; gap: 12px; font-size: 12px; color: var(--text-secondary); margin-bottom: 8px; }
.valid-badge { color: var(--success); font-weight: 500; }
.tune-badge { color: var(--tune-color); font-weight: 500; }
.retrofit-badge { color: var(--retrofit-color); font-weight: 500; }
.reval-item-missing { display: flex; flex-wrap: wrap; gap: 6px; }
.reval-missing-field { font-size: 11px; padding: 2px 8px; border-radius: 4px; }
.reval-missing-field.mandatory { background: rgba(248, 81, 73, 0.15); color: var(--error); }
.reval-missing-field.key { background: rgba(210, 153, 34, 0.15); color: var(--warning); }

/* History */
.history-layout { display: flex; flex: 1; overflow: hidden; }
.history-detail-pane { flex: 1; display: flex; flex-direction: column; border-right: 1px solid var(--border-color); overflow: hidden; }
.history-list-pane { width: 350px; display: flex; flex-direction: column; background: var(--bg-secondary); }
.history-detail-header { padding: 16px 20px; border-bottom: 1px solid var(--border-color); background: var(--bg-secondary); }
.history-detail-header h3 { font-size: 16px; margin-bottom: 12px; }
.history-type-filters { display: flex; gap: 8px; }
.history-type-btn { background: var(--bg-tertiary); border: 1px solid var(--border-color); color: var(--text-secondary); padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 12px; }
.history-type-btn:hover { border-color: var(--accent); }
.history-type-btn.active { background: var(--accent); color: #fff; border-color: var(--accent); }
.history-stats { display: flex; gap: 16px; padding: 12px 20px; border-bottom: 1px solid var(--border-color); font-size: 12px; }
.history-stat { color: var(--text-secondary); }
.history-stat span { font-weight: 600; color: var(--text-primary); }
.history-stat.tune span { color: var(--tune-color); }
.history-stat.retrofit span { color: var(--retrofit-color); }
.history-stat.version span { color: var(--accent); }
.history-timeline { flex: 1; overflow-y: auto; padding: 20px; }
.history-entry { display: flex; gap: 12px; margin-bottom: 16px; }
.history-entry-icon { width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 14px; flex-shrink: 0; }
.history-entry-icon.tune { background: rgba(240, 136, 62, 0.2); }
.history-entry-icon.retrofit { background: rgba(163, 113, 247, 0.2); }
.history-entry-icon.version { background: rgba(88, 166, 255, 0.2); }
.history-entry-content { flex: 1; }
.history-entry-header { display: flex; gap: 8px; align-items: center; margin-bottom: 4px; }
.history-entry-type { font-size: 11px; padding: 2px 8px; border-radius: 4px; text-transform: capitalize; font-weight: 500; }
.history-entry-type.tune { background: rgba(240, 136, 62, 0.2); color: var(--tune-color); }
.history-entry-type.retrofit { background: rgba(163, 113, 247, 0.2); color: var(--retrofit-color); }
.history-entry-type.version { background: rgba(88, 166, 255, 0.2); color: var(--accent); }
.history-entry-description { font-size: 13px; margin-bottom: 4px; }
.history-entry-time { font-size: 11px; color: var(--text-muted); }
.history-list-header { padding: 12px; border-bottom: 1px solid var(--border-color); display: flex; flex-direction: column; gap: 8px; }
.history-detection-list { flex: 1; overflow-y: auto; padding: 8px; }
.history-detection-item { padding: 12px; border-radius: 6px; cursor: pointer; transition: background 0.2s; margin-bottom: 4px; }
.history-detection-item:hover { background: var(--bg-tertiary); }
.history-detection-item.selected { background: var(--bg-tertiary); border-left: 3px solid var(--accent); }
.history-detection-item-name { font-size: 13px; font-weight: 500; margin-bottom: 4px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.history-detection-item-meta { display: flex; justify-content: space-between; font-size: 11px; color: var(--text-muted); }
.history-detection-item-count { color: var(--accent); }

/* Reports */
.reports-container { padding: 24px; overflow-y: auto; flex: 1; }
.reports-container h2 { font-size: 20px; margin-bottom: 20px; }
.reports-summary { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-bottom: 24px; }
.reports-summary.extra-stats { grid-template-columns: repeat(6, 1fr); }
.report-stat { background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 8px; padding: 16px; text-align: center; }
.report-stat-value { font-size: 24px; font-weight: 700; color: var(--accent); }
.report-stat-label { font-size: 12px; color: var(--text-secondary); }
.reports-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; margin-bottom: 24px; }
.report-card { background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 8px; padding: 20px; }
.report-card.full-width { grid-column: span 2; }
.report-card h3 { font-size: 14px; color: var(--text-secondary); margin-bottom: 16px; }
.report-chart { display: flex; flex-direction: column; gap: 8px; }
.mitre-heatmap { display: flex; flex-wrap: wrap; gap: 8px; }
.mitre-heatmap-cell { padding: 8px 12px; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: default; display: flex; flex-direction: column; align-items: center; }
.mitre-heatmap-cell .count { font-size: 10px; opacity: 0.8; }
.origin-breakdown { display: flex; gap: 12px; flex-wrap: wrap; }
.origin-item { display: flex; align-items: center; gap: 8px; padding: 8px 12px; background: var(--bg-tertiary); border-radius: 6px; }
.origin-label { font-size: 12px; color: var(--text-secondary); }
.origin-count { font-size: 14px; font-weight: 600; }

/* Buttons */
.btn-primary { background: var(--accent); color: #fff; border: none; padding: 10px 16px; border-radius: 6px; cursor: pointer; font-size: 13px; font-weight: 500; transition: background 0.2s; }
.btn-primary:hover { background: var(--accent-hover); }
.btn-primary:disabled { opacity: 0.5; cursor: not-allowed; }
.btn-secondary { background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color); padding: 10px 16px; border-radius: 6px; cursor: pointer; font-size: 13px; transition: all 0.2s; }
.btn-secondary:hover { border-color: var(--accent); }
.btn-danger { background: var(--error); color: #fff; border: none; padding: 10px 16px; border-radius: 6px; cursor: pointer; font-size: 13px; }
.btn-danger:hover { opacity: 0.9; }
.btn-tune { background: var(--tune-color); color: #fff; border: none; padding: 10px 16px; border-radius: 6px; cursor: pointer; font-size: 13px; }
.btn-retrofit { background: var(--retrofit-color); color: #fff; border: none; padding: 10px 16px; border-radius: 6px; cursor: pointer; font-size: 13px; }

/* Modals */
.modal { position: fixed; inset: 0; z-index: 1000; display: flex; align-items: center; justify-content: center; }
.modal-overlay { position: absolute; inset: 0; background: rgba(0, 0, 0, 0.6); }
.modal-content { position: relative; background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 12px; width: 90%; max-width: 500px; max-height: 90vh; overflow: hidden; display: flex; flex-direction: column; }
.modal-content.small { max-width: 400px; }
.modal-header { display: flex; justify-content: space-between; align-items: center; padding: 16px 20px; border-bottom: 1px solid var(--border-color); }
.modal-header h3 { font-size: 16px; }
.modal-close { background: none; border: none; color: var(--text-secondary); font-size: 24px; cursor: pointer; }
.modal-body { padding: 20px; overflow-y: auto; flex: 1; }
.modal-footer { padding: 16px 20px; border-top: 1px solid var(--border-color); display: flex; justify-content: flex-end; gap: 8px; }
.settings-status { margin-top: 16px; padding: 12px; border-radius: 6px; font-size: 13px; }
.settings-status.success { background: rgba(63, 185, 80, 0.15); color: var(--success); }
.settings-status.error { background: rgba(248, 81, 73, 0.15); color: var(--error); }
.settings-status.warning { background: rgba(210, 153, 34, 0.15); color: var(--warning); }
.settings-status.info { background: rgba(88, 166, 255, 0.15); color: var(--accent); }
.import-dropzone { border: 2px dashed var(--border-color); border-radius: 8px; padding: 40px; text-align: center; cursor: pointer; transition: all 0.2s; }
.import-dropzone:hover, .import-dropzone.dragover { border-color: var(--accent); background: rgba(88, 166, 255, 0.05); }
.dropzone-icon { font-size: 48px; margin-bottom: 12px; }
.import-progress { margin-top: 20px; }
.progress-bar { height: 8px; background: var(--bg-tertiary); border-radius: 4px; overflow: hidden; }
.progress-fill { height: 100%; background: var(--accent); transition: width 0.3s; }
.import-results { margin-top: 16px; padding: 16px; background: var(--bg-tertiary); border-radius: 6px; }

/* Macro Details Modal */
.macro-details-modal .modal-content { max-width: 550px; }
.macro-details-modal .modal-header h3 { display: flex; align-items: center; gap: 8px; font-family: inherit; }
.macro-details-modal .modal-header h3 code { font-size: 14px; background: var(--bg-tertiary); padding: 2px 8px; border-radius: 4px; }
.macro-missing-indicator { color: var(--warning); }
.macro-deprecated-indicator { color: var(--warning); }
.macro-deprecated-badge { font-size: 10px; background: rgba(210, 153, 34, 0.2); color: var(--warning); padding: 2px 6px; border-radius: 4px; text-transform: uppercase; font-weight: 500; }
.macro-details-content { display: flex; flex-direction: column; gap: 16px; }
.macro-detail-field { display: flex; flex-direction: column; gap: 4px; }
.macro-detail-field label { font-size: 11px; text-transform: uppercase; color: var(--text-muted); font-weight: 500; letter-spacing: 0.5px; }
.macro-detail-field .macro-detail-value { font-size: 13px; color: var(--text-primary); }
.macro-detail-field .macro-detail-value pre { background: var(--bg-tertiary); padding: 12px; border-radius: 6px; font-family: monospace; font-size: 12px; white-space: pre-wrap; word-break: break-word; margin: 0; overflow-x: auto; }
.macro-detail-field .macro-detail-value code { background: var(--bg-tertiary); padding: 2px 6px; border-radius: 4px; font-family: monospace; }
.macro-detail-field .macro-detail-value .text-muted { color: var(--text-muted); }
.macro-details-missing { text-align: center; padding: 20px 0; }
.macro-details-missing p { margin-bottom: 12px; color: var(--text-secondary); }
.macro-details-missing code { background: var(--bg-tertiary); padding: 2px 8px; border-radius: 4px; font-family: monospace; color: var(--warning); }
.macro-details-missing .btn-primary { margin-top: 8px; }

/* Toast */
.toast-container { position: fixed; bottom: 20px; right: 20px; display: flex; flex-direction: column; gap: 8px; z-index: 2000; }
.toast { display: flex; align-items: center; gap: 12px; padding: 12px 16px; background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 8px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2); animation: slideIn 0.3s; }
.toast.success { border-left: 3px solid var(--success); }
.toast.error { border-left: 3px solid var(--error); }
.toast.warning { border-left: 3px solid var(--warning); }
.toast.info { border-left: 3px solid var(--accent); }
.toast-icon { font-size: 16px; }
.toast-message { font-size: 13px; }
.toast-close { cursor: pointer; color: var(--text-muted); margin-left: auto; }
@keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }

.empty-state { display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 40px; color: var(--text-muted); }
.empty-icon { font-size: 48px; margin-bottom: 12px; opacity: 0.5; }

::-webkit-scrollbar { width: 8px; height: 8px; }
::-webkit-scrollbar-track { background: var(--bg-secondary); }
::-webkit-scrollbar-thumb { background: var(--border-color); border-radius: 4px; }
::-webkit-scrollbar-thumb:hover { background: var(--text-muted); }

@media (max-width: 1200px) {
    .stats-row { grid-template-columns: repeat(3, 1fr); }
    .charts-row { grid-template-columns: repeat(2, 1fr); }
    .lists-row { grid-template-columns: 1fr; }
}
@media (max-width: 900px) {
    .library-layout, .history-layout { flex-direction: column; }
    .library-list-pane, .history-list-pane { width: 100%; height: 300px; }
    .editor-layout { flex-direction: column; }
    .editor-sidebar { width: 100%; max-height: 300px; }
    .roles-display { grid-template-columns: 1fr; }
}

/* =============================================================================
   V9.1 TTL STYLES
   ============================================================================= */

.ttl-badge {
    font-size: 10px;
    padding: 2px 6px;
    border-radius: 4px;
    font-weight: 500;
    white-space: nowrap;
}

.ttl-ok { background: rgba(63, 185, 80, 0.15); color: #3fb950; }
.ttl-warning { background: rgba(210, 153, 34, 0.15); color: #d29922; }
.ttl-critical { background: rgba(240, 136, 62, 0.15); color: #f0883e; }
.ttl-expired { background: rgba(248, 81, 73, 0.15); color: #f85149; }

.ttl-banner {
    padding: 10px 14px;
    border-radius: 6px;
    margin-bottom: 12px;
    font-size: 13px;
    font-weight: 500;
}

.ttl-banner.ttl-critical {
    background: rgba(240, 136, 62, 0.12);
    border: 1px solid #f0883e;
    color: #f0883e;
}

.ttl-banner.ttl-expired {
    background: rgba(248, 81, 73, 0.12);
    border: 1px solid #f85149;
    color: #f85149;
}

/* =============================================================================
   V10 UI IMPROVEMENTS
   ============================================================================= */

/* --- LIBRARY IMPROVEMENTS --- */
.library-layout {
    display: grid;
    grid-template-columns: 1fr 380px;
    gap: 0;
    height: calc(100vh - 60px);
}

.library-list-pane {
    background: var(--bg-secondary);
    border-left: 1px solid var(--border);
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

.library-detail-pane {
    padding: 24px;
    overflow-y: auto;
    background: var(--bg-primary);
}

.library-list {
    flex: 1;
    overflow-y: auto;
    padding: 8px;
}

.library-list-item {
    background: var(--bg-primary);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 14px 16px;
    margin-bottom: 8px;
    cursor: pointer;
    transition: all 0.2s ease;
    box-shadow: 0 1px 3px rgba(0,0,0,0.08);
}

.library-list-item:hover {
    border-color: var(--accent);
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.12);
}

.library-list-item.selected {
    border-color: var(--accent);
    background: linear-gradient(135deg, var(--bg-primary) 0%, rgba(88, 166, 255, 0.08) 100%);
    box-shadow: 0 0 0 2px rgba(88, 166, 255, 0.2);
}

.library-list-item-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    gap: 12px;
    margin-bottom: 10px;
}

.library-list-item-name {
    font-weight: 600;
    font-size: 13px;
    color: var(--text-primary);
    line-height: 1.4;
    flex: 1;
}

.library-list-item-meta {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
    font-size: 11px;
    color: var(--text-secondary);
}

.library-list-item-meta span {
    background: var(--bg-tertiary);
    padding: 3px 8px;
    border-radius: 4px;
}

.card-severity {
    padding: 3px 10px;
    border-radius: 6px;
    font-size: 10px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.card-severity.critical { background: rgba(248, 81, 73, 0.15); color: #f85149; }
.card-severity.high { background: rgba(240, 136, 62, 0.15); color: #f0883e; }
.card-severity.medium { background: rgba(210, 153, 34, 0.15); color: #d29922; }
.card-severity.low { background: rgba(63, 185, 80, 0.15); color: #3fb950; }
.card-severity.informational { background: rgba(88, 166, 255, 0.15); color: #58a6ff; }

/* Detail pane improvements */
.detail-placeholder {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100%;
    color: var(--text-muted);
}

.placeholder-icon {
    font-size: 48px;
    margin-bottom: 16px;
    opacity: 0.5;
}

.detail-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 24px;
    padding-bottom: 16px;
    border-bottom: 1px solid var(--border);
}

.detail-header h2 {
    font-size: 20px;
    font-weight: 600;
    color: var(--text-primary);
    margin: 0;
    flex: 1;
}

.detail-actions {
    display: flex;
    gap: 8px;
}

.detail-section {
    margin-bottom: 20px;
}

.detail-section h4 {
    font-size: 11px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: var(--text-secondary);
    margin-bottom: 8px;
}

.detail-value {
    color: var(--text-primary);
    font-size: 14px;
    line-height: 1.6;
}

.code-block {
    background: var(--bg-tertiary);
    padding: 12px 16px;
    border-radius: 8px;
    font-family: 'Monaco', 'Menlo', monospace;
    font-size: 12px;
    white-space: pre-wrap;
    word-break: break-word;
    border: 1px solid var(--border);
}

/* --- EDITOR IMPROVEMENTS --- */
.editor-layout {
    display: grid;
    grid-template-columns: 1fr 300px;
    gap: 0;
    height: calc(100vh - 60px);
}

.editor-main {
    display: flex;
    flex-direction: column;
    overflow: hidden;
    background: var(--bg-primary);
}

.editor-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 16px 24px;
    border-bottom: 1px solid var(--border);
    background: var(--bg-secondary);
}

.editor-header h2 {
    font-size: 18px;
    font-weight: 600;
    margin: 0;
}

.editor-tabs {
    display: flex;
    gap: 4px;
    background: var(--bg-tertiary);
    padding: 4px;
    border-radius: 8px;
}

.editor-tab {
    padding: 8px 16px;
    border: none;
    background: transparent;
    color: var(--text-secondary);
    border-radius: 6px;
    cursor: pointer;
    font-size: 13px;
    font-weight: 500;
    transition: all 0.2s;
}

.editor-tab:hover {
    color: var(--text-primary);
}

.editor-tab.active {
    background: var(--bg-primary);
    color: var(--accent);
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}

.editor-content {
    flex: 1;
    overflow-y: auto;
    padding: 24px;
}

.editor-sidebar {
    background: var(--bg-secondary);
    border-left: 1px solid var(--border);
    padding: 20px;
    display: flex;
    flex-direction: column;
    gap: 20px;
    overflow-y: auto;
}

.sidebar-section {
    background: var(--bg-primary);
    border-radius: 10px;
    padding: 16px;
    border: 1px solid var(--border);
}

.sidebar-section h3 {
    font-size: 12px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: var(--text-secondary);
    margin: 0 0 12px 0;
}

.sidebar-actions {
    display: flex;
    flex-direction: column;
    gap: 8px;
    margin-top: auto;
}

/* Form improvements */
.detection-form {
    max-width: 900px;
}

.form-section {
    background: var(--bg-secondary);
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 20px;
    border: 1px solid var(--border);
}

.section-header {
    font-size: 14px;
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 16px;
    padding-bottom: 12px;
    border-bottom: 1px solid var(--border);
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
}

.section-header::before {
    content: 'â–¼';
    font-size: 10px;
    color: var(--text-secondary);
    transition: transform 0.2s;
}

.form-section.collapsed .section-header::before {
    transform: rotate(-90deg);
}

.form-row {
    display: flex;
    gap: 16px;
    margin-bottom: 16px;
}

.form-row:last-child {
    margin-bottom: 0;
}

.form-group {
    flex: 1;
}

.form-group.full {
    flex: 100%;
}

.form-group label {
    display: block;
    font-size: 12px;
    font-weight: 500;
    color: var(--text-secondary);
    margin-bottom: 6px;
}

.form-group input,
.form-group select,
.form-group textarea {
    width: 100%;
    padding: 10px 12px;
    border: 1px solid var(--border);
    border-radius: 8px;
    background: var(--bg-primary);
    color: var(--text-primary);
    font-size: 13px;
    transition: all 0.2s;
}

.form-group input:focus,
.form-group select:focus,
.form-group textarea:focus {
    outline: none;
    border-color: var(--accent);
    box-shadow: 0 0 0 3px rgba(88, 166, 255, 0.15);
}

.form-group textarea {
    resize: vertical;
    min-height: 80px;
}

.spl-input {
    font-family: 'Monaco', 'Menlo', monospace;
    font-size: 12px;
    line-height: 1.5;
}

/* Roles grid */
.roles-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 12px;
}

.role-card {
    background: var(--bg-primary);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 12px;
}

.role-title {
    font-size: 11px;
    font-weight: 600;
    text-transform: uppercase;
    color: var(--text-secondary);
    margin-bottom: 8px;
}

.role-card input {
    margin-bottom: 8px;
}

.role-card input:last-child {
    margin-bottom: 0;
}

/* --- MODAL IMPROVEMENTS --- */
.modal-wide .modal-content {
    max-width: 600px;
}

.modal-detection-label {
    background: var(--bg-tertiary);
    padding: 10px 14px;
    border-radius: 8px;
    margin-bottom: 20px;
    font-size: 13px;
}

.modal-detection-label strong {
    color: var(--accent);
}

.jira-input-wrapper {
    display: flex;
    align-items: center;
    border: 1px solid var(--border);
    border-radius: 8px;
    overflow: hidden;
    background: var(--bg-primary);
}

.jira-prefix {
    padding: 10px 12px;
    background: var(--bg-tertiary);
    color: var(--text-secondary);
    font-weight: 600;
    font-size: 13px;
    border-right: 1px solid var(--border);
}

.jira-input {
    border: none !important;
    border-radius: 0 !important;
    flex: 1;
}

.jira-input:focus {
    box-shadow: none !important;
}

.field-checkbox-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 8px;
    max-height: 200px;
    overflow-y: auto;
    padding: 12px;
    background: var(--bg-tertiary);
    border-radius: 8px;
}

.field-checkbox-item {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 12px;
    padding: 6px 8px;
    border-radius: 6px;
    cursor: pointer;
    transition: background 0.2s;
}

.field-checkbox-item:hover {
    background: var(--bg-secondary);
}

.field-checkbox-item input {
    width: 16px;
    height: 16px;
    cursor: pointer;
}

/* --- REVALIDATION IMPROVEMENTS --- */
.revalidation-container {
    padding: 24px;
    max-width: 1400px;
    margin: 0 auto;
}

.reval-header {
    margin-bottom: 24px;
}

.reval-header h2 {
    margin: 0 0 8px 0;
    font-size: 24px;
}

.reval-header p {
    color: var(--text-secondary);
    margin: 0;
}

.reval-stats {
    display: flex;
    gap: 12px;
    margin-bottom: 24px;
}

.reval-stat {
    flex: 1;
    background: var(--bg-secondary);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 16px;
    text-align: center;
    transition: all 0.2s;
}

.reval-stat.clickable {
    cursor: pointer;
}

.reval-stat.clickable:hover {
    border-color: var(--accent);
    transform: translateY(-2px);
}

.reval-stat.clickable.active {
    border-color: var(--accent);
    box-shadow: 0 0 0 2px rgba(88, 166, 255, 0.2);
}

.reval-stat-value {
    font-size: 28px;
    font-weight: 700;
    color: var(--text-primary);
}

.reval-stat-label {
    font-size: 12px;
    color: var(--text-secondary);
    margin-top: 4px;
}

.reval-stat.valid .reval-stat-value { color: #3fb950; }
.reval-stat.incomplete .reval-stat-value { color: #d29922; }
.reval-stat.tune .reval-stat-value { color: var(--tune-color); }
.reval-stat.retrofit .reval-stat-value { color: var(--retrofit-color); }

.reval-filters-panel {
    background: var(--bg-secondary);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 24px;
}

.reval-fields-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 24px;
    margin-bottom: 16px;
}

.reval-field-group h5 {
    font-size: 12px;
    font-weight: 600;
    color: var(--text-secondary);
    margin: 0 0 12px 0;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.field-checks {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
}

.field-check-item {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 8px 12px;
    background: var(--bg-primary);
    border: 1px solid var(--border);
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s;
    font-size: 12px;
}

.field-check-item:hover {
    border-color: var(--accent);
}

.field-check-item.active {
    background: rgba(88, 166, 255, 0.1);
    border-color: var(--accent);
    color: var(--accent);
}

.field-check-item input {
    display: none;
}

.field-check-count {
    background: var(--bg-tertiary);
    padding: 2px 6px;
    border-radius: 4px;
    font-size: 10px;
    font-weight: 600;
}

.filter-hint {
    font-size: 11px;
    font-weight: 400;
    color: var(--text-muted);
}

.reval-actions {
    display: flex;
    gap: 12px;
    justify-content: flex-end;
}

.reval-results-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;
}

.reval-results-header span {
    font-size: 14px;
    color: var(--text-secondary);
}

.revalidation-results {
    display: grid;
    gap: 12px;
}

.reval-result-card {
    background: var(--bg-secondary);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 16px;
    display: grid;
    grid-template-columns: 1fr auto;
    gap: 16px;
    align-items: center;
    transition: all 0.2s;
}

.reval-result-card:hover {
    border-color: var(--accent);
}

.reval-result-info h4 {
    font-size: 14px;
    font-weight: 600;
    margin: 0 0 8px 0;
    color: var(--text-primary);
}

.reval-result-badges {
    display: flex;
    gap: 6px;
    flex-wrap: wrap;
}

.reval-missing-field {
    font-size: 10px;
    padding: 3px 8px;
    border-radius: 4px;
    background: rgba(248, 81, 73, 0.1);
    color: #f85149;
}

.reval-missing-field.key {
    background: rgba(210, 153, 34, 0.1);
    color: #d29922;
}

.reval-result-actions {
    display: flex;
    gap: 8px;
}

/* --- HISTORY IMPROVEMENTS --- */
.history-layout {
    display: grid;
    grid-template-columns: 1fr 400px;
    height: calc(100vh - 60px);
}

.history-detail-pane {
    padding: 24px;
    overflow-y: auto;
    background: var(--bg-primary);
}

.history-list-pane {
    background: var(--bg-secondary);
    border-left: 1px solid var(--border);
    display: flex;
    flex-direction: column;
}

.history-list-header {
    padding: 16px;
    border-bottom: 1px solid var(--border);
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.history-detection-list {
    flex: 1;
    overflow-y: auto;
    padding: 12px;
}

.history-detection-item {
    background: var(--bg-primary);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 14px;
    margin-bottom: 8px;
    cursor: pointer;
    transition: all 0.2s;
}

.history-detection-item:hover {
    border-color: var(--accent);
}

.history-detection-item.selected {
    border-color: var(--accent);
    background: linear-gradient(135deg, var(--bg-primary) 0%, rgba(88, 166, 255, 0.08) 100%);
}

.history-detection-item h4 {
    font-size: 13px;
    font-weight: 600;
    margin: 0 0 10px 0;
    color: var(--text-primary);
    line-height: 1.4;
}

.history-item-tags {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
}

.history-tag {
    font-size: 10px;
    padding: 4px 8px;
    border-radius: 6px;
    font-weight: 500;
}

.history-tag.tune {
    background: rgba(136, 87, 44, 0.15);
    color: var(--tune-color);
}

.history-tag.retrofit {
    background: rgba(88, 166, 255, 0.15);
    color: var(--retrofit-color);
}

.history-tag.revalidation {
    background: rgba(63, 185, 80, 0.15);
    color: #3fb950;
}

.history-detail-header {
    margin-bottom: 20px;
}

.history-detail-header h3 {
    margin: 0 0 16px 0;
    font-size: 18px;
}

.history-type-filters {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
}

.history-type-btn {
    padding: 8px 14px;
    border: 1px solid var(--border);
    border-radius: 8px;
    background: var(--bg-secondary);
    color: var(--text-secondary);
    cursor: pointer;
    font-size: 12px;
    font-weight: 500;
    transition: all 0.2s;
}

.history-type-btn:hover {
    border-color: var(--accent);
    color: var(--text-primary);
}

.history-type-btn.active {
    background: var(--accent);
    border-color: var(--accent);
    color: white;
}

.history-stats {
    display: flex;
    gap: 16px;
    margin-bottom: 20px;
    padding: 16px;
    background: var(--bg-secondary);
    border-radius: 10px;
}

.history-stat {
    font-size: 13px;
    color: var(--text-secondary);
}

.history-stat span {
    font-weight: 700;
    color: var(--text-primary);
}

.history-stat.tune span { color: var(--tune-color); }
.history-stat.retrofit span { color: var(--retrofit-color); }
.history-stat.revalidation span { color: #3fb950; }

.history-timeline {
    position: relative;
}

.history-entry {
    position: relative;
    padding-left: 32px;
    padding-bottom: 24px;
    border-left: 2px solid var(--border);
    margin-left: 8px;
}

.history-entry:last-child {
    border-left-color: transparent;
    padding-bottom: 0;
}

.history-entry-marker {
    position: absolute;
    left: -9px;
    top: 0;
    width: 16px;
    height: 16px;
    border-radius: 50%;
    background: var(--bg-secondary);
    border: 2px solid var(--border);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 10px;
}

.history-entry.tune .history-entry-marker {
    border-color: var(--tune-color);
    background: rgba(136, 87, 44, 0.15);
}

.history-entry.retrofit .history-entry-marker {
    border-color: var(--retrofit-color);
    background: rgba(88, 166, 255, 0.15);
}

.history-entry.revalidation .history-entry-marker {
    border-color: #3fb950;
    background: rgba(63, 185, 80, 0.15);
}

.history-entry-content {
    background: var(--bg-secondary);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 14px;
}

.history-entry-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 8px;
}

.history-entry-type {
    font-size: 11px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.history-entry.tune .history-entry-type { color: var(--tune-color); }
.history-entry.retrofit .history-entry-type { color: var(--retrofit-color); }
.history-entry.revalidation .history-entry-type { color: #3fb950; }

.history-entry-date {
    font-size: 11px;
    color: var(--text-muted);
}

.history-entry-desc {
    font-size: 13px;
    color: var(--text-primary);
    line-height: 1.5;
    margin-bottom: 8px;
}

.history-entry-meta {
    font-size: 11px;
    color: var(--text-secondary);
    display: flex;
    flex-wrap: wrap;
    gap: 12px;
}

.history-entry-jira {
    background: var(--bg-tertiary);
    padding: 2px 8px;
    border-radius: 4px;
    font-weight: 600;
}

/* --- BUTTON IMPROVEMENTS --- */
.btn-tune {
    background: linear-gradient(135deg, var(--tune-color) 0%, #a06030 100%);
    color: white;
    border: none;
    padding: 10px 16px;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
}

.btn-tune:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(136, 87, 44, 0.3);
}

.btn-retrofit {
    background: linear-gradient(135deg, var(--retrofit-color) 0%, #3080d0 100%);
    color: white;
    border: none;
    padding: 10px 16px;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
}

.btn-retrofit:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(88, 166, 255, 0.3);
}

.btn-primary {
    background: linear-gradient(135deg, var(--accent) 0%, #3080d0 100%);
    color: white;
    border: none;
    padding: 10px 16px;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
}

.btn-primary:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(88, 166, 255, 0.3);
}

.btn-secondary {
    background: var(--bg-secondary);
    color: var(--text-primary);
    border: 1px solid var(--border);
    padding: 10px 16px;
    border-radius: 8px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s;
}

.btn-secondary:hover {
    border-color: var(--accent);
    background: var(--bg-tertiary);
}

.btn-danger {
    background: linear-gradient(135deg, #f85149 0%, #da3633 100%);
    color: white;
    border: none;
    padding: 10px 16px;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
}

.btn-danger:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(248, 81, 73, 0.3);
}

/* Additional V10 styles */
.btn-sm {
    padding: 6px 12px;
    font-size: 12px;
}

.no-missing {
    color: #3fb950;
    font-size: 13px;
    padding: 8px;
}

.history-tag.empty {
    background: var(--bg-tertiary);
    color: var(--text-muted);
}

.status-badge {
    font-size: 10px;
    padding: 3px 8px;
    border-radius: 4px;
    font-weight: 600;
}

.status-badge.valid {
    background: rgba(63, 185, 80, 0.15);
    color: #3fb950;
}

.status-badge.need-tune {
    background: rgba(136, 87, 44, 0.15);
    color: var(--tune-color);
}

.status-badge.need-retrofit {
    background: rgba(88, 166, 255, 0.15);
    color: var(--retrofit-color);
}

/* Filter bar improvements */
.filter-bar {
    display: flex;
    gap: 8px;
    padding: 12px 16px;
    background: var(--bg-secondary);
    border-bottom: 1px solid var(--border);
    flex-wrap: wrap;
}

.search-input {
    flex: 1;
    min-width: 200px;
    padding: 10px 14px;
    border: 1px solid var(--border);
    border-radius: 8px;
    background: var(--bg-primary);
    color: var(--text-primary);
    font-size: 13px;
}

.search-input:focus {
    outline: none;
    border-color: var(--accent);
    box-shadow: 0 0 0 3px rgba(88, 166, 255, 0.15);
}

.filter-select {
    padding: 10px 14px;
    border: 1px solid var(--border);
    border-radius: 8px;
    background: var(--bg-primary);
    color: var(--text-primary);
    font-size: 13px;
    cursor: pointer;
}

.filter-select:focus {
    outline: none;
    border-color: var(--accent);
}

/* Modal improvements */
.modal-content {
    background: var(--bg-primary);
    border-radius: 16px;
    max-width: 500px;
    width: 90%;
    max-height: 90vh;
    overflow-y: auto;
    box-shadow: 0 20px 60px rgba(0,0,0,0.4);
}

.modal-content.modal-wide {
    max-width: 650px;
}

.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 20px 24px;
    border-bottom: 1px solid var(--border);
}

.modal-header h3 {
    margin: 0;
    font-size: 18px;
}

.modal-close {
    background: none;
    border: none;
    font-size: 24px;
    color: var(--text-muted);
    cursor: pointer;
    padding: 0;
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 6px;
    transition: all 0.2s;
}

.modal-close:hover {
    background: var(--bg-tertiary);
    color: var(--text-primary);
}

.modal-body {
    padding: 24px;
}

.modal-footer {
    padding: 16px 24px;
    border-top: 1px solid var(--border);
    display: flex;
    gap: 12px;
    justify-content: flex-end;
}

/* Button sizes */
.btn-sm {
    padding: 6px 12px;
    font-size: 12px;
}

/* No missing indicator */
.no-missing {
    color: #3fb950;
    font-size: 13px;
    padding: 8px;
}

/* Status badges */
.status-badge {
    font-size: 10px;
    padding: 3px 8px;
    border-radius: 4px;
    font-weight: 600;
}

.status-badge.valid {
    background: rgba(63, 185, 80, 0.15);
    color: #3fb950;
}

.status-badge.need-tune {
    background: rgba(136, 87, 44, 0.15);
    color: var(--tune-color);
}

.status-badge.need-retrofit {
    background: rgba(88, 166, 255, 0.15);
    color: var(--retrofit-color);
}

/* History empty tag */
.history-tag.empty {
    background: var(--bg-tertiary);
    color: var(--text-muted);
}

/* Filter bar improvements */
.filter-bar {
    padding: 12px 16px;
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
    border-bottom: 1px solid var(--border);
    background: var(--bg-secondary);
}

.filter-select {
    padding: 8px 12px;
    border: 1px solid var(--border);
    border-radius: 6px;
    background: var(--bg-primary);
    color: var(--text-primary);
    font-size: 12px;
    min-width: 120px;
}

.search-input {
    padding: 8px 12px;
    border: 1px solid var(--border);
    border-radius: 6px;
    background: var(--bg-primary);
    color: var(--text-primary);
    font-size: 13px;
    flex: 1;
    min-width: 200px;
}

.search-input:focus,
.filter-select:focus {
    outline: none;
    border-color: var(--accent);
}

/* =============================================================================
   V10 ADDITIONAL STYLES
   ============================================================================= */

/* Multi-select dropdown */
.multi-select-wrapper {
    position: relative;
}

.multi-select-display {
    padding: 10px 12px;
    border: 1px solid var(--border);
    border-radius: 8px;
    background: var(--bg-primary);
    cursor: pointer;
    min-height: 42px;
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    align-items: center;
}

.multi-select-display:hover {
    border-color: var(--accent);
}

.multi-select-display .placeholder {
    color: var(--text-muted);
    font-size: 13px;
}

.multi-select-tag {
    background: var(--bg-tertiary);
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 12px;
    color: var(--text-primary);
}

.multi-select-dropdown {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background: var(--bg-primary);
    border: 1px solid var(--border);
    border-radius: 8px;
    margin-top: 4px;
    max-height: 250px;
    overflow-y: auto;
    z-index: 100;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}

.multi-select-option {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 10px 14px;
    cursor: pointer;
    font-size: 13px;
    transition: background 0.15s;
}

.multi-select-option:hover {
    background: var(--bg-secondary);
}

.multi-select-option input {
    width: 16px;
    height: 16px;
    cursor: pointer;
}

/* Metadata Modal */
.modal-large .modal-content {
    max-width: 800px;
    max-height: 80vh;
}

.modal-header-actions {
    display: flex;
    align-items: center;
    gap: 16px;
}

.metadata-view-toggle {
    display: flex;
    background: var(--bg-tertiary);
    border-radius: 6px;
    padding: 3px;
}

.toggle-btn {
    padding: 6px 14px;
    border: none;
    background: transparent;
    color: var(--text-secondary);
    cursor: pointer;
    border-radius: 4px;
    font-size: 12px;
    font-weight: 500;
    transition: all 0.2s;
}

.toggle-btn.active {
    background: var(--bg-primary);
    color: var(--accent);
}

.metadata-title {
    font-size: 16px;
    font-weight: 600;
    margin-bottom: 20px;
    padding-bottom: 12px;
    border-bottom: 1px solid var(--border);
}

.metadata-section {
    margin-bottom: 20px;
}

.metadata-section h4 {
    font-size: 11px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: var(--text-secondary);
    margin-bottom: 10px;
}

.metadata-ttl {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 16px;
    border-radius: 8px;
}

.metadata-ttl.ttl-ok { background: rgba(63, 185, 80, 0.1); }
.metadata-ttl.ttl-warning { background: rgba(210, 153, 34, 0.1); }
.metadata-ttl.ttl-critical { background: rgba(240, 136, 62, 0.1); }
.metadata-ttl.ttl-expired { background: rgba(248, 81, 73, 0.1); }

.ttl-days {
    font-size: 24px;
    font-weight: 700;
}

.ttl-label {
    font-size: 13px;
    font-weight: 500;
}

.metadata-parsed {
    background: var(--bg-secondary);
    border-radius: 8px;
    padding: 12px;
}

.parsed-item {
    display: flex;
    gap: 12px;
    padding: 8px 0;
    border-bottom: 1px solid var(--border);
}

.parsed-item:last-child {
    border-bottom: none;
}

.parsed-label {
    font-weight: 500;
    min-width: 100px;
    color: var(--text-secondary);
    font-size: 12px;
}

.parsed-value {
    font-size: 13px;
    color: var(--text-primary);
}

.parsed-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
}

.tag {
    background: var(--bg-tertiary);
    padding: 3px 8px;
    border-radius: 4px;
    font-size: 11px;
}

.metadata-history-summary {
    display: flex;
    gap: 16px;
}

.history-count {
    font-size: 13px;
}

.history-count.tune { color: var(--tune-color); }
.history-count.retrofit { color: var(--retrofit-color); }
.history-count.reval { color: #3fb950; }

.metadata-history-list {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.metadata-history-item {
    display: flex;
    gap: 12px;
    padding: 12px;
    background: var(--bg-secondary);
    border-radius: 8px;
    border-left: 3px solid var(--border);
}

.metadata-history-item.tune { border-left-color: var(--tune-color); }
.metadata-history-item.retrofit { border-left-color: var(--retrofit-color); }

.history-icon {
    font-size: 16px;
}

.history-details {
    flex: 1;
}

.history-desc {
    font-size: 13px;
    margin-bottom: 4px;
}

.history-meta {
    display: flex;
    gap: 12px;
    font-size: 11px;
    color: var(--text-secondary);
}

.history-meta .jira {
    font-weight: 600;
    color: var(--accent);
}

/* Reports Tabs */
.reports-tabs {
    display: flex;
    gap: 4px;
    margin-bottom: 24px;
    background: var(--bg-secondary);
    padding: 4px;
    border-radius: 10px;
    width: fit-content;
}

.reports-tab {
    padding: 10px 20px;
    border: none;
    background: transparent;
    color: var(--text-secondary);
    cursor: pointer;
    border-radius: 8px;
    font-size: 13px;
    font-weight: 500;
    transition: all 0.2s;
}

.reports-tab:hover {
    color: var(--text-primary);
}

.reports-tab.active {
    background: var(--bg-primary);
    color: var(--accent);
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}

.reports-tab-content {
    display: none;
}

.reports-tab-content.active {
    display: block;
}

/* Reports Charts */
.field-missing-chart {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.field-bar-row {
    display: grid;
    grid-template-columns: 150px 1fr 50px;
    gap: 12px;
    align-items: center;
}

.field-name {
    font-size: 12px;
    color: var(--text-primary);
}

.field-bar {
    height: 8px;
    background: var(--bg-tertiary);
    border-radius: 4px;
    overflow: hidden;
}

.field-bar-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--tune-color), #f0883e);
    border-radius: 4px;
}

.field-count {
    font-size: 12px;
    font-weight: 600;
    color: var(--text-secondary);
    text-align: right;
}

.ttl-summary-chart {
    display: flex;
    gap: 16px;
    flex-wrap: wrap;
}

.ttl-bar-item {
    display: flex;
    gap: 8px;
    align-items: center;
    padding: 10px 16px;
    background: var(--bg-secondary);
    border-radius: 8px;
}

.ttl-label {
    font-size: 12px;
    font-weight: 500;
}

.ttl-count {
    font-size: 18px;
    font-weight: 700;
}

.meta-chart {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.meta-bar-row {
    display: flex;
    justify-content: space-between;
    padding: 8px 12px;
    background: var(--bg-secondary);
    border-radius: 6px;
}

.meta-label {
    font-size: 13px;
}

.meta-count {
    font-weight: 600;
    color: var(--accent);
}

.activity-timeline {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.activity-item {
    display: flex;
    gap: 12px;
    padding: 12px;
    background: var(--bg-secondary);
    border-radius: 8px;
    align-items: center;
}

.activity-icon {
    font-size: 16px;
}

.activity-content {
    flex: 1;
}

.activity-detection {
    font-weight: 600;
    font-size: 13px;
    display: block;
    margin-bottom: 2px;
}

.activity-desc {
    font-size: 12px;
    color: var(--text-secondary);
}

.activity-date {
    font-size: 11px;
    color: var(--text-muted);
}

/* History filters row */
.history-filters-row {
    display: flex;
    gap: 8px;
}

.history-filters-row .filter-select {
    flex: 1;
    min-width: 0;
}

/* Report subtitle */
.report-subtitle {
    color: var(--text-secondary);
    font-size: 14px;
    margin-bottom: 20px;
}

/* Metadata note */
.metadata-note {
    color: var(--text-muted);
    font-size: 12px;
    font-style: italic;
    margin-bottom: 12px;
}

/* Function tag styling */
.tag.func {
    background: #2d4a3e;
    color: #3fb950;
}

/* Variable tag styling */
.tag.variable {
    background: #3d3425;
    color: #d2a04a;
}

/* Custom tag styling */
.tag.custom {
    background: #3d2d4a;
    color: #b87fff;
}

/* Fix field-check-item clickability */
.field-check-item {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 12px;
    background: var(--bg-secondary);
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.2s;
    user-select: none;
}

.field-check-item:hover {
    background: var(--bg-tertiary);
}

.field-check-item.active {
    background: rgba(56, 139, 253, 0.15);
    border: 1px solid var(--accent);
}

.field-check-item input[type="checkbox"] {
    pointer-events: none;
    width: 16px;
    height: 16px;
}

.field-check-label {
    flex: 1;
    font-size: 13px;
}

.field-check-count {
    font-size: 12px;
    font-weight: 600;
    color: var(--accent);
    background: rgba(56, 139, 253, 0.1);
    padding: 2px 8px;
    border-radius: 10px;
}

/* Card tag for functions */
.card-tag.function {
    background: #2d4a3e;
    color: #3fb950;
}

/* Built-in parsing info */
.builtin-parsing-info {
    display: flex;
    flex-direction: column;
    gap: 16px;
    margin-top: 16px;
}

.parsing-rule-card {
    background: var(--bg-secondary);
    border-radius: 8px;
    padding: 16px;
    border-left: 3px solid var(--accent);
}

.parsing-rule-card h4 {
    margin: 0 0 8px 0;
    font-size: 14px;
    color: var(--accent);
}

.parsing-rule-card p {
    margin: 0 0 12px 0;
    font-size: 13px;
    color: var(--text-secondary);
}

.parsing-rule-card code {
    background: var(--bg-tertiary);
    padding: 2px 6px;
    border-radius: 4px;
    font-family: monospace;
    font-size: 12px;
}

.parsing-example {
    background: var(--bg-tertiary);
    padding: 10px 12px;
    border-radius: 6px;
    font-size: 12px;
}

.parsing-example strong {
    color: var(--accent);
}

.parsed-values-list {
    list-style: none;
    padding: 0;
    margin: 0;
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: 8px;
}

.parsed-values-list li {
    font-size: 12px;
    padding: 4px 0;
}

.config-section {
    margin-bottom: 32px;
}

.config-section h2 {
    margin-bottom: 8px;
}

/* =============================================================================
   SPLUNK DASHBOARD INTEGRATION (V11.5 - New Tab Launcher)
   ============================================================================= */

/* Sub-tabs for Revalidation view */
.reval-sub-tabs {
    display: flex;
    gap: 4px;
    margin-bottom: 20px;
    border-bottom: 1px solid var(--border);
    padding-bottom: 0;
}

.reval-sub-tab {
    padding: 10px 20px;
    background: transparent;
    border: none;
    border-bottom: 2px solid transparent;
    color: var(--text-secondary);
    cursor: pointer;
    font-size: 14px;
    font-weight: 500;
    transition: all 0.2s;
}

.reval-sub-tab:hover {
    color: var(--text);
    background: var(--bg-tertiary);
}

.reval-sub-tab.active {
    color: var(--accent);
    border-bottom-color: var(--accent);
}

.reval-tab-content {
    animation: fadeIn 0.2s ease;
}

.reval-tab-content.hidden {
    display: none;
}

/* SPLK Button (small button next to detection name) */
.btn-splunk {
    background: linear-gradient(135deg, #65a30d 0%, #84cc16 100%);
    color: #000;
    border: none;
    padding: 2px 8px;
    border-radius: 4px;
    font-size: 10px;
    font-weight: 700;
    cursor: pointer;
    margin-left: 8px;
    vertical-align: middle;
    transition: all 0.2s;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.btn-splunk:hover {
    background: linear-gradient(135deg, #84cc16 0%, #a3e635 100%);
    transform: scale(1.05);
    box-shadow: 0 2px 8px rgba(132, 204, 22, 0.4);
}

.btn-splunk.btn-sm {
    padding: 6px 12px;
    font-size: 11px;
}

.btn-xs {
    padding: 2px 8px;
    font-size: 10px;
}

/* Inline SPLK button demo in text */
.btn-splunk-inline, .btn-splunk-demo {
    display: inline-block;
    background: linear-gradient(135deg, #65a30d 0%, #84cc16 100%);
    color: #000;
    padding: 1px 6px;
    border-radius: 3px;
    font-size: 10px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

/* Splunk Launcher (V11.5) */
.splunk-launcher {
    max-width: 700px;
    margin: 0 auto;
    padding: 40px 20px;
    text-align: center;
}

.splunk-launcher-header {
    margin-bottom: 32px;
}

.splunk-launcher-header .splunk-icon {
    font-size: 48px;
    margin-bottom: 16px;
}

.splunk-launcher-header h3 {
    font-size: 24px;
    margin-bottom: 12px;
    color: var(--text);
}

.splunk-launcher-header p {
    color: var(--text-secondary);
    font-size: 14px;
    line-height: 1.6;
}

.splunk-launcher-actions {
    display: flex;
    gap: 12px;
    justify-content: center;
    margin-bottom: 40px;
}

.btn-lg {
    padding: 14px 28px;
    font-size: 16px;
}

/* Recently Opened Section */
.splunk-recent-section {
    text-align: left;
    background: var(--bg-secondary);
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 24px;
}

.splunk-recent-section h4 {
    margin-bottom: 16px;
    font-size: 14px;
    color: var(--text-secondary);
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.splunk-recent-list {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.splunk-recent-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 16px;
    background: var(--bg-tertiary);
    border-radius: 8px;
    transition: all 0.2s;
}

.splunk-recent-item:hover {
    background: var(--bg);
}

.splunk-recent-name {
    font-size: 13px;
    color: var(--text);
    flex: 1;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    margin-right: 12px;
}

.splunk-empty {
    color: var(--text-secondary);
    font-size: 13px;
    text-align: center;
    padding: 20px;
}

/* Config Info Section */
.splunk-config-info {
    text-align: left;
    background: var(--bg-secondary);
    border-radius: 12px;
    padding: 20px;
    border: 1px dashed var(--border);
}

.splunk-config-info h4 {
    margin-bottom: 12px;
    font-size: 13px;
    color: var(--text-secondary);
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.splunk-config-details {
    display: flex;
    flex-direction: column;
    gap: 8px;
    margin-bottom: 12px;
}

.splunk-config-details div {
    font-size: 12px;
    color: var(--text-secondary);
}

.splunk-config-details code {
    background: var(--bg-tertiary);
    padding: 2px 6px;
    border-radius: 4px;
    font-size: 11px;
    color: var(--accent);
}

.splunk-config-hint {
    font-size: 11px;
    color: var(--text-secondary);
    opacity: 0.7;
}

/* Light mode adjustments */
.light-mode .splunk-recent-section,
.light-mode .splunk-config-info {
    background: #f5f5f5;
}

.light-mode .splunk-recent-item {
    background: #e5e5e5;
}

.light-mode .splunk-recent-item:hover {
    background: #d5d5d5;
}

/* =============================================================================
   PASSWORD PROTECTION MODAL (V11.6)
   ============================================================================= */

.password-modal {
    z-index: 10000;
}

.password-modal .modal-overlay.no-close {
    cursor: default;
}

.password-modal-content {
    max-width: 360px;
    text-align: center;
}

.password-lock-icon {
    font-size: 48px;
    margin-bottom: 8px;
}

.password-modal .modal-header {
    flex-direction: column;
    padding: 24px 24px 12px;
}

.password-modal .modal-header h3 {
    margin: 0;
    font-size: 20px;
}

.password-prompt {
    color: var(--text-secondary);
    font-size: 14px;
    margin-bottom: 16px;
}

.password-input {
    width: 100%;
    padding: 12px 16px;
    font-size: 16px;
    text-align: center;
    letter-spacing: 2px;
    border: 2px solid var(--border);
    border-radius: 8px;
    background: var(--bg-tertiary);
    color: var(--text);
    transition: border-color 0.2s;
}

.password-input:focus {
    outline: none;
    border-color: var(--accent);
}

.password-error {
    color: #ef4444;
    font-size: 13px;
    margin-top: 12px;
    padding: 8px;
    background: rgba(239, 68, 68, 0.1);
    border-radius: 6px;
}

.password-error.hidden {
    display: none;
}

.password-modal .modal-footer {
    padding: 16px 24px 24px;
}

.password-modal .btn-primary {
    width: 100%;
    padding: 12px;
    font-size: 16px;
}

/* =============================================================================
   CORRELATION SEARCH BUTTON (V11.6)
   ============================================================================= */

.btn-correlation {
    background: linear-gradient(135deg, #059669 0%, #10b981 100%);
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 6px;
    font-size: 13px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
    display: inline-flex;
    align-items: center;
    gap: 6px;
}

.btn-correlation:hover {
    background: linear-gradient(135deg, #10b981 0%, #34d399 100%);
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
}

/* Light mode */
.light-mode .password-input {
    background: #f5f5f5;
    border-color: #e5e5e5;
}

.light-mode .password-modal-content {
    background: white;
}

/* =============================================================================
   V11.8 - COMPREHENSIVE LAYOUT IMPROVEMENTS
   ============================================================================= */

/* =============================================================================
   LIBRARY VIEW V2 - Document-focused layout
   ============================================================================= */

.library-layout-v2 {
    display: grid;
    grid-template-columns: 1fr 350px;
    height: calc(100vh - 60px);
    gap: 0;
}

.library-main {
    padding: 24px;
    overflow-y: auto;
    background: var(--bg);
}

.library-sidebar {
    background: var(--bg-secondary);
    border-left: 1px solid var(--border);
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

.library-search {
    padding: 16px;
    border-bottom: 1px solid var(--border);
}

.library-search .search-input {
    width: 100%;
}

.library-filters {
    padding: 12px 16px;
    border-bottom: 1px solid var(--border);
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.filter-row {
    display: flex;
    gap: 8px;
}

.filter-row .filter-select {
    flex: 1;
    min-width: 0;
}

.advanced-filters {
    margin-top: 4px;
}

.advanced-filters summary {
    cursor: pointer;
    color: var(--text-secondary);
    font-size: 12px;
    padding: 4px 0;
}

.advanced-filter-content {
    display: flex;
    flex-direction: column;
    gap: 8px;
    margin-top: 8px;
}

.library-list-header {
    padding: 12px 16px;
    border-bottom: 1px solid var(--border);
    font-size: 13px;
    color: var(--text-secondary);
}

.library-list {
    flex: 1;
    overflow-y: auto;
    padding: 8px;
}

/* =============================================================================
   DOCUMENT STYLE DETAIL VIEW
   ============================================================================= */

.doc-container {
    max-width: 900px;
    margin: 0 auto;
}

.doc-section {
    margin-bottom: 32px;
    padding-bottom: 24px;
    border-bottom: 1px solid var(--border);
}

.doc-section:last-child {
    border-bottom: none;
}

.doc-section-title {
    font-size: 16px;
    font-weight: 600;
    color: var(--accent);
    margin-bottom: 16px;
    display: flex;
    align-items: center;
    gap: 8px;
}

.section-count {
    font-weight: 400;
    color: var(--text-secondary);
    font-size: 14px;
}

.doc-header-section {
    text-align: center;
    padding: 24px 0;
}

.doc-severity {
    margin-bottom: 16px;
}

.doc-severity .card-severity {
    font-size: 14px;
    padding: 8px 24px;
}

.doc-metrics {
    display: flex;
    justify-content: center;
    gap: 32px;
    flex-wrap: wrap;
}

.doc-metric {
    text-align: center;
}

.metric-label {
    display: block;
    font-size: 11px;
    text-transform: uppercase;
    color: var(--text-secondary);
    margin-bottom: 4px;
}

.metric-value {
    font-size: 18px;
    font-weight: 600;
    color: var(--text);
}

/* Roles */
.doc-roles {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 16px;
}

.doc-role {
    background: var(--bg-secondary);
    padding: 16px;
    border-radius: 8px;
    text-align: center;
}

.doc-role-type {
    font-size: 11px;
    text-transform: uppercase;
    color: var(--text-secondary);
    margin-bottom: 8px;
}

.doc-role-name {
    font-weight: 600;
    color: var(--text);
}

.doc-role-title {
    font-size: 12px;
    color: var(--text-secondary);
    margin-top: 4px;
}

/* Copyable Fields */
.doc-field {
    margin-bottom: 20px;
}

.doc-field-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 8px;
}

.doc-field-label {
    font-size: 12px;
    font-weight: 600;
    text-transform: uppercase;
    color: var(--text-secondary);
    letter-spacing: 0.5px;
}

.copy-btn {
    background: var(--bg-tertiary);
    border: 1px solid var(--border);
    padding: 4px 8px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 12px;
    color: var(--text-secondary);
    transition: all 0.2s;
}

.copy-btn:hover {
    background: var(--accent);
    color: #000;
    border-color: var(--accent);
}

.copy-btn.copied {
    background: #10b981;
    color: white;
    border-color: #10b981;
}

.doc-field-value {
    color: var(--text);
    line-height: 1.6;
    font-size: 14px;
}

.doc-field-value.code-block {
    background: var(--bg-secondary);
    padding: 16px;
    border-radius: 8px;
    font-family: 'Monaco', 'Menlo', monospace;
    font-size: 12px;
    white-space: pre-wrap;
    word-break: break-word;
    overflow-x: auto;
    border: 1px solid var(--border);
}

/* Parsed Metadata */
.doc-parsed-metadata {
    background: var(--bg-secondary);
    border-radius: 8px;
    padding: 16px;
    margin-top: 16px;
}

.doc-parsed-title {
    font-size: 12px;
    font-weight: 600;
    text-transform: uppercase;
    color: var(--text-secondary);
    margin-bottom: 12px;
}

.doc-tags-grid {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.doc-tag-group {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    align-items: center;
}

.tag-group-label {
    font-size: 11px;
    color: var(--text-secondary);
    min-width: 80px;
}

.tag-group-items {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
}

/* MITRE Tags */
.doc-mitre-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
}

/* Schedule Grid */
.doc-schedule-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 16px;
}

.doc-schedule-item {
    background: var(--bg-secondary);
    padding: 12px;
    border-radius: 6px;
}

.doc-schedule-item.full-width {
    grid-column: 1 / -1;
}

.schedule-label {
    display: block;
    font-size: 11px;
    text-transform: uppercase;
    color: var(--text-secondary);
    margin-bottom: 4px;
}

.doc-schedule-item code {
    font-family: 'Monaco', 'Menlo', monospace;
    font-size: 12px;
    color: var(--accent);
}

.doc-throttle {
    margin-top: 16px;
    padding: 12px;
    background: var(--bg-secondary);
    border-radius: 6px;
    font-size: 13px;
}

.doc-inline-fields {
    display: flex;
    gap: 24px;
    flex-wrap: wrap;
}

.doc-inline-field {
    font-size: 13px;
}

.inline-label {
    color: var(--text-secondary);
}

/* Drilldowns */
.doc-drilldown {
    background: var(--bg-secondary);
    border-radius: 8px;
    padding: 16px;
    margin-bottom: 12px;
    border-left: 3px solid var(--accent);
}

.drilldown-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 12px;
}

.drilldown-name {
    font-weight: 600;
    color: var(--text);
}

.drilldown-time {
    font-size: 12px;
    color: var(--text-secondary);
}

.drilldown-search-wrap {
    position: relative;
}

.drilldown-search-wrap .copy-btn {
    position: absolute;
    top: 8px;
    right: 8px;
}

.drilldown-search {
    background: var(--bg-tertiary);
    padding: 12px;
    padding-right: 50px;
    border-radius: 6px;
    font-family: 'Monaco', 'Menlo', monospace;
    font-size: 11px;
    white-space: pre-wrap;
    word-break: break-word;
    margin: 0;
    max-height: 200px;
    overflow-y: auto;
}

.drilldown-vars {
    margin-top: 12px;
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
}

/* File Info Footer */
.doc-footer {
    opacity: 0.8;
}

.doc-file-info {
    display: flex;
    flex-wrap: wrap;
    gap: 24px;
}

.file-info-item {
    font-size: 13px;
}

.file-label {
    color: var(--text-secondary);
}

.file-info-item code {
    font-family: 'Monaco', 'Menlo', monospace;
    font-size: 11px;
    color: var(--accent);
}

/* =============================================================================
   EDITOR V2 - Better use of space
   ============================================================================= */

.editor-layout-v2 {
    display: grid;
    grid-template-columns: 1fr 280px;
    height: calc(100vh - 60px);
}

.editor-layout-v2 .editor-main {
    overflow-y: auto;
    padding: 24px;
}

.editor-layout-v2 .editor-sidebar {
    background: var(--bg-secondary);
    border-left: 1px solid var(--border);
    padding: 16px;
    overflow-y: auto;
}

.detection-form-v2 {
    max-width: 100%;
}

.detection-form-v2 .form-section {
    margin-bottom: 24px;
    padding: 20px;
    background: var(--bg-secondary);
    border-radius: 8px;
}

.detection-form-v2 .section-header {
    font-size: 14px;
    font-weight: 600;
    color: var(--accent);
    margin-bottom: 16px;
    padding-bottom: 8px;
    border-bottom: 1px solid var(--border);
}

.form-grid-2 {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 16px;
    margin-bottom: 16px;
}

.form-grid-3 {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr;
    gap: 16px;
    margin-bottom: 16px;
}

.form-grid-4 {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr 1fr;
    gap: 16px;
    margin-bottom: 16px;
}

.detection-form-v2 .form-group {
    margin-bottom: 0;
}

.detection-form-v2 .form-group.full {
    margin-bottom: 16px;
}

.roles-grid-v2 {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 16px;
}

/* =============================================================================
   HISTORY V2 - Fixed scrolling and better layout
   ============================================================================= */

.history-layout-v2 {
    display: grid;
    grid-template-columns: 1fr 380px;
    height: calc(100vh - 60px);
}

.history-main {
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

.history-main-header {
    padding: 20px 24px;
    border-bottom: 1px solid var(--border);
}

.history-main-header h3 {
    margin: 0 0 16px 0;
    color: var(--text);
}

.history-type-filters {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
}

.history-stats-bar {
    display: flex;
    gap: 24px;
    padding: 16px 24px;
    background: var(--bg-secondary);
    border-bottom: 1px solid var(--border);
}

.history-stats-bar .history-stat {
    font-size: 14px;
}

.history-timeline-v2 {
    flex: 1;
    overflow-y: auto;
    padding: 24px;
}

.history-sidebar {
    background: var(--bg-secondary);
    border-left: 1px solid var(--border);
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

.history-search {
    padding: 16px;
    border-bottom: 1px solid var(--border);
}

.history-filters {
    padding: 12px 16px;
    border-bottom: 1px solid var(--border);
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.history-filters .filter-select {
    width: 100%;
}

.history-list-header {
    padding: 12px 16px;
    border-bottom: 1px solid var(--border);
    font-size: 13px;
    color: var(--text-secondary);
}

.history-detection-list-v2 {
    flex: 1;
    overflow-y: auto;
    padding: 8px;
}

/* =============================================================================
   TTL BADGE IN REVALIDATION
   ============================================================================= */

.ttl-badge {
    display: inline-flex;
    align-items: center;
    padding: 2px 8px;
    border-radius: 4px;
    font-size: 11px;
    font-weight: 600;
}

.ttl-badge.ttl-green {
    background: rgba(34, 197, 94, 0.2);
    color: #22c55e;
}

.ttl-badge.ttl-yellow {
    background: rgba(234, 179, 8, 0.2);
    color: #eab308;
}

.ttl-badge.ttl-red {
    background: rgba(239, 68, 68, 0.2);
    color: #ef4444;
}

/* =============================================================================
   RESPONSIVE ADJUSTMENTS
   ============================================================================= */

@media (max-width: 1200px) {
    .library-layout-v2 {
        grid-template-columns: 1fr 300px;
    }
    
    .form-grid-4 {
        grid-template-columns: 1fr 1fr;
    }
    
    .history-layout-v2 {
        grid-template-columns: 1fr 320px;
    }
}

@media (max-width: 900px) {
    .library-layout-v2,
    .history-layout-v2 {
        grid-template-columns: 1fr;
    }
    
    .library-sidebar,
    .history-sidebar {
        display: none;
    }
    
    .form-grid-3,
    .form-grid-4 {
        grid-template-columns: 1fr 1fr;
    }
    
    .roles-grid-v2 {
        grid-template-columns: 1fr;
    }
}

/* =============================================================================
   V11.15 - ADDITIONAL IMPROVEMENTS
   ============================================================================= */

/* SPLUNK Button (Green) */
.btn-splunk {
    background: linear-gradient(135deg, #10b981, #059669);
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 6px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
}

.btn-splunk:hover {
    background: linear-gradient(135deg, #059669, #047857);
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
}

.btn-splunk.btn-lg {
    padding: 12px 24px;
    font-size: 16px;
}

/* Readonly Fields (greyed out) */
.readonly-field {
    background: var(--bg-tertiary) !important;
    color: var(--text-secondary) !important;
    cursor: not-allowed;
    opacity: 0.7;
}

/* File Link in Library */
.file-link {
    color: var(--accent);
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    gap: 4px;
}

.file-link:hover {
    text-decoration: underline;
}

.file-link code {
    color: var(--accent);
}

/* Revalidation Header Layout */
.reval-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 20px;
}

.reval-header-main {
    flex: 1;
}

.reval-header-main h2 {
    margin: 0 0 8px 0;
}

.reval-header-main p {
    margin: 0;
    color: var(--text-secondary);
}

/* Revalidation Search in Results Header */
.reval-results-header {
    display: flex;
    align-items: center;
    gap: 16px;
    padding: 12px 16px;
    background: var(--bg-secondary);
    border-radius: 8px;
    margin-bottom: 16px;
}

.reval-results-header .search-input {
    flex: 1;
    max-width: 300px;
}

/* Copy button fix for code blocks */
.drilldown-search-wrap {
    position: relative;
}

.drilldown-search-wrap .copy-btn {
    position: absolute;
    top: 8px;
    right: 8px;
    z-index: 10;
    background: var(--bg-tertiary);
    border: 1px solid var(--border);
    padding: 4px 8px;
    border-radius: 4px;
}

.doc-field-value.code-block {
    position: relative;
}

/* Ensure copy button is outside of code block styling */
.doc-field-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
}

.doc-field-header .copy-btn {
    flex-shrink: 0;
}

/* Reports Overview Tab uses Dashboard Grid */
#reports-overview .dashboard-grid {
    padding: 0;
}

/* Adjust stats row in reports overview */
#reports-overview .stats-row {
    margin-bottom: 20px;
}

/* =============================================================================
   V11.15 - COMPREHENSIVE UI UPDATES
   ============================================================================= */

/* Header Logo */
.logo-link {
    display: flex;
    align-items: center;
    text-decoration: none;
}

.header-logo {
    height: 40px;
    width: auto;
    object-fit: contain;
}

.boot-logo-img {
    height: 120px;
    width: auto;
    margin-bottom: 20px;
}

/* MITRE Tags Inline */
.mitre-full {
    min-height: 38px;
}

.tags-inline {
    display: flex;
    flex-wrap: wrap;
    gap: 4px;
    align-items: center;
}

.tag-input-container.mitre-full {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 8px;
}

.tag-input-container.mitre-full input {
    flex: 1;
    min-width: 120px;
}

/* Equal columns grid */
.form-grid-2.equal-cols {
    grid-template-columns: 1fr 1fr;
}

/* Button Icon Image */
.btn-icon-img {
    height: 18px;
    width: auto;
    vertical-align: middle;
    margin-right: 4px;
}

/* JSON Syntax Highlighting */
.json-syntax {
    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
    font-size: 13px;
    line-height: 1.5;
    background: var(--bg-tertiary);
    border-radius: 8px;
    padding: 16px;
    overflow: auto;
}

.json-key {
    color: #9cdcfe;
}

.json-string {
    color: #ce9178;
}

.json-number {
    color: #b5cea8;
}

.json-boolean {
    color: #569cd6;
}

.json-null {
    color: #569cd6;
}

/* By Fields Tag */
.card-tag.by-field {
    background: rgba(147, 51, 234, 0.2);
    color: #c084fc;
    border-color: rgba(147, 51, 234, 0.3);
}

/* Drilldown Parsed SPL */
.drilldown-parsed {
    margin-top: 12px;
    padding: 12px;
    background: var(--bg-tertiary);
    border-radius: 6px;
    font-size: 12px;
}

.drilldown-parsed .doc-parsed-title {
    font-size: 11px;
    margin-bottom: 8px;
}

/* Config Page Full Screen */
.config-fullscreen {
    max-width: none;
    padding: 30px;
}

.config-dev-banner {
    background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
    color: white;
    padding: 16px 24px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    gap: 12px;
    font-size: 18px;
    font-weight: 600;
    margin-bottom: 30px;
}

.dev-icon {
    font-size: 24px;
}

.config-disabled {
    opacity: 0.6;
    pointer-events: none;
}

.disabled-input {
    background: var(--bg-tertiary) !important;
    cursor: not-allowed !important;
}

.coming-soon-badge {
    background: var(--bg-tertiary);
    color: var(--text-secondary);
    font-size: 12px;
    padding: 4px 8px;
    border-radius: 4px;
    margin-left: 8px;
    font-weight: normal;
}

/* Parsing Rule Cards */
.parsing-rule-card {
    background: var(--bg-secondary);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 16px;
    margin-bottom: 16px;
}

.parsing-rule-card h4 {
    margin: 0 0 8px 0;
    color: var(--text-primary);
    display: flex;
    align-items: center;
    gap: 8px;
}

.parsing-rule-card p {
    margin: 0 0 12px 0;
    color: var(--text-secondary);
    font-size: 14px;
}

.parsing-example {
    background: var(--bg-tertiary);
    border-radius: 6px;
    padding: 12px;
    font-size: 13px;
    line-height: 1.6;
}

.parsing-example strong {
    color: var(--accent);
}

.parsing-example code {
    background: var(--bg-primary);
    padding: 2px 6px;
    border-radius: 4px;
    font-family: monospace;
    font-size: 12px;
}

.tag-preview {
    display: inline-block;
    background: var(--accent);
    color: white;
    padding: 2px 8px;
    border-radius: 4px;
    font-size: 11px;
    margin: 2px;
}

.tag-preview.variable {
    background: #f59e0b;
}

/* Library Section Borders */
.doc-section {
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 16px;
    margin-bottom: 16px;
    background: var(--bg-secondary);
}

.doc-section.doc-header-section {
    border-color: var(--accent);
    border-width: 2px;
}

.doc-section.doc-footer {
    background: var(--bg-tertiary);
}

/* Metadata Modal Larger */
#modal-metadata .modal-content {
    max-width: 900px;
    width: 90%;
    max-height: 85vh;
}

#modal-metadata .modal-footer {
    display: flex;
    gap: 12px;
    justify-content: flex-end;
}

#modal-metadata .btn-copy-json,
#modal-metadata .btn-close-modal {
    padding: 10px 24px;
    font-size: 14px;
    border-radius: 6px;
    min-width: 120px;
}

#modal-metadata .btn-close-modal {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    color: white;
    border: none;
}

#modal-metadata .btn-close-modal:hover {
    background: linear-gradient(135deg, #dc2626, #b91c1c);
}

/* Reval Actions Button Alignment */
.reval-actions {
    display: flex;
    gap: 12px;
    align-items: center;
    flex-wrap: wrap;
}

.reval-actions .btn-splunk {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 8px 16px;
}

/* Builtin Parsing Info Grid */
.builtin-parsing-info {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
    gap: 16px;
}

/* Metadata JSON content with syntax highlighting */
#metadata-json-content {
    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
    font-size: 13px;
    line-height: 1.5;
}

#metadata-json-content .json-key {
    color: #9cdcfe;
}

#metadata-json-content .json-string {
    color: #ce9178;
}

#metadata-json-content .json-number {
    color: #b5cea8;
}

#metadata-json-content .json-boolean,
#metadata-json-content .json-null {
    color: #569cd6;
}

/* =============================================================================
   V11.15 - RESOURCES TAB & LIGHT MODE FIXES
   ============================================================================= */

/* Header Splunk Icon Button */
.btn-splunk-icon {
    background: transparent;
    border: none;
    padding: 4px 8px;
    cursor: pointer;
    border-radius: 6px;
    transition: background 0.2s;
}

.btn-splunk-icon:hover {
    background: var(--bg-secondary);
}

.header-splunk-icon {
    height: 24px;
    width: 24px;
    object-fit: contain;
    vertical-align: middle;
    border-radius: 4px;
}

/* Button Icon Image - Square with rounded corners */
.btn-icon-img {
    height: 18px;
    width: 18px;
    object-fit: contain;
    vertical-align: middle;
    margin-right: 4px;
    border-radius: 3px;
}

/* Detection Name in Library Detail */
.doc-detection-name {
    margin: 0 0 12px 0;
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--text-primary);
    line-height: 1.3;
}

/* Resources Tab Styles */
.resources-container {
    padding: 24px;
    max-width: 1400px;
    margin: 0 auto;
}

.resources-header {
    margin-bottom: 24px;
}

.resources-header h2 {
    margin: 0 0 8px 0;
    font-size: 1.5rem;
}

.resources-header p {
    margin: 0;
    color: var(--text-secondary);
}

.resources-toolbar {
    display: flex;
    gap: 16px;
    align-items: center;
    flex-wrap: wrap;
    margin-bottom: 24px;
    padding: 16px;
    background: var(--bg-secondary);
    border-radius: 12px;
    border: 1px solid var(--border);
}

.resources-search {
    flex: 1;
    min-width: 200px;
}

.resources-filters {
    display: flex;
    gap: 12px;
}

.filter-select {
    padding: 8px 12px;
    border-radius: 6px;
    border: 1px solid var(--border);
    background: var(--bg-primary);
    color: var(--text-primary);
    min-width: 150px;
}

.resources-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    gap: 20px;
}

.resource-card {
    background: var(--bg-secondary);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 20px;
    transition: transform 0.2s, box-shadow 0.2s;
}

.resource-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
}

.resource-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 12px;
}

.resource-category {
    display: inline-block;
    padding: 4px 10px;
    border-radius: 20px;
    font-size: 11px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.resource-category.dashboard {
    background: rgba(16, 185, 129, 0.2);
    color: #10b981;
}

.resource-category.external-url {
    background: rgba(59, 130, 246, 0.2);
    color: #3b82f6;
}

.resource-category.internal-url {
    background: rgba(168, 85, 247, 0.2);
    color: #a855f7;
}

.resource-actions {
    display: flex;
    gap: 4px;
}

.btn-resource-edit,
.btn-resource-delete {
    background: transparent;
    border: none;
    padding: 4px 8px;
    cursor: pointer;
    border-radius: 4px;
    font-size: 14px;
    transition: background 0.2s;
}

.btn-resource-edit:hover {
    background: rgba(59, 130, 246, 0.2);
}

.btn-resource-delete:hover {
    background: rgba(239, 68, 68, 0.2);
}

.resource-name {
    margin: 0 0 8px 0;
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--text-primary);
}

.resource-description {
    margin: 0 0 12px 0;
    color: var(--text-secondary);
    font-size: 14px;
    line-height: 1.5;
}

.resource-meta {
    font-size: 12px;
    color: var(--text-muted);
    margin-bottom: 16px;
}

.resource-footer {
    padding-top: 12px;
    border-top: 1px solid var(--border);
}

.btn-open-resource {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    width: 100%;
    padding: 10px;
    background: linear-gradient(135deg, var(--accent), #4ade80);
    color: white;
    border: none;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    transition: transform 0.2s, box-shadow 0.2s;
}

.btn-open-resource:hover {
    transform: scale(1.02);
    box-shadow: 0 4px 12px rgba(80, 250, 123, 0.3);
}

.resources-empty {
    grid-column: 1 / -1;
    text-align: center;
    padding: 60px 20px;
    color: var(--text-secondary);
}

.resources-empty .empty-icon {
    font-size: 48px;
    display: block;
    margin-bottom: 16px;
}

.resources-empty p {
    margin: 0 0 8px 0;
}

.empty-hint {
    font-size: 14px;
    color: var(--text-muted);
}

/* Resource Modal */
.resource-form .form-group {
    margin-bottom: 16px;
}

.resource-form label {
    display: block;
    margin-bottom: 6px;
    font-weight: 500;
    color: var(--text-primary);
}

.resource-form input,
.resource-form textarea,
.resource-form select {
    width: 100%;
    padding: 10px 12px;
    border-radius: 6px;
    border: 1px solid var(--border);
    background: var(--bg-primary);
    color: var(--text-primary);
    font-size: 14px;
}

.resource-form textarea {
    resize: vertical;
    min-height: 80px;
}

.category-input-wrapper {
    display: flex;
    gap: 8px;
}

.category-input-wrapper select {
    flex: 1;
}

.btn-icon-small {
    padding: 8px 12px;
    background: var(--bg-tertiary);
    border: 1px solid var(--border);
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
}

.btn-icon-small:hover {
    background: var(--bg-secondary);
}

/* Light Mode JSON Syntax Colors - FIXED */
.light-mode .json-syntax,
.light-mode #metadata-json-content,
.light-mode .json-display {
    background: #f8f9fa;
}

.light-mode .json-key {
    color: #0550ae;
}

.light-mode .json-string {
    color: #0a3069;
}

.light-mode .json-number {
    color: #116329;
}

.light-mode .json-boolean,
.light-mode .json-null {
    color: #cf222e;
}

/* Light Mode - Metadata Modal JSON */
.light-mode #metadata-json-content .json-key {
    color: #0550ae;
}

.light-mode #metadata-json-content .json-string {
    color: #0a3069;
}

.light-mode #metadata-json-content .json-number {
    color: #116329;
}

.light-mode #metadata-json-content .json-boolean,
.light-mode #metadata-json-content .json-null {
    color: #cf222e;
}

/* Metadata Modal Tags */
.parsed-tags .tag {
    display: inline-block;
    padding: 2px 8px;
    margin: 2px;
    border-radius: 4px;
    font-size: 12px;
    background: var(--bg-tertiary);
    color: var(--text-primary);
}

.parsed-tags .tag.datasource {
    background: rgba(16, 185, 129, 0.2);
    color: #10b981;
}

.parsed-tags .tag.macro {
    background: rgba(244, 114, 182, 0.2);
    color: #f472b6;
}

.parsed-tags .tag.field {
    background: rgba(59, 130, 246, 0.2);
    color: #3b82f6;
}

.parsed-tags .tag.func {
    background: rgba(251, 146, 60, 0.2);
    color: #fb923c;
}

.parsed-tags .tag.by-field {
    background: rgba(147, 51, 234, 0.2);
    color: #c084fc;
}

.parsed-tags .tag.variable {
    background: rgba(245, 158, 11, 0.2);
    color: #f59e0b;
}

/* =============================================================================
   V11.15 - FIX UPDATES
   ============================================================================= */

/* Small Splunk icon for revalidation buttons */
.btn-icon-img-sm {
    height: 16px;
    width: 16px;
    object-fit: contain;
    vertical-align: middle;
    border-radius: 3px;
}

/* Extra small button for inline use */
.btn-splunk.btn-xs {
    padding: 2px 6px;
    font-size: 12px;
    vertical-align: middle;
    margin-left: 8px;
}

/* Fix detail header when title is removed */
.detail-header {
    display: flex;
    justify-content: flex-end;
    align-items: center;
    padding: 16px 24px;
    border-bottom: 1px solid var(--border);
    background: var(--bg-secondary);
}

/* =============================================================================
   V11.15 - RESOURCES LIST & RISK DISPLAY
   ============================================================================= */

/* Resources List (like Revalidation) */
.resources-list {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.resource-list-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 16px 20px;
    background: var(--bg-secondary);
    border: 1px solid var(--border);
    border-radius: 8px;
    transition: border-color 0.2s;
}

.resource-list-item:hover {
    border-color: var(--accent);
}

.resource-list-info {
    flex: 1;
    min-width: 0;
}

.resource-list-info h4 {
    margin: 0 0 8px 0;
    font-size: 1rem;
    font-weight: 600;
    color: var(--text-primary);
}

.resource-list-badges {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
    margin-bottom: 8px;
}

.resource-category-badge {
    display: inline-block;
    padding: 3px 10px;
    border-radius: 12px;
    font-size: 11px;
    font-weight: 600;
    text-transform: uppercase;
}

.resource-category-badge.dashboard {
    background: rgba(16, 185, 129, 0.2);
    color: #10b981;
}

.resource-category-badge.external-url {
    background: rgba(59, 130, 246, 0.2);
    color: #3b82f6;
}

.resource-category-badge.internal-url {
    background: rgba(168, 85, 247, 0.2);
    color: #a855f7;
}

.resource-added-badge {
    font-size: 12px;
    color: var(--text-muted);
}

.resource-list-description {
    margin: 0;
    font-size: 13px;
    color: var(--text-secondary);
    line-height: 1.4;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    max-width: 600px;
}

.resource-list-actions {
    display: flex;
    gap: 8px;
    margin-left: 16px;
    flex-shrink: 0;
}

.results-count {
    font-size: 13px;
    color: var(--text-secondary);
    padding: 8px 12px;
    background: var(--bg-tertiary);
    border-radius: 6px;
}

/* Macros Tab */
.macros-container {
    padding: 24px;
    max-width: 1200px;
    margin: 0 auto;
}

.macros-header {
    margin-bottom: 24px;
}

.macros-header h2 {
    margin: 0 0 8px 0;
    font-size: 1.5rem;
}

.macros-header p {
    margin: 0;
    color: var(--text-secondary);
}

.macros-toolbar {
    display: flex;
    gap: 16px;
    align-items: center;
    margin-bottom: 24px;
    flex-wrap: wrap;
}

.macros-search {
    flex: 1;
    min-width: 200px;
}

.macros-list {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.macros-grid-items {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 12px;
}

.macro-list-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 16px;
    background: var(--bg-secondary);
    border: 1px solid var(--border);
    border-radius: 8px;
    transition: border-color 0.2s;
}

.macro-list-item:hover {
    border-color: var(--accent);
}

.macro-name {
    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
    font-size: 14px;
    color: var(--accent);
}

.btn-delete-macro {
    opacity: 0.6;
    transition: opacity 0.2s;
}

.btn-delete-macro:hover {
    opacity: 1;
}

/* Edit Button (blue) */
.btn-edit {
    background: linear-gradient(135deg, #3b82f6, #2563eb);
    color: white;
    border: none;
}

.btn-edit:hover {
    background: linear-gradient(135deg, #2563eb, #1d4ed8);
}

/* Risk Display in Library Detail */
.doc-risk-entries {
    margin-top: 16px;
    padding: 12px;
    background: var(--bg-tertiary);
    border-radius: 8px;
}

.doc-risk-header {
    font-size: 12px;
    font-weight: 600;
    text-transform: uppercase;
    color: var(--text-muted);
    margin-bottom: 10px;
}

.doc-risk-entry {
    display: flex;
    gap: 16px;
    padding: 8px 0;
    border-bottom: 1px solid var(--border);
}

.doc-risk-entry:last-child {
    border-bottom: none;
}

.doc-risk-entry span {
    font-size: 13px;
}

.doc-risk-entry code {
    background: var(--bg-secondary);
    padding: 2px 6px;
    border-radius: 4px;
    font-size: 12px;
}

.doc-risk-entry .risk-score strong {
    color: var(--accent);
}

/* =============================================================================
   V11.15 - DATA SOURCES AUTO-POPULATE & PROPOSED TEST PLAN
   ============================================================================= */

/* Disabled tag input container */
.tag-input-container.disabled {
    background: var(--bg-tertiary);
    opacity: 0.85;
}

.tag-input-container.disabled input {
    background: transparent;
    cursor: not-allowed;
}

/* Auto-populated tags (no remove button) */
.tag.auto-tag {
    padding-right: 10px;
}

/* Field hint text */
.field-hint {
    display: block;
    margin-top: 4px;
    font-size: 11px;
    color: var(--text-muted);
    font-style: italic;
}

/* Code-style textarea for test plan */
.code-textarea {
    font-family: 'Consolas', 'Monaco', 'Lucida Console', monospace;
    font-size: 13px;
    line-height: 1.5;
    background: var(--bg-tertiary);
    border: 1px solid var(--border);
    border-radius: 6px;
    padding: 12px;
    resize: vertical;
}

.code-textarea:focus {
    border-color: var(--accent);
    outline: none;
}

/* =============================================================================
   V11.15 - COLLAPSIBLE SECTIONS, UC HEALTH DASHBOARD, DETECTION LINKS
   ============================================================================= */

/* Collapsible form sections */
.section-header.collapsible {
    cursor: pointer;
    user-select: none;
    display: flex;
    align-items: center;
    gap: 8px;
}

.section-header.collapsible:hover {
    color: var(--accent);
}

.collapse-icon {
    font-size: 10px;
    transition: transform 0.2s ease;
    width: 12px;
    text-align: center;
}

.form-section.collapsed .section-content {
    display: none;
}

.form-section .section-content {
    display: block;
}

/* Splunk label (green text) */
.splunk-label {
    color: #65a637;
    font-weight: 500;
    font-size: 0.9em;
}

/* UC Health Dashboard button */
.btn-health {
    background: linear-gradient(135deg, #10b981, #059669);
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 6px;
    font-size: 13px;
    font-weight: 500;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    gap: 6px;
    transition: all 0.2s ease;
}

.btn-health:hover {
    background: linear-gradient(135deg, #059669, #047857);
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);
}

/* Detection name links in Revalidation */
.detection-link {
    color: var(--text);
    text-decoration: none;
    transition: color 0.2s ease;
}

.detection-link:hover {
    color: var(--accent);
    text-decoration: underline;
}

.reval-result-card h4 .detection-link {
    font-weight: 600;
}

/* =============================================================================
   V11.15 - COLLAPSIBLE SECTIONS & UI IMPROVEMENTS
   ============================================================================= */

/* Collapsible Section Headers */
.section-header.collapsible {
    cursor: pointer;
    user-select: none;
    display: flex;
    align-items: center;
    gap: 8px;
}

.section-header.collapsible:hover {
    color: var(--accent);
}

.collapse-icon {
    font-size: 10px;
    transition: transform 0.2s ease;
    color: var(--text-muted);
}

.form-section.collapsed .section-content {
    display: none;
}

/* Splunk label in section headers */
.splunk-label {
    color: #10b981;
    font-weight: 500;
    font-size: 12px;
}

/* Detection link in revalidation results */
.detection-link {
    color: var(--accent);
    text-decoration: none;
    transition: color 0.2s;
}

.detection-link:hover {
    color: var(--accent-hover);
    text-decoration: underline;
}

/* UC Health Dashboard button */
.btn-health {
    background: linear-gradient(135deg, #10b981, #059669);
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 6px;
    cursor: pointer;
    font-weight: 500;
    display: inline-flex;
    align-items: center;
    gap: 6px;
    transition: all 0.2s;
}

.btn-health:hover {
    background: linear-gradient(135deg, #059669, #047857);
    transform: translateY(-1px);
}
