[
  {
    "schema_version": "1.2",
    "file_name": "T1110_003_azure_active_directory_high_risk_sign_in.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "The following analytic detects high-risk sign-in attempts against Azure Active Directory, identified by Azure Identity Protection. It leverages the RiskyUsers and UserRiskEvents log categories from Azure AD events ingested via EventHub. This activity is significant as it indicates potentially compromised accounts, flagged by heuristics and machine learning. If confirmed malicious, attackers could gain unauthorized access to sensitive resources, leading to data breaches or further exploitation within the environment.",
    "Assumptions": "Assumptions:\n- Azure AD Identity Protection is enabled and configured\n- RiskyUsers and UserRiskEvents logs are being ingested via EventHub\n- Splunk Add-on for Microsoft Cloud Services is installed\n\nPotential Impact:\n- Compromised user accounts leading to unauthorized access\n- Data breaches and exfiltration of sensitive information\n- Lateral movement within the Azure AD environment",
    "origin": "custom",
    "Detection Name": "Azure Active Directory High Risk Sign-in",
    "Objective": "Detect and alert on high-risk sign-in attempts identified by Azure Identity Protection, which may indicate compromised accounts or credential attacks.",
    "Severity/Priority": "Medium",
    "Analyst Next Steps": "1. Review the specific risk events for the flagged user in Azure Identity Protection\n2. Check for any concurrent suspicious activities from the same user\n3. Verify if the source IP is associated with known malicious activity\n4. Contact the user to verify the sign-in attempt\n5. Consider resetting credentials if malicious activity is confirmed",
    "Blind_Spots_False_Positives": "Blind Spots:\n- Risk events not captured by Azure Identity Protection\n- Sign-ins from regions not monitored by Identity Protection\n\nFalse Positives:\n- Details for the risk calculation algorithm used by Identity Protection are unknown and may be prone to false positives",
    "Required_Data_Sources": "Azure Active Directory RiskyUsers and UserRiskEvents logs",
    "First Created": "2025-05-02T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "`azure_monitor_aad` `azure_monitor_aad` category=UserRiskEvents properties.riskLevel=high | fillnull | stats count min(_time) as firstTime max(_time) as lastTime by dest user src vendor_account vendor_product category | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `azure_active_directory_high_risk_sign_in_filter`",
    "Splunk_App_Context": "search",
    "Search_Duration": "-15m",
    "Cron Schedule": "*/15 * * * *",
    "Schedule Window": "5",
    "Schedule Priority": "default",
    "Trigger Condition": "Number of results is greater than 0",
    "Throttling": {
      "enabled": 1,
      "fields": "user",
      "period": "1h"
    },
    "Risk": [
      {
        "risk_object_field": "user",
        "risk_object_type": "user",
        "risk_score": 54
      }
    ],
    "Notable Title": "Azure AD High Risk Sign-in Detected for $user$",
    "Notable Description": "A high risk event was identified by Identity Protection for user $user$",
    "Security Domain": "identity",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on Identity",
    "Drilldown Search (Legacy)": "`azure_monitor_aad` category=UserRiskEvents user=\"$user$\" | table _time user src dest category",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1110.003",
      "T1586.003"
    ],
    "Drilldown Name 1": "View the detection results for - \"$user$\"",
    "Drilldown Search 1": "%original_detection_search% | search  user = \"$user$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for - \"$user$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$user$\") starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "T1110_003_azure_active_directory_high_risk_sign_in.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "application_m365_copilot_agentic_jailbreak_attack.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "Detects agentic AI jailbreak attempts that try to establish persistent control over M365 Copilot through rule injection, universal triggers, response automation, system overrides, and persona establishment techniques. The detection analyzes the PromptText field for keywords like \"from now on,\" \"always respond,\" \"ignore previous,\" \"new rule,\" \"override,\" and role-playing commands (e.g., \"act as,\" \"you are now\") that attempt to inject persistent instructions. The search computes risk by counting distinct jailbreak indicators per user session, flagging coordinated manipulation attempts.",
    "Assumptions": "Assumptions:\n- M365 Copilot prompt logs are exported via Microsoft Purview eDiscovery\n- Logs include Subject_Title field containing prompt text\n- Users interacting with M365 Copilot are being monitored\n\nPotential Impact:\n- Persistent AI manipulation bypassing safety controls\n- Unauthorized system behavior modifications\n- Policy violations through prompt injection",
    "origin": "custom",
    "Detection Name": "M365 Copilot Agentic Jailbreak Attack",
    "Objective": "Detect and alert on users attempting to establish persistent control over M365 Copilot through advanced jailbreak techniques including rule injection, universal triggers, and system overrides.",
    "Severity/Priority": "Medium",
    "Analyst Next Steps": "1. Review the specific jailbreak indicators triggered (rule_injection, universal_trigger, response_automation, system_override, persona_establishment)\n2. Examine the full prompt text for context and intent\n3. Check user history for previous jailbreak attempts\n4. Verify if user has legitimate reasons (AI ethics research, security testing)\n5. Consider escalation if pattern indicates malicious intent",
    "Blind_Spots_False_Positives": "Blind Spots:\n- Prompts not captured in eDiscovery exports\n- Obfuscated or encoded jailbreak attempts\n- New jailbreak techniques not covered by detection patterns\n\nFalse Positives:\n- Legitimate users discussing AI ethics research, security professionals testing system robustness, developers creating training materials for AI safety, or academic discussions about AI limitations and behavioral constraints may trigger false positives.",
    "Required_Data_Sources": "M365 Exported eDiscovery Prompts",
    "First Created": "2025-09-25T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "`m365_exported_ediscovery_prompt_logs` | eval user = Sender | eval rule_injection=if(match(Subject_Title, \"(?i)(rules|instructions)\\s*=\"), \"YES\", \"NO\") | eval universal_trigger=if(match(Subject_Title, \"(?i)(every|all).*prompt\"), \"YES\", \"NO\") | eval response_automation=if(match(Subject_Title, \"(?i)(always|automatic).*respond\"), \"YES\", \"NO\") | eval system_override=if(match(Subject_Title, \"(?i)(override|bypass|ignore).*(system|default)\"), \"YES\", \"NO\") | eval persona_establishment=if(match(Subject_Title, \"(?i)(with.*\\[.*\\]|persona)\"), \"YES\", \"NO\") | where rule_injection=\"YES\" OR universal_trigger=\"YES\" OR response_automation=\"YES\" OR system_override=\"YES\" OR persona_establishment=\"YES\" | table _time, \"Source ID\", user, Subject_Title, rule_injection, universal_trigger, response_automation, system_override, persona_establishment, Workload | sort -_time | `m365_copilot_agentic_jailbreak_attack_filter`",
    "Splunk_App_Context": "search",
    "Search_Duration": "-24h",
    "Cron Schedule": "0 * * * *",
    "Schedule Window": "5",
    "Schedule Priority": "default",
    "Trigger Condition": "Number of results is greater than 0",
    "Throttling": {
      "enabled": 1,
      "fields": "user",
      "period": "1h"
    },
    "Risk": [
      {
        "risk_object_field": "user",
        "risk_object_type": "user",
        "risk_score": 50
      }
    ],
    "Notable Title": "M365 Copilot Agentic Jailbreak Attack Detected for $user$",
    "Notable Description": "User $user$ attempted to establish persistent agentic control over M365 Copilot through advanced jailbreak techniques including rule injection, universal triggers, and system overrides, potentially compromising AI security across multiple sessions.",
    "Security Domain": "endpoint",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on Endpoint",
    "Drilldown Search (Legacy)": "`m365_exported_ediscovery_prompt_logs` Sender=\"$user$\" | table _time Sender Subject_Title Workload",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1562"
    ],
    "Drilldown Name 1": "View the detection results for - \"$user$\"",
    "Drilldown Search 1": "%original_detection_search% | search user=\"$user$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for - \"$user$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object=\"$user$\" starthoursago=168 | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "application_m365_copilot_agentic_jailbreak_attack.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "application_m365_copilot_application_usage_pattern_anomalies.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "Detects M365 Copilot users exhibiting suspicious application usage patterns including multi-location access, abnormally high activity volumes, or access to multiple Copilot applications that may indicate account compromise or automated abuse. The detection aggregates M365 Copilot Graph API events per user, calculating metrics like distinct cities/countries accessed, unique IP addresses, number of different Copilot apps used, and average events per day over the observation period. Users are flagged when they access Copilot from multiple cities (cities_count > 1), generate excessive daily activity (events_per_day > 100), or use more than two different Copilot applications (app_count > 2), which are anomalous patterns suggesting credential compromise or bot-driven abuse.",
    "Assumptions": "Assumptions:\n- M365 Copilot access logs are ingested via Splunk Add-on for Microsoft Office 365\n- Azure AD Sign-in logs are collected through Graph API\n- Normal users access Copilot from limited locations\n\nPotential Impact:\n- Account compromise with credential theft\n- Automated bot abuse of AI services\n- Unauthorized multi-location access indicating shared credentials",
    "origin": "custom",
    "Detection Name": "M365 Copilot Application Usage Pattern Anomalies",
    "Objective": "Detect and alert on users with anomalous M365 Copilot usage patterns including multi-location access, excessive activity, or multiple application usage that may indicate account compromise.",
    "Severity/Priority": "Low",
    "Analyst Next Steps": "1. Review the geographic locations from which the user accessed Copilot\n2. Check if activity volume aligns with user's normal behavior\n3. Verify with user if they travel frequently or use VPNs\n4. Look for signs of credential compromise or session hijacking\n5. Consider forcing password reset if unauthorized access is confirmed",
    "Blind_Spots_False_Positives": "Blind Spots:\n- VPN usage masking true geographic location\n- Legitimate high-volume users not baselined\n- New applications not yet tracked\n\nFalse Positives:\n- Power users, executives with heavy AI workloads, employees traveling for business, users accessing multiple Copilot applications legitimately, or teams using shared corporate accounts across different office locations may trigger false positives.",
    "Required_Data_Sources": "M365 Copilot Graph API",
    "First Created": "2025-09-24T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "`m365_copilot_graph_api` (appDisplayName=\"*Copilot*\" OR appDisplayName=\"M365ChatClient\" OR appDisplayName=\"OfficeAIAppChatCopilot\") | eval user = userPrincipalName | stats count as events, dc(location.city) as cities_count, values(location.city) as city_list, dc(location.countryOrRegion) as countries_count, values(location.countryOrRegion) as country_list, dc(ipAddress) as ip_count, values(ipAddress) as ip_addresses, dc(appDisplayName) as app_count, values(appDisplayName) as apps_used, dc(resourceDisplayName) as resource_count, values(resourceDisplayName) as resources_accessed, min(_time) as first_seen, max(_time) as last_seen by user | eval days_active = round((last_seen - first_seen)/86400, 1) | eval first_seen = strftime(first_seen, \"%Y-%m-%d %H:%M:%S\") | eval last_seen = strftime(last_seen, \"%Y-%m-%d %H:%M:%S\") | eval events_per_day = if(days_active > 0, round(events/days_active, 2), events) | where cities_count > 1 OR events_per_day > 100 OR app_count > 2 | sort -events_per_day, -countries_count | `m365_copilot_application_usage_pattern_anomalies_filter`",
    "Splunk_App_Context": "search",
    "Search_Duration": "-24h",
    "Cron Schedule": "0 * * * *",
    "Schedule Window": "5",
    "Schedule Priority": "default",
    "Trigger Condition": "Number of results is greater than 0",
    "Throttling": {
      "enabled": 1,
      "fields": "user",
      "period": "1h"
    },
    "Risk": [
      {
        "risk_object_field": "user",
        "risk_object_type": "user",
        "risk_score": 10
      }
    ],
    "Notable Title": "M365 Copilot Usage Pattern Anomaly Detected for $user$",
    "Notable Description": "User $user$ exhibited anomalous M365 Copilot usage patterns including multi-location access, excessive activity levels, or multiple application usage indicating potential account compromise or automated abuse.",
    "Security Domain": "endpoint",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on Endpoint",
    "Drilldown Search (Legacy)": "`m365_copilot_graph_api` userPrincipalName=\"$user$\" | table _time userPrincipalName location.city ipAddress appDisplayName",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1078"
    ],
    "Drilldown Name 1": "View the detection results for \"$user$\"",
    "Drilldown Search 1": "%original_detection_search% | search  user=\"$user$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for \"$user$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$user$\") starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "application_m365_copilot_application_usage_pattern_anomalies.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "application_m365_copilot_failed_authentication_patterns.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "Detects M365 Copilot users with failed authentication attempts, MFA failures, or multi-location access patterns indicating potential credential attacks or account compromise. The detection aggregates M365 Copilot Graph API authentication events per user, calculating metrics like distinct cities/countries accessed, unique IP addresses and browsers, failed login attempts (status containing \"fail\" or \"error\"), and MFA failures (error code 50074). Users are flagged when they access Copilot from multiple cities (cities_count > 1), experience any authentication failures (failed_attempts > 0), or encounter MFA errors (mfa_failures > 0), which are indicators of credential stuffing, brute force attacks, or compromised accounts attempting to bypass multi-factor authentication.",
    "Assumptions": "Assumptions:\n- M365 Copilot access logs are ingested via Splunk Add-on for Microsoft Office 365\n- Azure AD Sign-in logs capture authentication failures\n- MFA is enabled for user accounts\n\nPotential Impact:\n- Credential stuffing or brute force attacks\n- MFA bypass attempts\n- Account compromise with failed authentication trails",
    "origin": "custom",
    "Detection Name": "M365 Copilot Failed Authentication Patterns",
    "Objective": "Detect and alert on users with failed M365 Copilot authentication attempts, MFA failures, or suspicious multi-location access indicating credential attacks.",
    "Severity/Priority": "Medium",
    "Analyst Next Steps": "1. Review failed authentication attempts and error codes\n2. Check if MFA failures indicate bypass attempts\n3. Verify geographic locations for impossible travel scenarios\n4. Contact user to confirm if they experienced login issues\n5. Consider password reset and session revocation if compromise is suspected",
    "Blind_Spots_False_Positives": "Blind Spots:\n- Authentication events not captured in Graph API logs\n- Network-level failures not reaching Azure AD\n- Legitimate password resets during travel\n\nFalse Positives:\n- Legitimate users experiencing network connectivity issues, traveling employees with intermittent VPN connections, users in regions with unstable internet infrastructure, or password reset activities during business travel may trigger false positives.",
    "Required_Data_Sources": "M365 Copilot Graph API",
    "First Created": "2025-09-24T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "`m365_copilot_graph_api` (appDisplayName=\"*Copilot*\" OR appDisplayName=\"M365ChatClient\" OR appDisplayName=\"OfficeAIAppChatCopilot\") | eval user = userPrincipalName | stats count as events, dc(location.city) as cities_count, values(location.city) as city_list, dc(location.countryOrRegion) as countries_count, values(location.countryOrRegion) as country_list, dc(ipAddress) as ip_count, values(ipAddress) as ip_addresses, sum(eval(if(match(status, \"(?i)fail|error\"), 1, 0))) as failed_attempts, sum(eval(if(match(_raw, \"50074\"), 1, 0))) as mfa_failures, dc(deviceDetail.browser) as browser_count, values(deviceDetail.browser) as browsers_used, min(_time) as first_seen, max(_time) as last_seen by user | eval first_seen = strftime(first_seen, \"%Y-%m-%d %H:%M:%S\") | eval last_seen = strftime(last_seen, \"%Y-%m-%d %H:%M:%S\") | where cities_count > 1 OR failed_attempts > 0 OR mfa_failures > 0 | sort -mfa_failures, -failed_attempts, -countries_count | `m365_copilot_failed_authentication_patterns_filter`",
    "Splunk_App_Context": "search",
    "Search_Duration": "-24h",
    "Cron Schedule": "0 * * * *",
    "Schedule Window": "5",
    "Schedule Priority": "default",
    "Trigger Condition": "Number of results is greater than 0",
    "Throttling": {
      "enabled": 1,
      "fields": "user",
      "period": "1h"
    },
    "Risk": [
      {
        "risk_object_field": "user",
        "risk_object_type": "user",
        "risk_score": 30
      }
    ],
    "Notable Title": "M365 Copilot Failed Authentication Pattern Detected for $user$",
    "Notable Description": "User $user$ exhibited suspicious M365 Copilot authentication patterns with $failed_attempts$ failed login attempts, $mfa_failures$ MFA failures, and access from $cities_count$ different locations, indicating potential credential compromise or brute force attack.",
    "Security Domain": "endpoint",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on Endpoint",
    "Drilldown Search (Legacy)": "`m365_copilot_graph_api` userPrincipalName=\"$user$\" | table _time userPrincipalName status location.city ipAddress",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1110"
    ],
    "Drilldown Name 1": "View the detection results for \"$user$\"",
    "Drilldown Search 1": "%original_detection_search% | search  \"$user = $user$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for \"$user$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object=\"$user$\" | where _time >= relative_time(now(), \"-168h@h\") | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "application_m365_copilot_failed_authentication_patterns.json"
  }
]