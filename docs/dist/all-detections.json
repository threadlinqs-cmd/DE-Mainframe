[
  {
    "schema_version": "1.2",
    "file_name": "T1110_003_azure_active_directory_high_risk_sign_in.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "The following analytic detects high-risk sign-in attempts against Azure Active Directory, identified by Azure Identity Protection. It leverages the RiskyUsers and UserRiskEvents log categories from Azure AD events ingested via EventHub. This activity is significant as it indicates potentially compromised accounts, flagged by heuristics and machine learning. If confirmed malicious, attackers could gain unauthorized access to sensitive resources, leading to data breaches or further exploitation within the environment.",
    "Assumptions": "Assumptions:\n- Azure AD Identity Protection is enabled and configured\n- RiskyUsers and UserRiskEvents logs are being ingested via EventHub\n- Splunk Add-on for Microsoft Cloud Services is installed\n\nPotential Impact:\n- Compromised user accounts leading to unauthorized access\n- Data breaches and exfiltration of sensitive information\n- Lateral movement within the Azure AD environment",
    "origin": "custom",
    "Detection Name": "Azure Active Directory High Risk Sign-in",
    "Objective": "Detect and alert on high-risk sign-in attempts identified by Azure Identity Protection, which may indicate compromised accounts or credential attacks.",
    "Severity/Priority": "Medium",
    "Analyst Next Steps": "1. Review the specific risk events for the flagged user in Azure Identity Protection\n2. Check for any concurrent suspicious activities from the same user\n3. Verify if the source IP is associated with known malicious activity\n4. Contact the user to verify the sign-in attempt\n5. Consider resetting credentials if malicious activity is confirmed",
    "Blind_Spots_False_Positives": "Blind Spots:\n- Risk events not captured by Azure Identity Protection\n- Sign-ins from regions not monitored by Identity Protection\n\nFalse Positives:\n- Details for the risk calculation algorithm used by Identity Protection are unknown and may be prone to false positives",
    "Required_Data_Sources": "Azure Active Directory RiskyUsers and UserRiskEvents logs",
    "First Created": "2025-05-02T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "`azure_monitor_aad` `azure_monitor_aad` category=UserRiskEvents properties.riskLevel=high | fillnull | stats count min(_time) as firstTime max(_time) as lastTime by dest user src vendor_account vendor_product category | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `azure_active_directory_high_risk_sign_in_filter`",
    "Splunk_App_Context": "search",
    "Search_Duration": "-15m",
    "Cron Schedule": "*/15 * * * *",
    "Schedule Window": "5",
    "Schedule Priority": "default",
    "Trigger Condition": "Number of results is greater than 0",
    "Throttling": {
      "enabled": 1,
      "fields": "user",
      "period": "1h"
    },
    "Risk": [
      {
        "risk_object_field": "user",
        "risk_object_type": "user",
        "risk_score": 54
      }
    ],
    "Notable Title": "Azure AD High Risk Sign-in Detected for $user$",
    "Notable Description": "A high risk event was identified by Identity Protection for user $user$",
    "Security Domain": "identity",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on Identity",
    "Drilldown Search (Legacy)": "`azure_monitor_aad` category=UserRiskEvents user=\"$user$\" | table _time user src dest category",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1110.003",
      "T1586.003"
    ],
    "Drilldown Name 1": "View the detection results for - \"$user$\"",
    "Drilldown Search 1": "%original_detection_search% | search  user = \"$user$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for - \"$user$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$user$\") starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "T1110_003_azure_active_directory_high_risk_sign_in.json"
  }
]