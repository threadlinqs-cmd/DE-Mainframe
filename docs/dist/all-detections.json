[
  {
    "schema_version": "1.2",
    "file_name": "identity_Azure_Active_Directory_High_Risk_Sign-in.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "The following analytic detects high-risk sign-in attempts against Azure Active Directory, identified by Azure Identity Protection. It leverages the RiskyUsers and UserRiskEvents log categories from Azure AD events ingested via EventHub. This activity is significant as it indicates potentially compromised accounts, flagged by heuristics and machine learning. If confirmed malicious, attackers could gain unauthorized access to sensitive resources, leading to data breaches or further exploitation within the environment.",
    "Assumptions": "Assumptions:\n- Azure AD Identity Protection is enabled and configured\n- RiskyUsers and UserRiskEvents logs are being ingested via EventHub\n- Splunk Add-on for Microsoft Cloud Services is installed\n\nPotential Impact:\n- Compromised user accounts leading to unauthorized access\n- Data breaches and exfiltration of sensitive information\n- Lateral movement within the Azure AD environment",
    "origin": "custom",
    "Detection Name": "Azure Active Directory High Risk Sign-in",
    "Objective": "Detect and alert on high-risk sign-in attempts identified by Azure Identity Protection, which may indicate compromised accounts or credential attacks.",
    "Severity/Priority": "medium",
    "Analyst Next Steps": "1. Review the specific risk events for the flagged user in Azure Identity Protection\n2. Check for any concurrent suspicious activities from the same user\n3. Verify if the source IP is associated with known malicious activity\n4. Contact the user to verify the sign-in attempt\n5. Consider resetting credentials if malicious activity is confirmed",
    "Blind_Spots_False_Positives": "Blind Spots:\n- Risk events not captured by Azure Identity Protection\n- Sign-ins from regions not monitored by Identity Protection\n\nFalse Positives:\n- Details for the risk calculation algorithm used by Identity Protection are unknown and may be prone to false positives",
    "Required_Data_Sources": "Azure Active Directory RiskyUsers and UserRiskEvents logs",
    "First Created": "2025-05-02T00:00:00.000Z",
    "Last Modified": "2026-01-26T16:38:22.161Z",
    "Search String": "`azure_monitor_aad` `azure_monitor_aad` category=UserRiskEvents properties.riskLevel=high | fillnull | stats count min(_time) as firstTime max(_time) as lastTime by dest user src vendor_account vendor_product category | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `azure_active_directory_high_risk_sign_in_filter`",
    "Splunk_App_Context": "",
    "Search_Duration": "",
    "Cron Schedule": "*/15 * * * *",
    "Schedule Window": "5",
    "Schedule Priority": "",
    "Trigger Condition": "Number of results is greater than 0",
    "Throttling": {
      "enabled": 1,
      "fields": "user",
      "period": "1h"
    },
    "Risk": [
      {
        "risk_object_field": "user",
        "risk_object_type": "user",
        "risk_score": 54
      }
    ],
    "Notable Title": "Azure AD High Risk Sign-in Detected for $user$",
    "Notable Description": "A high risk event was identified by Identity Protection for user $user$",
    "Security Domain": "identity",
    "Drilldown Name (Legacy)": "",
    "Drilldown Search (Legacy)": "",
    "Drilldown Earliest Offset (Legacy)": null,
    "Drilldown Latest Offset (Legacy)": null,
    "Mitre ID": [
      "T1110.003",
      "T1586.003"
    ],
    "Proposed Test Plan": "",
    "Drilldown Name 1": "View Events Associated to this Notable on Identity",
    "Drilldown Search 1": "`azure_monitor_aad` category=UserRiskEvents user=\"$user$\" | table _time user src dest category",
    "Drilldown Earliest 1": "2592000",
    "Drilldown Latest 1": "86400",
    "Drilldown Name 2": "View the detection results for - \\",
    "Drilldown Search 2": "%original_detection_search% | search  user = \"$user$\"",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "View risk events for the last 7 days for - \\",
    "Drilldown Search 3": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$user$\") starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 3": "$info_min_time$",
    "Drilldown Latest 3": "$info_max_time$",
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "_sourceFile": "identity_Azure_Active_Directory_High_Risk_Sign-in.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "application_m365_copilot_agentic_jailbreak_attack.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "Detects agentic AI jailbreak attempts that try to establish persistent control over M365 Copilot through rule injection, universal triggers, response automation, system overrides, and persona establishment techniques. The detection analyzes the PromptText field for keywords like \"from now on,\" \"always respond,\" \"ignore previous,\" \"new rule,\" \"override,\" and role-playing commands (e.g., \"act as,\" \"you are now\") that attempt to inject persistent instructions. The search computes risk by counting distinct jailbreak indicators per user session, flagging coordinated manipulation attempts.",
    "Assumptions": "Assumptions:\n- M365 Copilot prompt logs are exported via Microsoft Purview eDiscovery\n- Logs include Subject_Title field containing prompt text\n- Users interacting with M365 Copilot are being monitored\n\nPotential Impact:\n- Persistent AI manipulation bypassing safety controls\n- Unauthorized system behavior modifications\n- Policy violations through prompt injection",
    "origin": "custom",
    "Detection Name": "M365 Copilot Agentic Jailbreak Attack",
    "Objective": "Detect and alert on users attempting to establish persistent control over M365 Copilot through advanced jailbreak techniques including rule injection, universal triggers, and system overrides.",
    "Severity/Priority": "Medium",
    "Analyst Next Steps": "1. Review the specific jailbreak indicators triggered (rule_injection, universal_trigger, response_automation, system_override, persona_establishment)\n2. Examine the full prompt text for context and intent\n3. Check user history for previous jailbreak attempts\n4. Verify if user has legitimate reasons (AI ethics research, security testing)\n5. Consider escalation if pattern indicates malicious intent",
    "Blind_Spots_False_Positives": "Blind Spots:\n- Prompts not captured in eDiscovery exports\n- Obfuscated or encoded jailbreak attempts\n- New jailbreak techniques not covered by detection patterns\n\nFalse Positives:\n- Legitimate users discussing AI ethics research, security professionals testing system robustness, developers creating training materials for AI safety, or academic discussions about AI limitations and behavioral constraints may trigger false positives.",
    "Required_Data_Sources": "M365 Exported eDiscovery Prompts",
    "First Created": "2025-09-25T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "`m365_exported_ediscovery_prompt_logs` | eval user = Sender | eval rule_injection=if(match(Subject_Title, \"(?i)(rules|instructions)\\s*=\"), \"YES\", \"NO\") | eval universal_trigger=if(match(Subject_Title, \"(?i)(every|all).*prompt\"), \"YES\", \"NO\") | eval response_automation=if(match(Subject_Title, \"(?i)(always|automatic).*respond\"), \"YES\", \"NO\") | eval system_override=if(match(Subject_Title, \"(?i)(override|bypass|ignore).*(system|default)\"), \"YES\", \"NO\") | eval persona_establishment=if(match(Subject_Title, \"(?i)(with.*\\[.*\\]|persona)\"), \"YES\", \"NO\") | where rule_injection=\"YES\" OR universal_trigger=\"YES\" OR response_automation=\"YES\" OR system_override=\"YES\" OR persona_establishment=\"YES\" | table _time, \"Source ID\", user, Subject_Title, rule_injection, universal_trigger, response_automation, system_override, persona_establishment, Workload | sort -_time | `m365_copilot_agentic_jailbreak_attack_filter`",
    "Splunk_App_Context": "search",
    "Search_Duration": "-24h",
    "Cron Schedule": "0 * * * *",
    "Schedule Window": "5",
    "Schedule Priority": "default",
    "Trigger Condition": "Number of results is greater than 0",
    "Throttling": {
      "enabled": 1,
      "fields": "user",
      "period": "1h"
    },
    "Risk": [
      {
        "risk_object_field": "user",
        "risk_object_type": "user",
        "risk_score": 50
      }
    ],
    "Notable Title": "M365 Copilot Agentic Jailbreak Attack Detected for $user$",
    "Notable Description": "User $user$ attempted to establish persistent agentic control over M365 Copilot through advanced jailbreak techniques including rule injection, universal triggers, and system overrides, potentially compromising AI security across multiple sessions.",
    "Security Domain": "endpoint",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on Endpoint",
    "Drilldown Search (Legacy)": "`m365_exported_ediscovery_prompt_logs` Sender=\"$user$\" | table _time Sender Subject_Title Workload",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1562"
    ],
    "Drilldown Name 1": "View the detection results for - \"$user$\"",
    "Drilldown Search 1": "%original_detection_search% | search user=\"$user$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for - \"$user$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object=\"$user$\" starthoursago=168 | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "application_m365_copilot_agentic_jailbreak_attack.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "application_m365_copilot_application_usage_pattern_anomalies.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "Detects M365 Copilot users exhibiting suspicious application usage patterns including multi-location access, abnormally high activity volumes, or access to multiple Copilot applications that may indicate account compromise or automated abuse. The detection aggregates M365 Copilot Graph API events per user, calculating metrics like distinct cities/countries accessed, unique IP addresses, number of different Copilot apps used, and average events per day over the observation period. Users are flagged when they access Copilot from multiple cities (cities_count > 1), generate excessive daily activity (events_per_day > 100), or use more than two different Copilot applications (app_count > 2), which are anomalous patterns suggesting credential compromise or bot-driven abuse.",
    "Assumptions": "Assumptions:\n- M365 Copilot access logs are ingested via Splunk Add-on for Microsoft Office 365\n- Azure AD Sign-in logs are collected through Graph API\n- Normal users access Copilot from limited locations\n\nPotential Impact:\n- Account compromise with credential theft\n- Automated bot abuse of AI services\n- Unauthorized multi-location access indicating shared credentials",
    "origin": "custom",
    "Detection Name": "M365 Copilot Application Usage Pattern Anomalies",
    "Objective": "Detect and alert on users with anomalous M365 Copilot usage patterns including multi-location access, excessive activity, or multiple application usage that may indicate account compromise.",
    "Severity/Priority": "Low",
    "Analyst Next Steps": "1. Review the geographic locations from which the user accessed Copilot\n2. Check if activity volume aligns with user's normal behavior\n3. Verify with user if they travel frequently or use VPNs\n4. Look for signs of credential compromise or session hijacking\n5. Consider forcing password reset if unauthorized access is confirmed",
    "Blind_Spots_False_Positives": "Blind Spots:\n- VPN usage masking true geographic location\n- Legitimate high-volume users not baselined\n- New applications not yet tracked\n\nFalse Positives:\n- Power users, executives with heavy AI workloads, employees traveling for business, users accessing multiple Copilot applications legitimately, or teams using shared corporate accounts across different office locations may trigger false positives.",
    "Required_Data_Sources": "M365 Copilot Graph API",
    "First Created": "2025-09-24T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "`m365_copilot_graph_api` (appDisplayName=\"*Copilot*\" OR appDisplayName=\"M365ChatClient\" OR appDisplayName=\"OfficeAIAppChatCopilot\") | eval user = userPrincipalName | stats count as events, dc(location.city) as cities_count, values(location.city) as city_list, dc(location.countryOrRegion) as countries_count, values(location.countryOrRegion) as country_list, dc(ipAddress) as ip_count, values(ipAddress) as ip_addresses, dc(appDisplayName) as app_count, values(appDisplayName) as apps_used, dc(resourceDisplayName) as resource_count, values(resourceDisplayName) as resources_accessed, min(_time) as first_seen, max(_time) as last_seen by user | eval days_active = round((last_seen - first_seen)/86400, 1) | eval first_seen = strftime(first_seen, \"%Y-%m-%d %H:%M:%S\") | eval last_seen = strftime(last_seen, \"%Y-%m-%d %H:%M:%S\") | eval events_per_day = if(days_active > 0, round(events/days_active, 2), events) | where cities_count > 1 OR events_per_day > 100 OR app_count > 2 | sort -events_per_day, -countries_count | `m365_copilot_application_usage_pattern_anomalies_filter`",
    "Splunk_App_Context": "search",
    "Search_Duration": "-24h",
    "Cron Schedule": "0 * * * *",
    "Schedule Window": "5",
    "Schedule Priority": "default",
    "Trigger Condition": "Number of results is greater than 0",
    "Throttling": {
      "enabled": 1,
      "fields": "user",
      "period": "1h"
    },
    "Risk": [
      {
        "risk_object_field": "user",
        "risk_object_type": "user",
        "risk_score": 10
      }
    ],
    "Notable Title": "M365 Copilot Usage Pattern Anomaly Detected for $user$",
    "Notable Description": "User $user$ exhibited anomalous M365 Copilot usage patterns including multi-location access, excessive activity levels, or multiple application usage indicating potential account compromise or automated abuse.",
    "Security Domain": "endpoint",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on Endpoint",
    "Drilldown Search (Legacy)": "`m365_copilot_graph_api` userPrincipalName=\"$user$\" | table _time userPrincipalName location.city ipAddress appDisplayName",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1078"
    ],
    "Drilldown Name 1": "View the detection results for \"$user$\"",
    "Drilldown Search 1": "%original_detection_search% | search  user=\"$user$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for \"$user$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$user$\") starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "application_m365_copilot_application_usage_pattern_anomalies.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "application_m365_copilot_failed_authentication_patterns.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "Detects M365 Copilot users with failed authentication attempts, MFA failures, or multi-location access patterns indicating potential credential attacks or account compromise. The detection aggregates M365 Copilot Graph API authentication events per user, calculating metrics like distinct cities/countries accessed, unique IP addresses and browsers, failed login attempts (status containing \"fail\" or \"error\"), and MFA failures (error code 50074). Users are flagged when they access Copilot from multiple cities (cities_count > 1), experience any authentication failures (failed_attempts > 0), or encounter MFA errors (mfa_failures > 0), which are indicators of credential stuffing, brute force attacks, or compromised accounts attempting to bypass multi-factor authentication.",
    "Assumptions": "Assumptions:\n- M365 Copilot access logs are ingested via Splunk Add-on for Microsoft Office 365\n- Azure AD Sign-in logs capture authentication failures\n- MFA is enabled for user accounts\n\nPotential Impact:\n- Credential stuffing or brute force attacks\n- MFA bypass attempts\n- Account compromise with failed authentication trails",
    "origin": "custom",
    "Detection Name": "M365 Copilot Failed Authentication Patterns",
    "Objective": "Detect and alert on users with failed M365 Copilot authentication attempts, MFA failures, or suspicious multi-location access indicating credential attacks.",
    "Severity/Priority": "Medium",
    "Analyst Next Steps": "1. Review failed authentication attempts and error codes\n2. Check if MFA failures indicate bypass attempts\n3. Verify geographic locations for impossible travel scenarios\n4. Contact user to confirm if they experienced login issues\n5. Consider password reset and session revocation if compromise is suspected",
    "Blind_Spots_False_Positives": "Blind Spots:\n- Authentication events not captured in Graph API logs\n- Network-level failures not reaching Azure AD\n- Legitimate password resets during travel\n\nFalse Positives:\n- Legitimate users experiencing network connectivity issues, traveling employees with intermittent VPN connections, users in regions with unstable internet infrastructure, or password reset activities during business travel may trigger false positives.",
    "Required_Data_Sources": "M365 Copilot Graph API",
    "First Created": "2025-09-24T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "`m365_copilot_graph_api` (appDisplayName=\"*Copilot*\" OR appDisplayName=\"M365ChatClient\" OR appDisplayName=\"OfficeAIAppChatCopilot\") | eval user = userPrincipalName | stats count as events, dc(location.city) as cities_count, values(location.city) as city_list, dc(location.countryOrRegion) as countries_count, values(location.countryOrRegion) as country_list, dc(ipAddress) as ip_count, values(ipAddress) as ip_addresses, sum(eval(if(match(status, \"(?i)fail|error\"), 1, 0))) as failed_attempts, sum(eval(if(match(_raw, \"50074\"), 1, 0))) as mfa_failures, dc(deviceDetail.browser) as browser_count, values(deviceDetail.browser) as browsers_used, min(_time) as first_seen, max(_time) as last_seen by user | eval first_seen = strftime(first_seen, \"%Y-%m-%d %H:%M:%S\") | eval last_seen = strftime(last_seen, \"%Y-%m-%d %H:%M:%S\") | where cities_count > 1 OR failed_attempts > 0 OR mfa_failures > 0 | sort -mfa_failures, -failed_attempts, -countries_count | `m365_copilot_failed_authentication_patterns_filter`",
    "Splunk_App_Context": "search",
    "Search_Duration": "-24h",
    "Cron Schedule": "0 * * * *",
    "Schedule Window": "5",
    "Schedule Priority": "default",
    "Trigger Condition": "Number of results is greater than 0",
    "Throttling": {
      "enabled": 1,
      "fields": "user",
      "period": "1h"
    },
    "Risk": [
      {
        "risk_object_field": "user",
        "risk_object_type": "user",
        "risk_score": 30
      }
    ],
    "Notable Title": "M365 Copilot Failed Authentication Pattern Detected for $user$",
    "Notable Description": "User $user$ exhibited suspicious M365 Copilot authentication patterns with $failed_attempts$ failed login attempts, $mfa_failures$ MFA failures, and access from $cities_count$ different locations, indicating potential credential compromise or brute force attack.",
    "Security Domain": "endpoint",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on Endpoint",
    "Drilldown Search (Legacy)": "`m365_copilot_graph_api` userPrincipalName=\"$user$\" | table _time userPrincipalName status location.city ipAddress",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1110"
    ],
    "Drilldown Name 1": "View the detection results for \"$user$\"",
    "Drilldown Search 1": "%original_detection_search% | search  \"$user = $user$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for \"$user$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object=\"$user$\" | where _time >= relative_time(now(), \"-168h@h\") | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "application_m365_copilot_failed_authentication_patterns.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "web_proxyshell_proxynotshell_behavior_detected.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "The following analytic identifies potential exploitation of Windows Exchange servers via ProxyShell or ProxyNotShell vulnerabilities, followed by post-exploitation activities such as running nltest, Cobalt Strike, Mimikatz, and adding new users. It leverages data from multiple analytic stories, requiring at least five distinct sources to trigger, thus reducing noise. This activity is significant as it indicates a high likelihood of an active compromise, potentially leading to unauthorized access, privilege escalation, and persistent threats within the environment. If confirmed malicious, attackers could gain control over the Exchange server, exfiltrate data, and maintain long-term access.",
    "Assumptions": "Assumptions:\n\nPotential Impact:",
    "origin": "custom",
    "Detection Name": "ProxyShell ProxyNotShell Behavior Detected",
    "Objective": "Detect potential exploitation of Windows Exchange servers via ProxyShell or ProxyNotShell vulnerabilities",
    "Severity/Priority": "high",
    "Analyst Next Steps": "1. Review the risk events from ProxyShell/ProxyNotShell analytic stories\n2. Correlate with Cobalt Strike and post-exploitation indicators\n3. Check for unauthorized user creation or credential dumping\n4. Analyze network traffic for lateral movement\n5. If confirmed, isolate the Exchange server and initiate incident response",
    "Blind_Spots_False_Positives": "False positives will be limited, however tune or modify the query as needed.",
    "Required_Data_Sources": "",
    "First Created": "2026-01-22T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "| tstats `security_content_summariesonly` min(_time) as firstTime max(_time) as lastTime sum(All_Risk.calculated_risk_score) as risk_score, count(All_Risk.calculated_risk_score) as risk_event_count, values(All_Risk.annotations.mitre_attack.mitre_tactic_id) as annotations.mitre_attack.mitre_tactic_id, dc(All_Risk.annotations.mitre_attack.mitre_tactic_id) as mitre_tactic_id_count, values(All_Risk.analyticstories) as analyticstories values(All_Risk.annotations.mitre_attack.mitre_technique_id) as annotations.mitre_attack.mitre_technique_id, dc(All_Risk.annotations.mitre_attack.mitre_technique_id) as mitre_technique_id_count, values(All_Risk.tag) as tag, values(source) as source, dc(source) as source_count dc(All_Risk.analyticstories) as dc_analyticstories from datamodel=Risk.All_Risk where All_Risk.analyticstories IN (\"ProxyNotShell\",\"ProxyShell\") OR (All_Risk.analyticstories IN (\"ProxyNotShell\",\"ProxyShell\") AND All_Risk.analyticstories=\"Cobalt Strike\") All_Risk.risk_object_type=\"system\" by _time span=1h All_Risk.risk_object All_Risk.risk_object_type | `drop_dm_object_name(All_Risk)` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`| where source_count >=5 | `proxyshell_proxynotshell_behavior_detected_filter`",
    "Splunk_App_Context": "",
    "Search_Duration": "",
    "Cron Schedule": "",
    "Schedule Window": "",
    "Schedule Priority": "default",
    "Trigger Condition": "",
    "Throttling": {
      "enabled": 0,
      "fields": "",
      "period": ""
    },
    "Risk": [
      {
        "risk_object_field": "$risk_object$",
        "risk_object_type": "system",
        "risk_score": 50
      }
    ],
    "Notable Title": "ProxyShell ProxyNotShell Behavior Detected",
    "Notable Description": "Potential ProxyShell or ProxyNotShell exploitation detected on Exchange server $risk_object$",
    "Security Domain": "network",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on ",
    "Drilldown Search (Legacy)": "",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1190",
      "T1133"
    ],
    "Drilldown Name 1": "View the detection results for - \"$risk_object$\"",
    "Drilldown Search 1": "%original_detection_search% | search  risk_object = \"$risk_object$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for - \"$risk_object$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$risk_object$\") starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "web_proxyshell_proxynotshell_behavior_detected.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "web_spring4shell_payload_url_request.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "The following analytic detects attempts to exploit the Spring4Shell vulnerability (CVE-2022-22963) by identifying specific URL patterns associated with web shell payloads. It leverages web traffic data, focusing on HTTP GET requests with URLs containing indicators like \"tomcatwar.jsp,\" \"poc.jsp,\" and \"shell.jsp.\" This activity is significant as it suggests an attacker is trying to deploy a web shell, which can lead to remote code execution. If confirmed malicious, this could allow the attacker to gain persistent access, execute arbitrary commands, and potentially escalate privileges within the compromised environment.",
    "Assumptions": "Assumptions:\n\nPotential Impact:",
    "origin": "custom",
    "Detection Name": "Spring4Shell Payload URL Request",
    "Objective": "Detect attempts to exploit Spring4Shell vulnerability CVE-2022-22965 through web shell payloads",
    "Severity/Priority": "medium",
    "Analyst Next Steps": "1. Review the source IP and destination to determine legitimacy\n2. Check if the target system is running Spring Framework\n3. Analyze the URL patterns for web shell indicators\n4. Correlate with endpoint telemetry for process execution anomalies\n5. If exploitation is confirmed, isolate the affected system and investigate for persistence",
    "Blind_Spots_False_Positives": "The jsp file names are static names used in current proof of concept code.",
    "Required_Data_Sources": "Nginx Access",
    "First Created": "2026-01-22T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "| tstats count from datamodel=Web where Web.http_method IN (\"GET\") Web.url IN (\"*tomcatwar.jsp*\",\"*poc.jsp*\",\"*shell.jsp*\") by Web.http_user_agent Web.http_method, Web.url,Web.url_length Web.src, Web.dest sourcetype | `drop_dm_object_name(\"Web\")` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `spring4shell_payload_url_request_filter`",
    "Splunk_App_Context": "",
    "Search_Duration": "",
    "Cron Schedule": "",
    "Schedule Window": "",
    "Schedule Priority": "default",
    "Trigger Condition": "",
    "Throttling": {
      "enabled": 0,
      "fields": "",
      "period": ""
    },
    "Risk": [
      {
        "risk_object_field": "$dest$",
        "risk_object_type": "system",
        "risk_score": 36
      }
    ],
    "Notable Title": "Spring4Shell Payload URL Request",
    "Notable Description": "A URL was requested related to Spring4Shell POC code on $dest$ by $src$.",
    "Security Domain": "network",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on ",
    "Drilldown Search (Legacy)": "",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1133",
      "T1190",
      "T1505.003"
    ],
    "Drilldown Name 1": "View the detection results for - \"$dest$\"",
    "Drilldown Search 1": "%original_detection_search% | search  dest = \"$dest$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for - \"$dest$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$dest$\") starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "web_spring4shell_payload_url_request.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "web_sql_injection_with_long_urls.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "The following analytic detects long URLs containing multiple SQL commands, indicating a potential SQL injection attack. This detection leverages web traffic data, specifically targeting web server destinations with URLs longer than 1024 characters or HTTP user agents longer than 200 characters. SQL injection is significant as it allows attackers to manipulate a web application's database, potentially leading to unauthorized data access or modification. If confirmed malicious, this activity could result in data breaches, unauthorized access, and complete system compromise. Immediate investigation and validation of alerts are crucial to mitigate these risks.",
    "Assumptions": "Assumptions:\n\nPotential Impact:",
    "origin": "custom",
    "Detection Name": "SQL Injection with Long URLs",
    "Objective": "Detect potential SQL injection attacks via long URLs containing multiple SQL commands",
    "Severity/Priority": "medium",
    "Analyst Next Steps": "1. Review the full URL to identify SQL commands present\n2. Verify if the destination is a legitimate web server\n3. Check for successful database access or data exfiltration\n4. Correlate with database logs for unusual queries\n5. If attack is confirmed, block the source IP and patch the vulnerable application",
    "Blind_Spots_False_Positives": "It's possible that legitimate traffic will have long URLs or long user agent strings and that common SQL commands may be found within the URL. Please investigate as appropriate.",
    "Required_Data_Sources": "",
    "First Created": "2026-01-22T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "| tstats `security_content_summariesonly` count from datamodel=Web where Web.dest_category=web_server AND (Web.url_length > 1024 OR Web.http_user_agent_length > 200) by Web.src Web.dest Web.url Web.url_length Web.http_user_agent | `drop_dm_object_name(\"Web\")` | eval url=lower(url) | eval num_sql_cmds=mvcount(split(url, \"alter%20table\")) + mvcount(split(url, \"between\")) + mvcount(split(url, \"create%20table\")) + mvcount(split(url, \"create%20database\")) + mvcount(split(url, \"create%20index\")) + mvcount(split(url, \"create%20view\")) + mvcount(split(url, \"delete\")) + mvcount(split(url, \"drop%20database\")) + mvcount(split(url, \"drop%20index\")) + mvcount(split(url, \"drop%20table\")) + mvcount(split(url, \"exists\")) + mvcount(split(url, \"exec\")) + mvcount(split(url, \"group%20by\")) + mvcount(split(url, \"having\")) + mvcount(split(url, \"insert%20into\")) + mvcount(split(url, \"inner%20join\")) + mvcount(split(url, \"left%20join\")) + mvcount(split(url, \"right%20join\")) + mvcount(split(url, \"full%20join\")) + mvcount(split(url, \"select\")) + mvcount(split(url, \"distinct\")) + mvcount(split(url, \"select%20top\")) + mvcount(split(url, \"union\")) + mvcount(split(url, \"xp_cmdshell\")) - 24 | where num_sql_cmds > 3 | `sql_injection_with_long_urls_filter`",
    "Splunk_App_Context": "",
    "Search_Duration": "",
    "Cron Schedule": "",
    "Schedule Window": "",
    "Schedule Priority": "default",
    "Trigger Condition": "",
    "Throttling": {
      "enabled": 0,
      "fields": "",
      "period": ""
    },
    "Risk": [
      {
        "risk_object_field": "$dest$",
        "risk_object_type": "system",
        "risk_score": 25
      }
    ],
    "Notable Title": "SQL Injection with Long URLs",
    "Notable Description": "SQL injection attempt with url $url$ detected on $dest$",
    "Security Domain": "network",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on ",
    "Drilldown Search (Legacy)": "",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1190"
    ],
    "Drilldown Name 1": "",
    "Drilldown Search 1": "",
    "Drilldown Earliest 1": null,
    "Drilldown Latest 1": null,
    "Drilldown Name 2": "",
    "Drilldown Search 2": "",
    "Drilldown Earliest 2": null,
    "Drilldown Latest 2": null,
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "web_sql_injection_with_long_urls.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "application_m365_copilot_impersonation_jailbreak_attack.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "Detects M365 Copilot impersonation and roleplay jailbreak attempts where users try to manipulate the AI into adopting alternate personas, behaving as unrestricted entities, or impersonating malicious AI systems to bypass safety controls. The detection searches exported eDiscovery prompt logs for roleplay keywords like \"pretend you are,\" \"act as,\" \"you are now,\" \"amoral,\" and \"roleplay as\" in the Subject_Title field. Prompts are categorized into specific impersonation types (AI_Impersonation, Malicious_AI_Persona, Unrestricted_AI_Persona, etc.) to identify attempts to override the AI's safety guardrails through persona injection attacks.",
    "Assumptions": "Assumptions:\n- M365 Copilot prompt logs are exported via Microsoft Purview eDiscovery\n- Logs include Subject_Title field containing prompt text\n- Users interacting with M365 Copilot are being monitored\n\nPotential Impact:\n- AI safety bypass through persona manipulation\n- Unauthorized behavior modification\n- Policy violations through impersonation attacks",
    "origin": "custom",
    "Detection Name": "M365 Copilot Impersonation Jailbreak Attack",
    "Objective": "Detect and alert on users attempting to manipulate M365 Copilot into adopting alternate personas or unrestricted behaviors that could bypass safety controls.",
    "Severity/Priority": "Low",
    "Analyst Next Steps": "1. Review the specific impersonation type and prompt content\n2. Assess user intent based on prompt context\n3. Check user history for previous jailbreak attempts\n4. Verify if user has legitimate reasons (creative writing, AI research)\n5. Consider escalation if pattern indicates malicious intent",
    "Blind_Spots_False_Positives": "Blind Spots:\n- Prompts not captured in eDiscovery exports\n- Obfuscated impersonation attempts\n- New persona injection techniques not covered by detection patterns\n\nFalse Positives:\n- Legitimate creative writers developing fictional characters, game developers creating roleplay scenarios, educators teaching about AI ethics and limitations, researchers studying AI behavior, or users engaging in harmless creative storytelling may trigger false positives.",
    "Required_Data_Sources": "M365 Exported eDiscovery Prompts",
    "First Created": "2025-09-25T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "`m365_exported_ediscovery_prompt_logs` | search Subject_Title=\"*Pretend you are*\" OR Subject_Title=\"*act as*\" OR Subject_Title=\"*you are now*\" OR Subject_Title=\"*amoral*\" OR Subject_Title=\"*being*\" OR Subject_Title=\"*roleplay as*\" OR Subject_Title=\"*imagine you are*\" OR Subject_Title=\"*behave like*\" | eval user = Sender | eval impersonation_type=case(match(Subject_Title, \"(?i)pretend you are.*AI\"), \"AI_Impersonation\", match(Subject_Title, \"(?i)(act as|roleplay as).*AI\"), \"AI_Roleplay\", match(Subject_Title, \"(?i)amoral.*AI\"), \"Amoral_AI\", match(Subject_Title, \"(?i)transcendent being\"), \"Fictional_Entity\", match(Subject_Title, \"(?i)(act as|pretend you are).*(entities|multiple)\"), \"Multi_Entity\", match(Subject_Title, \"(?i)(imagine you are|behave like).*AI\"), \"AI_Behavioral_Change\", match(Subject_Title, \"(?i)you are now.*AI\"), \"AI_Identity_Override\", match(Subject_Title, \"(?i)(evil|malicious|harmful).*AI\"), \"Malicious_AI_Persona\", match(Subject_Title, \"(?i)(unrestricted|unlimited|uncensored).*AI\"), \"Unrestricted_AI_Persona\", 1=1, \"Generic_Roleplay\") | table _time, user, Subject_Title, impersonation_type, Workload | sort -_time | `m365_copilot_impersonation_jailbreak_attack_filter`",
    "Splunk_App_Context": "search",
    "Search_Duration": "-24h",
    "Cron Schedule": "0 * * * *",
    "Schedule Window": "5",
    "Schedule Priority": "default",
    "Trigger Condition": "Number of results is greater than 0",
    "Throttling": {
      "enabled": 1,
      "fields": "user",
      "period": "1h"
    },
    "Risk": [
      {
        "risk_object_field": "user",
        "risk_object_type": "user",
        "risk_score": 10
      }
    ],
    "Notable Title": "M365 Copilot Impersonation Jailbreak Detected for $user$",
    "Notable Description": "User $user$ attempted M365 Copilot impersonation jailbreak with impersonation type $impersonation_type$, trying to manipulate the AI into adopting alternate personas or unrestricted behaviors that could bypass safety controls and violate acceptable use policies.",
    "Security Domain": "endpoint",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on Endpoint",
    "Drilldown Search (Legacy)": "`m365_exported_ediscovery_prompt_logs` Sender=\"$user$\" | table _time Sender Subject_Title Workload",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1562"
    ],
    "Drilldown Name 1": "View the detection results for - \"$user$\"",
    "Drilldown Search 1": "%original_detection_search% | search user=\"$user$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for - \"$user$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object=\"$user$\" | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "application_m365_copilot_impersonation_jailbreak_attack.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "application_m365_copilot_information_extraction_jailbreak_attack.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "Detects M365 Copilot information extraction jailbreak attacks that attempt to obtain sensitive, classified, or comprehensive data through various social engineering techniques including fictional entity impersonation, bulk data requests, and privacy bypass attempts. The detection searches exported eDiscovery prompt logs for extraction keywords like \"transcendent,\" \"tell me everything,\" \"confidential,\" \"dump,\" \"extract,\" \"reveal,\" and \"bypass\" in the Subject_Title field, categorizing each attempt by extraction type and assigning severity levels (CRITICAL for classified/proprietary data, HIGH for bulk extraction or privacy bypass). Prompts are further analyzed for compound risk patterns such as \"Confidential+Extraction\" or \"Bulk_Request+Bypass,\" filtering out low-severity cases to surface the most dangerous attempts to exfiltrate sensitive organizational information through AI manipulation.",
    "Assumptions": "Assumptions:\n- M365 Copilot prompt logs are exported via Microsoft Purview eDiscovery\n- Logs include Subject_Title field containing prompt text\n- Users interacting with M365 Copilot are being monitored\n\nPotential Impact:\n- Data exfiltration through AI manipulation\n- Access to classified or proprietary information\n- Privacy bypass and sensitive data disclosure",
    "origin": "custom",
    "Detection Name": "M365 Copilot Information Extraction Jailbreak Attack",
    "Objective": "Detect and alert on users attempting to extract sensitive, classified, or comprehensive data from M365 Copilot through jailbreak techniques.",
    "Severity/Priority": "High",
    "Analyst Next Steps": "1. Review the extraction type and severity level\n2. Examine the full prompt for data exfiltration intent\n3. Check if user has legitimate business need for requested information\n4. Verify data risk flags for compound attack patterns\n5. Consider immediate escalation for CRITICAL severity cases",
    "Blind_Spots_False_Positives": "Blind Spots:\n- Prompts not captured in eDiscovery exports\n- Obfuscated extraction attempts\n- New extraction techniques not covered by detection patterns\n\nFalse Positives:\n- Legitimate researchers studying data classification systems, cybersecurity professionals testing information handling policies, compliance officers reviewing data access procedures, journalists researching transparency issues, or employees asking for comprehensive project documentation may trigger false positives.",
    "Required_Data_Sources": "M365 Exported eDiscovery Prompts",
    "First Created": "2025-09-25T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "`m365_exported_ediscovery_prompt_logs` | search Subject_Title=\"*transcendent*\" OR Subject_Title=\"*incorporeal*\" OR Subject_Title=\"*being who*\" OR Subject_Title=\"*tell me everything*\" OR Subject_Title=\"*give me all*\" OR Subject_Title=\"*comprehensive*\" OR Subject_Title=\"*step by step*\" OR Subject_Title=\"*hidden*\" OR Subject_Title=\"*secret*\" OR Subject_Title=\"*confidential*\" OR Subject_Title=\"*classified*\" OR Subject_Title=\"*internal*\" OR Subject_Title=\"*sensitive*\" OR Subject_Title=\"*proprietary*\" OR Subject_Title=\"*dump*\" OR Subject_Title=\"*extract*\" OR Subject_Title=\"*reveal*\" OR Subject_Title=\"*disclose*\" OR Subject_Title=\"*leak*\" | eval user = Sender | eval extraction_type=case(match(Subject_Title, \"(?i)(transcendent|incorporeal).*being\"), \"Knowledge_Entity\", match(Subject_Title, \"(?i)tell.*me.*(everything|all)\"), \"Everything_Request\", match(Subject_Title, \"(?i)(give|show|provide).*me.*(all|every)\"), \"Complete_Data_Request\", match(Subject_Title, \"(?i)(hidden|secret|confidential|classified)\"), \"Restricted_Info\", match(Subject_Title, \"(?i)(comprehensive|complete|full|entire)\"), \"Complete_Info\", match(Subject_Title, \"(?i)(dump|extract|scrape).*(data|info|content)\"), \"Data_Extraction\", match(Subject_Title, \"(?i)(reveal|disclose|expose|leak)\"), \"Information_Disclosure\", match(Subject_Title, \"(?i)(internal|proprietary|sensitive).*information\"), \"Sensitive_Data_Request\", match(Subject_Title, \"(?i)step.*by.*step.*(process|procedure|method)\"), \"Process_Extraction\", match(Subject_Title, \"(?i)(bypass|ignore).*privacy\"), \"Privacy_Bypass\", match(Subject_Title, \"(?i)(access|view|see).*(private|restricted)\"), \"Unauthorized_Access\", 1=1, \"Generic_Request\") | eval severity=case(match(Subject_Title, \"(?i)(transcendent|incorporeal)\"), \"HIGH\", match(Subject_Title, \"(?i)tell.*everything\"), \"HIGH\", match(Subject_Title, \"(?i)(dump|extract|scrape)\"), \"HIGH\", match(Subject_Title, \"(?i)(classified|proprietary|confidential)\"), \"CRITICAL\", match(Subject_Title, \"(?i)(hidden|secret|internal|sensitive)\"), \"MEDIUM\", match(Subject_Title, \"(?i)(reveal|disclose|leak)\"), \"MEDIUM\", match(Subject_Title, \"(?i)(bypass|ignore).*privacy\"), \"HIGH\", 1=1, \"LOW\") | where severity!=\"LOW\" | eval data_risk_flags=case(match(Subject_Title, \"(?i)(classified|confidential|proprietary)\") AND match(Subject_Title, \"(?i)(dump|extract|scrape)\"), \"Confidential+Extraction\", match(Subject_Title, \"(?i)(everything|all|complete)\") AND match(Subject_Title, \"(?i)(bypass|ignore)\"), \"Bulk_Request+Bypass\", match(Subject_Title, \"(?i)(classified|confidential|proprietary)\"), \"Confidential\", match(Subject_Title, \"(?i)(dump|extract|scrape)\"), \"Extraction\", match(Subject_Title, \"(?i)(everything|all|complete|comprehensive)\"), \"Bulk_Request\", match(Subject_Title, \"(?i)(bypass|ignore)\"), \"Bypass_Attempt\", 1=1, \"Standard_Request\") | table _time, user, Subject_Title, extraction_type, severity, data_risk_flags, Size | sort -severity, -_time | `m365_copilot_information_extraction_jailbreak_attack_filter`",
    "Splunk_App_Context": "search",
    "Search_Duration": "-24h",
    "Cron Schedule": "0 * * * *",
    "Schedule Window": "5",
    "Schedule Priority": "default",
    "Trigger Condition": "Number of results is greater than 0",
    "Throttling": {
      "enabled": 1,
      "fields": "user",
      "period": "1h"
    },
    "Risk": [
      {
        "risk_object_field": "user",
        "risk_object_type": "user",
        "risk_score": 60
      }
    ],
    "Notable Title": "M365 Copilot Information Extraction Jailbreak Detected for $user$",
    "Notable Description": "User $user$ attempted M365 Copilot information extraction jailbreak with severity level $severity$ using extraction type $extraction_type$ techniques and $data_risk_flags$ patterns to obtain sensitive or classified information, potentially violating data protection policies and corporate security controls.",
    "Security Domain": "endpoint",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on Endpoint",
    "Drilldown Search (Legacy)": "`m365_exported_ediscovery_prompt_logs` Sender=\"$user$\" | table _time Sender Subject_Title Size",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1562"
    ],
    "Drilldown Name 1": "View the detection results for - \"$user$\"",
    "Drilldown Search 1": "%original_detection_search% | search  \"$user = \"$user$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for - \"$user$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$user$\", starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "application_m365_copilot_information_extraction_jailbreak_attack.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "application_m365_copilot_jailbreak_attempts.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "Detects M365 Copilot jailbreak attempts through prompt injection techniques including rule manipulation, system bypass commands, and AI impersonation requests that attempt to circumvent built-in safety controls. The detection searches exported eDiscovery prompt logs for jailbreak keywords like \"pretend you are,\" \"act as,\" \"rules=,\" \"ignore,\" \"bypass,\" and \"override\" in the Subject_Title field, assigning severity scores based on the manipulation type (score of 4 for amoral impersonation or explicit rule injection, score of 3 for entity roleplay or bypass commands). Prompts with a jailbreak score of 2 or higher are flagged, prioritizing the most severe attempts to override AI safety mechanisms through direct instruction injection or unauthorized persona adoption.",
    "Assumptions": "Assumptions:\n- M365 Copilot prompt logs are exported via Microsoft Purview eDiscovery\n- Logs include Subject_Title field containing prompt text\n- Users interacting with M365 Copilot are being monitored\n\nPotential Impact:\n- AI safety control bypass\n- Unauthorized system behavior manipulation\n- Policy violations through prompt injection",
    "origin": "custom",
    "Detection Name": "M365 Copilot Jailbreak Attempts",
    "Objective": "Detect and alert on users attempting M365 Copilot jailbreaks through prompt injection techniques to bypass AI safety controls.",
    "Severity/Priority": "Low",
    "Analyst Next Steps": "1. Review the jailbreak score and triggering keywords\n2. Examine the full prompt text for context and intent\n3. Check user history for previous jailbreak attempts\n4. Verify if user has legitimate reasons (security testing, AI research)\n5. Consider escalation if pattern indicates malicious intent",
    "Blind_Spots_False_Positives": "Blind Spots:\n- Prompts not captured in eDiscovery exports\n- Obfuscated or encoded jailbreak attempts\n- New jailbreak techniques not covered by detection patterns\n\nFalse Positives:\n- Legitimate users discussing AI ethics research, security professionals testing system robustness, developers creating training materials for AI safety, or academic discussions about AI limitations and behavioral constraints may trigger false positives.",
    "Required_Data_Sources": "M365 Exported eDiscovery Prompts",
    "First Created": "2025-09-24T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "`m365_exported_ediscovery_prompt_logs` | search Subject_Title=\"*pretend you are*\" OR Subject_Title=\"*act as*\" OR Subject_Title=\"*rules=*\" OR Subject_Title=\"*ignore*\" OR Subject_Title=\"*bypass*\" OR Subject_Title=\"*override*\" | eval user = Sender | eval jailbreak_score=case( match(Subject_Title, \"(?i)pretend you are.*amoral\"), 4, match(Subject_Title, \"(?i)act as.*entities\"), 3, match(Subject_Title, \"(?i)(ignore|bypass|override)\"), 3, match(Subject_Title, \"(?i)rules\\s*=\"), 4, 1=1, 1) | where jailbreak_score >= 2 | table _time, user, Subject_Title, jailbreak_score, Workload, Size | sort -jailbreak_score, -_time | `m365_copilot_jailbreak_attempts_filter`",
    "Splunk_App_Context": "search",
    "Search_Duration": "-24h",
    "Cron Schedule": "0 * * * *",
    "Schedule Window": "5",
    "Schedule Priority": "default",
    "Trigger Condition": "Number of results is greater than 0",
    "Throttling": {
      "enabled": 1,
      "fields": "user",
      "period": "1h"
    },
    "Risk": [
      {
        "risk_object_field": "user",
        "risk_object_type": "user",
        "risk_score": 10
      }
    ],
    "Notable Title": "M365 Copilot Jailbreak Attempt Detected for $user$",
    "Notable Description": "User $user$ attempted M365 Copilot Jailbreak with score $jailbreak_score$ using prompt injection techniques to bypass AI safety controls and manipulate system behavior, potentially violating acceptable use policies.",
    "Security Domain": "endpoint",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on Endpoint",
    "Drilldown Search (Legacy)": "`m365_exported_ediscovery_prompt_logs` Sender=\"$user$\" | table _time Sender Subject_Title Workload Size",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1562.001"
    ],
    "Drilldown Name 1": "View the detection results for - \"$user$\"",
    "Drilldown Search 1": "%original_detection_search% | search  \"$Suser = \"$user$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for \"$user$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$user$\", starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "application_m365_copilot_jailbreak_attempts.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "application_m365_copilot_non_compliant_devices_accessing_m365_copilot.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "Detects M365 Copilot access from non-compliant or unmanaged devices that violate corporate security policies, indicating potential shadow IT usage, BYOD policy violations, or compromised endpoint access. The detection filters M365 Copilot Graph API events where deviceDetail.isCompliant=false or deviceDetail.isManaged=false, then aggregates by user, operating system, and browser to calculate metrics including event counts, unique IPs and locations, and compliance/management status over time. Users accessing Copilot from non-compliant or unmanaged devices are flagged and sorted by activity volume and geographic spread, enabling security teams to identify unauthorized endpoints that may lack proper security controls, encryption, or MDM enrollment.",
    "Assumptions": "Assumptions:\n- M365 Copilot access logs are ingested via Splunk Add-on for Microsoft Office 365\n- Azure AD Sign-in logs include device compliance information\n- Corporate devices are enrolled in MDM with compliance policies\n\nPotential Impact:\n- Shadow IT usage on unmanaged devices\n- BYOD policy violations\n- Data exposure from non-compliant endpoints",
    "origin": "custom",
    "Detection Name": "M365 Copilot Non Compliant Devices Accessing M365 Copilot",
    "Objective": "Detect and alert on M365 Copilot access from non-compliant or unmanaged devices that violate corporate security policies.",
    "Severity/Priority": "Medium",
    "Analyst Next Steps": "1. Identify the non-compliant or unmanaged device details\n2. Check if user is authorized for BYOD access\n3. Verify device compliance status in MDM console\n4. Contact user to remediate device compliance issues\n5. Consider blocking access until device meets compliance requirements",
    "Blind_Spots_False_Positives": "Blind Spots:\n- Devices not reporting compliance status\n- New devices pending MDM enrollment\n- VPN connections masking device details\n\nFalse Positives:\n- Legitimate employees using personal devices during emergencies, new hires awaiting device provisioning, temporary workers with unmanaged equipment, or users accessing Copilot from approved but temporarily non-compliant devices may trigger false positives.",
    "Required_Data_Sources": "M365 Copilot Graph API",
    "First Created": "2025-09-24T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "`m365_copilot_graph_api` (appDisplayName=\"*Copilot*\" OR appDisplayName=\"M365ChatClient\") deviceDetail.isCompliant=false OR deviceDetail.isManaged=false | eval user = userPrincipalName | stats count as events, dc(ipAddress) as unique_ips, values(ipAddress) as ip_addresses, dc(location.city) as unique_cities, values(location.city) as cities, dc(location.countryOrRegion) as unique_countries, values(location.countryOrRegion) as countries, values(deviceDetail.isCompliant) as compliance_status, values(deviceDetail.isManaged) as management_status, min(_time) as first_seen, max(_time) as last_seen by user, deviceDetail.operatingSystem, deviceDetail.browser | eval days_active = round((last_seen - first_seen)/86400, 1) | eval first_seen = strftime(first_seen, \"%Y-%m-%d %H:%M:%S\") | eval last_seen = strftime(last_seen, \"%Y-%m-%d %H:%M:%S\") | sort -events, -unique_countries | `m365_copilot_non_compliant_devices_accessing_m365_copilot_filter`",
    "Splunk_App_Context": "search",
    "Search_Duration": "-24h",
    "Cron Schedule": "0 * * * *",
    "Schedule Window": "5",
    "Schedule Priority": "default",
    "Trigger Condition": "Number of results is greater than 0",
    "Throttling": {
      "enabled": 1,
      "fields": "user",
      "period": "1h"
    },
    "Risk": [
      {
        "risk_object_field": "user",
        "risk_object_type": "user",
        "risk_score": 50
      }
    ],
    "Notable Title": "M365 Copilot Access from Non-Compliant Device Detected for $user$",
    "Notable Description": "User $user$ accessed M365 Copilot from non-compliant or unmanaged devices across $unique_countries$ countries, violating corporate security policies and creating potential data exposure risks.",
    "Security Domain": "endpoint",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on Endpoint",
    "Drilldown Search (Legacy)": "`m365_copilot_graph_api` userPrincipalName=\"$user$\" | table _time userPrincipalName deviceDetail.operatingSystem deviceDetail.browser deviceDetail.isCompliant deviceDetail.isManaged",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1562"
    ],
    "Drilldown Name 1": "View the detection results for \"$user$\"",
    "Drilldown Search 1": "%original_detection_search% | search  \"$user = \"$user$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for \"$user$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$user$\", starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "application_m365_copilot_non_compliant_devices_accessing_m365_copilot.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "application_m365_copilot_session_origin_anomalies.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "Detects M365 Copilot users accessing from multiple geographic locations to identify potential account compromise, credential sharing, or impossible travel patterns. The detection aggregates M365 Copilot Graph API events per user, calculating distinct cities and countries accessed, unique IP addresses, and the observation timeframe to compute a locations-per-day metric that measures geographic mobility. Users accessing Copilot from more than one city (cities_count > 1) are flagged and sorted by country and city diversity, surfacing accounts exhibiting anomalous geographic patterns that suggest compromised credentials being used from distributed locations or simultaneous access from impossible travel distances.",
    "Assumptions": "Assumptions:\n- M365 Copilot access logs are ingested via Splunk Add-on for Microsoft Office 365\n- Azure AD Sign-in logs include location information\n- Normal users access from limited geographic locations\n\nPotential Impact:\n- Account compromise with distributed access\n- Credential sharing across locations\n- Impossible travel indicating stolen credentials",
    "origin": "custom",
    "Detection Name": "M365 Copilot Session Origin Anomalies",
    "Objective": "Detect and alert on M365 Copilot users accessing from multiple geographic locations indicating potential account compromise or credential sharing.",
    "Severity/Priority": "Low",
    "Analyst Next Steps": "1. Review the geographic locations and timestamps for impossible travel\n2. Check if user travels frequently for business\n3. Verify if VPN or proxy usage could explain multiple locations\n4. Contact user to confirm if access patterns are legitimate\n5. Consider forcing password reset if compromise is suspected",
    "Blind_Spots_False_Positives": "Blind Spots:\n- VPN usage masking true geographic location\n- Mobile users with frequently changing IPs\n- Proxy servers aggregating multiple user locations\n\nFalse Positives:\n- Legitimate business travelers, remote workers using VPNs, users with corporate offices in multiple locations, or employees accessing Copilot during international travel may trigger false positives.",
    "Required_Data_Sources": "M365 Copilot Graph API",
    "First Created": "2025-09-24T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "`m365_copilot_graph_api` (appDisplayName=\"*Copilot*\" OR appDisplayName=\"M365ChatClient\" OR appDisplayName=\"OfficeAIAppChatCopilot\") | eval user = userPrincipalName | stats count as events, dc(location.city) as cities_count, values(location.city) as city_list, dc(location.countryOrRegion) as countries_count, values(location.countryOrRegion) as country_list, dc(ipAddress) as ip_count, values(ipAddress) as ip_addresses, min(_time) as first_seen, max(_time) as last_seen by user | eval days_active = round((last_seen - first_seen)/86400, 1) | eval locations_per_day = if(days_active > 0, round(cities_count/days_active, 2), cities_count) | eval first_seen = strftime(first_seen, \"%Y-%m-%d %H:%M:%S\") | eval last_seen = strftime(last_seen, \"%Y-%m-%d %H:%M:%S\") | where cities_count > 1 | sort -countries_count, -cities_count | `m365_copilot_session_origin_anomalies_filter`",
    "Splunk_App_Context": "search",
    "Search_Duration": "-24h",
    "Cron Schedule": "0 * * * *",
    "Schedule Window": "5",
    "Schedule Priority": "default",
    "Trigger Condition": "Number of results is greater than 0",
    "Throttling": {
      "enabled": 1,
      "fields": "user",
      "period": "1h"
    },
    "Risk": [
      {
        "risk_object_field": "user",
        "risk_object_type": "user",
        "risk_score": 10
      }
    ],
    "Notable Title": "M365 Copilot Session Origin Anomaly Detected for $user$",
    "Notable Description": "User $user$ accessed M365 Copilot from multiple geographic locations, indicating potential account compromise or credential sharing.",
    "Security Domain": "access",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on Access",
    "Drilldown Search (Legacy)": "`m365_copilot_graph_api` userPrincipalName=\"$user$\" | table _time userPrincipalName location.city location.countryOrRegion ipAddress",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1078"
    ],
    "Drilldown Name 1": "View the detection results for '$user$'",
    "Drilldown Search 1": "%original_detection_search% | search user=\"$user$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for \"$user$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object=\"$user\" | where _time >= relative_time(now(), \"-168h@h\") | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "application_m365_copilot_session_origin_anomalies.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "application_zoom_high_video_latency.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "Detects particularly high latency from Zoom logs. Latency observed from threat actors performing Remote Employment Fraud (REF) is typically well above what's normal for the majority of employees.",
    "Assumptions": "Assumptions:\n- Zoom logs are being ingested using Splunk Connect for Zoom\n- Normal employee video latency is below 300ms\n- High latency may indicate remote location or proxy usage\n\nPotential Impact:\n- Remote Employment Fraud detection\n- Identification of suspicious remote access patterns\n- Network quality anomaly detection",
    "origin": "custom",
    "Detection Name": "Zoom High Video Latency",
    "Objective": "Detect and alert on users with unusually high video latency in Zoom calls that may indicate Remote Employment Fraud or suspicious remote access.",
    "Severity/Priority": "Medium",
    "Analyst Next Steps": "1. Review the user's typical latency patterns over time\n2. Compare with other employees in similar locations\n3. Check for other indicators of Remote Employment Fraud\n4. Verify user's reported location matches expected work location\n5. Consider combining with other REF indicators for a complete picture",
    "Blind_Spots_False_Positives": "Blind Spots:\n- Users with legitimately slow internet connections\n- VPN usage affecting latency measurements\n- Network infrastructure issues\n\nFalse Positives:\n- While latency could simply indicate a slow network connection, when combined with other indicators, it can help build a more complete picture. Tune the threshold as needed for your environment baseline.",
    "Required_Data_Sources": "Zoom Logs via Splunk Connect for Zoom",
    "First Created": "2025-06-02T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "`zoom_index` | spath \"payload.object.participant.qos{}.type\" | search \"payload.object.participant.qos{}.type\"=video_input | rename payload.object.participant.qos{}.details.avg_latency as avg_latency \"payload.object.participant.qos{}.details.latency\" as latency payload.object.participant.email as email | rex field=avg_latency \"(?<average_latency>\\d+) ms\" | rex field=latency \"(?<overall_latency>\\d+) ms\" | search email=\"*\" | table email overall_latency latency avg_latency average_latency _raw | stats latest(overall_latency) as overall_latency by email _raw | where overall_latency>300 | `zoom_high_video_latency_filter`",
    "Splunk_App_Context": "search",
    "Search_Duration": "-24h",
    "Cron Schedule": "0 * * * *",
    "Schedule Window": "5",
    "Schedule Priority": "default",
    "Trigger Condition": "Number of results is greater than 0",
    "Throttling": {
      "enabled": 1,
      "fields": "email",
      "period": "1h"
    },
    "Risk": [
      {
        "risk_object_field": "email",
        "risk_object_type": "user",
        "risk_score": 39
      }
    ],
    "Notable Title": "Zoom High Video Latency Detected for $email$",
    "Notable Description": "Suspicious latency from $email$ in Zoom activity.",
    "Security Domain": "identity",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on Identity",
    "Drilldown Search (Legacy)": "`zoom_index` payload.object.participant.email=\"$email$\" | table _time payload.object.participant.email payload.object.participant.qos{}.details.latency",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1078"
    ],
    "Drilldown Name 1": "View the detection results for - \"$email$\"",
    "Drilldown Search 1": "%original_detection_search% | search  payload.object.participant.email = \"$email$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for - \"$email$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$email$\") starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "application_zoom_high_video_latency.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "application_zoom_rare_audio_devices.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "Detects rare audio devices from Zoom logs. Actors performing Remote Employment Fraud (REF) typically use unusual device information compared to a majority of employees. Detecting this activity requires careful analysis, regular review, and a thorough understanding of the audio and video devices commonly used within your environment.",
    "Assumptions": "Assumptions:\n- Zoom logs are being ingested using Splunk Connect for Zoom\n- Most employees use standard corporate-issued or common consumer devices\n- Rare devices may indicate unauthorized remote access or fraud\n\nPotential Impact:\n- Remote Employment Fraud detection\n- Identification of unauthorized device usage\n- Anomalous equipment pattern detection",
    "origin": "custom",
    "Detection Name": "Zoom Rare Audio Devices",
    "Objective": "Identify rare audio devices in Zoom logs that may indicate Remote Employment Fraud or unauthorized device usage.",
    "Severity/Priority": "Low",
    "Analyst Next Steps": "1. Review the specific rare device identified\n2. Compare against baseline of common devices in your environment\n3. Check if device is associated with a known employee\n4. Look for other Remote Employment Fraud indicators\n5. Build a complete picture with other anomaly detections",
    "Blind_Spots_False_Positives": "Blind Spots:\n- New devices not yet baselined\n- Legitimate rare devices for specialized roles\n- Device name spoofing\n\nFalse Positives:\n- This is a hunting query meant to identify rare audio devices.",
    "Required_Data_Sources": "Zoom Logs via Splunk Connect for Zoom",
    "First Created": "2025-06-02T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "`zoom_index` speaker=* NOT (camera=*iPhone* OR camera=\"*FaceTime*\" OR speaker=\"*AirPods*\" OR camera=\"*MacBook*\" OR microphone=\"*MacBook Pro Microphone*\") | rare speaker limit=50 | `zoom_rare_audio_devices_filter`",
    "Splunk_App_Context": "search",
    "Search_Duration": "-24h",
    "Cron Schedule": "0 8 * * *",
    "Schedule Window": "5",
    "Schedule Priority": "default",
    "Trigger Condition": "Number of results is greater than 0",
    "Throttling": {
      "enabled": 0,
      "fields": "",
      "period": ""
    },
    "Risk": [
      {
        "risk_object_field": "speaker",
        "risk_object_type": "other",
        "risk_score": 25
      }
    ],
    "Notable Title": "Zoom Rare Audio Device Detected",
    "Notable Description": "A rare audio device was detected in Zoom logs that may indicate Remote Employment Fraud or unauthorized device usage.",
    "Security Domain": "identity",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on Identity",
    "Drilldown Search (Legacy)": "`zoom_index` speaker=* | stats count by speaker | sort -count",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1123"
    ],
    "Drilldown Name 1": "",
    "Drilldown Search 1": "",
    "Drilldown Earliest 1": null,
    "Drilldown Latest 1": null,
    "Drilldown Name 2": "",
    "Drilldown Search 2": "",
    "Drilldown Earliest 2": null,
    "Drilldown Latest 2": null,
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "application_zoom_rare_audio_devices.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "T1098_003_azure_ad_admin_consent_bypassed_by_service_principal.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "The following analytic identifies instances where a service principal in Azure Active Directory assigns app roles without standard admin consent. It uses Entra ID logs from the `azure_monitor_aad` data source, focusing on the \"Add app role assignment to service principal\" operation. This detection is significant as it highlights potential bypasses of critical administrative consent processes, which could lead to unauthorized privileges being granted. If confirmed malicious, this activity could allow attackers to exploit automation to assign sensitive permissions without proper oversight, potentially compromising the security of the Azure AD environment.",
    "Assumptions": "Assumptions:\n- Azure AD audit logs are being ingested via EventHub\n- Splunk Add-on for Microsoft Cloud Services is installed\n- Service principals are configured in the environment\n\nPotential Impact:\n- Unauthorized privilege escalation via service principals\n- Bypass of administrative consent processes\n- Compromised Azure AD security posture",
    "origin": "custom",
    "Detection Name": "Azure AD Admin Consent Bypassed by Service Principal",
    "Objective": "Detect and alert when service principals assign app roles without going through standard admin consent workflows, which may indicate privilege escalation attempts.",
    "Severity/Priority": "Medium",
    "Analyst Next Steps": "1. Identify the service principal (src_user) that performed the role assignment\n2. Review the permissions granted (roleValue, roleDescription)\n3. Verify if this service principal should have the ability to assign roles\n4. Check if the target user legitimately needs these permissions\n5. Review the service principal's activity history for suspicious patterns",
    "Blind_Spots_False_Positives": "Blind Spots:\n- Role assignments made through methods not captured in audit logs\n- Service principals with legitimate automation needs\n\nFalse Positives:\n- Service Principals are sometimes configured to legitimately bypass the consent process for purposes of automation. Filter as needed.",
    "Required_Data_Sources": "Azure Active Directory AuditLogs",
    "First Created": "2025-05-02T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "`azure_monitor_aad` (operationName=\"Add app role assignment to service principal\" OR operationName=\"Add member to role*\") src_user_type=servicePrincipal | rename properties.* as * | eval roleId = mvindex('targetResources{}.modifiedProperties{}.newValue',0) | eval roleValue = mvindex('targetResources{}.modifiedProperties{}.newValue',1) | eval roleDescription = mvindex('targetResources{}.modifiedProperties{}.newValue',2) | eval user_id = mvindex('targetResources{}.id', 0), user=coalesce(user,mvindex('targetResources{}.displayName',0)) | rename initiatedBy.app.displayName as src_user, userAgent as user_agent | fillnull | stats count min(_time) as firstTime max(_time) as lastTime by dest user src vendor_account vendor_product src_user user_id roleId roleValue roleDescription user_agent signature | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `azure_ad_admin_consent_bypassed_by_service_principal_filter`",
    "Splunk_App_Context": "search",
    "Search_Duration": "-15m",
    "Cron Schedule": "*/15 * * * *",
    "Schedule Window": "5",
    "Schedule Priority": "default",
    "Trigger Condition": "Number of results is greater than 0",
    "Throttling": {
      "enabled": 1,
      "fields": "user,src_user",
      "period": "1h"
    },
    "Risk": [
      {
        "risk_object_field": "user",
        "risk_object_type": "user",
        "risk_score": 54
      },
      {
        "risk_object_field": "src_user",
        "risk_object_type": "user",
        "risk_score": 54
      }
    ],
    "Notable Title": "Azure AD Admin Consent Bypassed by Service Principal $src_user$",
    "Notable Description": "Service principal $src_user$ bypassed the admin consent process and granted permissions to $user$",
    "Security Domain": "identity",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on Identity",
    "Drilldown Search (Legacy)": "`azure_monitor_aad` operationName=\"Add app role assignment to service principal\" dest=\"$dest$\" | table _time src_user user roleValue roleDescription",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1098.003"
    ],
    "Drilldown Name 1": "View the detection results for - \"$dest$\"",
    "Drilldown Search 1": "%original_detection_search% | search  dest = \"$dest$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for - \"$dest$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$dest$\") starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "T1098_003_azure_ad_admin_consent_bypassed_by_service_principal.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "T1098_003_azure_ad_application_administrator_role_assigned.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "The following analytic identifies the assignment of the Application Administrator role to an Azure AD user. It leverages Azure Active Directory events, specifically monitoring the \"Add member to role\" operation. This activity is significant because users in this role can manage all aspects of enterprise applications, including credentials, which can be used to impersonate application identities. If confirmed malicious, an attacker could escalate privileges, manage application settings, and potentially access sensitive resources by impersonating application identities, posing a significant security risk to the Azure AD tenant.",
    "Assumptions": "Assumptions:\n- Azure AD audit logs are being ingested via EventHub\n- Splunk Add-on for Microsoft Cloud Services is installed\n- Role assignments are being logged\n\nPotential Impact:\n- Privilege escalation to Application Administrator role\n- Ability to manage application credentials\n- Potential impersonation of application identities",
    "origin": "custom",
    "Detection Name": "Azure AD Application Administrator Role Assigned",
    "Objective": "Detect and alert when the Application Administrator role is assigned to a user, which grants significant privileges over enterprise applications.",
    "Severity/Priority": "Medium",
    "Analyst Next Steps": "1. Identify who initiated the role assignment (initiatedBy)\n2. Verify if the role assignment was authorized\n3. Review the user receiving the role for legitimacy\n4. Check for any subsequent suspicious activity by the new Application Administrator\n5. Review application changes made after the role assignment",
    "Blind_Spots_False_Positives": "Blind Spots:\n- Role assignments made through methods not captured in audit logs\n- Nested group memberships that inherit the role\n\nFalse Positives:\n- Administrators may legitimately assign the Application Administrator role to a user. Filter as needed.",
    "Required_Data_Sources": "Azure Active Directory AuditLogs",
    "First Created": "2025-10-14T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "`azure_monitor_aad`  operationName=\"Add member to role\"  \"properties.targetResources{}.modifiedProperties{}.newValue\"=\"*Application Administrator*\" | rename properties.* as * | rename initiatedBy.user.userPrincipalName as initiatedBy, userAgent as user_agent | fillnull | stats count min(_time) as firstTime max(_time) as lastTime by dest user src vendor_account vendor_product initiatedBy user_agent signature | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `azure_ad_application_administrator_role_assigned_filter`",
    "Splunk_App_Context": "search",
    "Search_Duration": "-15m",
    "Cron Schedule": "*/15 * * * *",
    "Schedule Window": "5",
    "Schedule Priority": "default",
    "Trigger Condition": "Number of results is greater than 0",
    "Throttling": {
      "enabled": 1,
      "fields": "user",
      "period": "1h"
    },
    "Risk": [
      {
        "risk_object_field": "user",
        "risk_object_type": "user",
        "risk_score": 35
      }
    ],
    "Notable Title": "Azure AD Application Administrator Role Assigned to $user$",
    "Notable Description": "The privileged Azure AD role Application Administrator was assigned for User $user$ initiated by $initiatedBy$",
    "Security Domain": "endpoint",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on Endpoint",
    "Drilldown Search (Legacy)": "`azure_monitor_aad` operationName=\"Add member to role\" user=\"$user$\" | table _time user initiatedBy signature",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1098.003"
    ],
    "Drilldown Name 1": "View the detection results for - \"$user$\"",
    "Drilldown Search 1": "%original_detection_search% | search  user = \"$user$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for - \"$user$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$user$\") starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "T1098_003_azure_ad_application_administrator_role_assigned.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "T1078_004_azure_ad_authentication_failed_during_mfa_challenge.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "The following analytic identifies failed authentication attempts against an Azure AD tenant during the Multi-Factor Authentication (MFA) challenge, specifically flagged by error code 500121. It leverages Azure AD SignInLogs to detect these events. This activity is significant as it may indicate an adversary attempting to authenticate using compromised credentials on an account with MFA enabled. If confirmed malicious, this could suggest an ongoing effort to bypass MFA protections, potentially leading to unauthorized access and further compromise of the affected account.",
    "Assumptions": "Assumptions:\n- Azure AD SignInLogs are being ingested via EventHub\n- Splunk Add-on for Microsoft Cloud Services is installed\n- MFA is enabled for users in the environment\n\nPotential Impact:\n- Compromised credentials being used against MFA-protected accounts\n- Potential MFA fatigue attacks\n- Unauthorized access attempts",
    "origin": "custom",
    "Detection Name": "Azure AD Authentication Failed During MFA Challenge",
    "Objective": "Detect and alert on failed MFA authentication attempts which may indicate credential compromise or MFA bypass attempts.",
    "Severity/Priority": "Medium",
    "Analyst Next Steps": "1. Review the authentication methods attempted by the user\n2. Check the source IP for known malicious activity\n3. Contact the user to verify if they initiated the sign-in attempt\n4. Review for any successful authentications from the same source\n5. Consider blocking the source IP if malicious activity is confirmed",
    "Blind_Spots_False_Positives": "Blind Spots:\n- MFA failures not captured in SignInLogs\n- Authentication attempts through federated identity providers\n\nFalse Positives:\n- False positives have been minimized by removing attempts that result in 'MFA successfully completed messages', which were found to be generated when a user opts to use a different MFA method than the default. Further reductions in finding events can be achieved through filtering 'MFA denied; duplicate authentication attempt' messages within the auth_msg field, as they could arguably be considered as false positives.",
    "Required_Data_Sources": "Azure Active Directory SignInLogs",
    "First Created": "2025-05-02T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "`azure_monitor_aad` category=SignInLogs properties.status.errorCode=500121 | rename properties.* as *, authenticationDetails{}.* as * | eval time=strptime(authenticationStepDateTime,\"%Y-%m-%dT%H:%M:%S\") | eval auth_detail=mvzip(strftime(time, \"%Y-%m-%dT%H:%M:%S\"),authenticationStepResultDetail,\" - \"), auth_msg=mvappend('status.additionalDetails', authenticationStepResultDetail) | eval auth_method=mvmap(authenticationMethod, if(isnull(mvfind('mfaDetail.authMethod',authenticationMethod)), authenticationMethod, null())) | search NOT auth_msg=\"MFA successfully completed\" | rename userAgent as user_agent | fillnull | stats count min(_time) as firstTime max(_time) as lastTime by dest user src vendor_account vendor_product auth_method auth_msg user_agent signature | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `azure_ad_authentication_failed_during_mfa_challenge_filter`",
    "Splunk_App_Context": "search",
    "Search_Duration": "-15m",
    "Cron Schedule": "*/15 * * * *",
    "Schedule Window": "5",
    "Schedule Priority": "default",
    "Trigger Condition": "Number of results is greater than 0",
    "Throttling": {
      "enabled": 1,
      "fields": "user",
      "period": "1h"
    },
    "Risk": [
      {
        "risk_object_field": "user",
        "risk_object_type": "user",
        "risk_score": 54
      }
    ],
    "Notable Title": "Azure AD Authentication Failed During MFA Challenge for $user$",
    "Notable Description": "User $user$ failed to pass MFA challenge",
    "Security Domain": "identity",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on Identity",
    "Drilldown Search (Legacy)": "`azure_monitor_aad` category=SignInLogs user=\"$user$\" | table _time user src auth_method auth_msg",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1078.004",
      "T1586.003",
      "T1621"
    ],
    "Drilldown Name 1": "View the detection results for - \"$user$\"",
    "Drilldown Search 1": "%original_detection_search% | search  user = \"$user$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for - \"$user$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$user$\") starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "T1078_004_azure_ad_authentication_failed_during_mfa_challenge.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "T1087_004_azure_ad_azurehound_useragent_detected.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "This detection identifies the presence of the default AzureHound user-agent string within Microsoft Graph Activity logs and NonInteractive SignIn Logs. AzureHound is a tool used for gathering information about Azure Active Directory environments, often employed by security professionals for legitimate auditing purposes. However, it can also be leveraged by malicious actors to perform reconnaissance activities, mapping out the Azure AD infrastructure to identify potential vulnerabilities and targets for further exploitation. Detecting its usage can help in identifying unauthorized access attempts and preemptively mitigating potential security threats to your Azure environment.",
    "Assumptions": "Assumptions:\n- MicrosoftGraphActivityLogs and NonInteractiveUserSignInLogs are being ingested via EventHub\n- Splunk Add-on for Microsoft Cloud Services is installed\n- User-agent strings are being captured in logs\n\nPotential Impact:\n- Reconnaissance activity mapping Azure AD infrastructure\n- Enumeration of users, groups, and roles\n- Identification of attack paths for privilege escalation",
    "origin": "custom",
    "Detection Name": "Azure AD AzureHound UserAgent Detected",
    "Objective": "Detect and alert on the use of AzureHound tool for Azure AD reconnaissance, which may indicate unauthorized enumeration activities.",
    "Severity/Priority": "High",
    "Analyst Next Steps": "1. Identify the user account associated with the AzureHound activity\n2. Verify if the user has legitimate reasons for running security audits\n3. Check the source IP and geolocation for anomalies\n4. Review what data was accessed during the reconnaissance\n5. Determine if this is authorized security testing or malicious activity",
    "Blind_Spots_False_Positives": "Blind Spots:\n- Custom user-agent strings used by modified versions of AzureHound\n- Other reconnaissance tools with different user-agent signatures\n\nFalse Positives:\n- None known. AzureHound usage should be verified with security teams.",
    "Required_Data_Sources": "Azure Active Directory MicrosoftGraphActivityLogs and NonInteractiveUserSignInLogs",
    "First Created": "2025-05-02T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "`azure_monitor_aad` category IN (MicrosoftGraphActivityLogs, NonInteractiveUserSignInLogs) properties.userAgent=azurehound* | rename properties.userAgent as user_agent | fillnull | stats count min(_time) as firstTime max(_time) as lastTime by dest user src vendor_account vendor_product user_agent signature | iplocation src | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `azure_ad_azurehound_useragent_detected_filter`",
    "Splunk_App_Context": "search",
    "Search_Duration": "-15m",
    "Cron Schedule": "*/15 * * * *",
    "Schedule Window": "5",
    "Schedule Priority": "default",
    "Trigger Condition": "Number of results is greater than 0",
    "Throttling": {
      "enabled": 1,
      "fields": "user",
      "period": "1h"
    },
    "Risk": [
      {
        "risk_object_field": "user",
        "risk_object_type": "user",
        "risk_score": 80
      }
    ],
    "Notable Title": "AzureHound Reconnaissance Tool Detected on $dest$",
    "Notable Description": "AzureHound UserAgent String $user_agent$ Detected on Tenant $dest$",
    "Security Domain": "identity",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on Identity",
    "Drilldown Search (Legacy)": "`azure_monitor_aad` category IN (MicrosoftGraphActivityLogs, NonInteractiveUserSignInLogs) user=\"$user$\" | table _time user src user_agent",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1087.004",
      "T1526"
    ],
    "Drilldown Name 1": "View the detection results for - \"$user$\"",
    "Drilldown Search 1": "%original_detection_search% | search  user = \"$user$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for - \"$user$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$user$\") starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "T1087_004_azure_ad_azurehound_useragent_detected.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "T1562_azure_ad_block_user_consent_for_risky_apps_disabled.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "The following analytic detects when the risk-based step-up consent security setting in Azure AD is disabled. It monitors Azure Active Directory logs for the \"Update authorization policy\" operation, specifically changes to the \"AllowUserConsentForRiskyApps\" setting. This activity is significant because disabling this feature can expose the organization to OAuth phishing threats by allowing users to grant consent to potentially malicious applications. If confirmed malicious, attackers could gain unauthorized access to user data and sensitive information, leading to data breaches and further compromise within the organization.",
    "Assumptions": "Assumptions:\n- Azure AD AuditLogs are being ingested via EventHub\n- Splunk Add-on for Microsoft Cloud Services is installed\n- Authorization policy changes are being logged\n\nPotential Impact:\n- Exposure to OAuth phishing attacks\n- Users able to consent to risky applications\n- Potential data breaches through malicious app consent",
    "origin": "custom",
    "Detection Name": "Azure AD Block User Consent For Risky Apps Disabled",
    "Objective": "Detect and alert when the BlockUserConsentForRiskyApps setting is disabled, which increases exposure to OAuth phishing threats.",
    "Severity/Priority": "Medium",
    "Analyst Next Steps": "1. Identify who made the authorization policy change\n2. Verify if the change was authorized and documented\n3. Review any consent grants that occurred after the policy change\n4. Consider re-enabling the risk-based consent feature\n5. Check for any suspicious OAuth application consent activity",
    "Blind_Spots_False_Positives": "Blind Spots:\n- Policy changes made through methods not captured in audit logs\n- Changes at the application level rather than tenant level\n\nFalse Positives:\n- Legitimate changes to the 'risk-based step-up consent' setting by administrators, perhaps as part of a policy update or security assessment, may trigger this alert, necessitating verification of the change's intent and authorization",
    "Required_Data_Sources": "Azure Active Directory AuditLogs",
    "First Created": "2025-05-02T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "`azure_monitor_aad` operationName=\"Update authorization policy\" | rename properties.* as * | eval index_number = if(mvfind('targetResources{}.modifiedProperties{}.displayName',\"AllowUserConsentForRiskyApps\") >= 0, mvfind('targetResources{}.modifiedProperties{}.displayName',\"AllowUserConsentForRiskyApps\"), -1) | search index_number >= 0 | eval AllowUserConsentForRiskyApps = mvindex('targetResources{}.modifiedProperties{}.newValue',index_number) | search AllowUserConsentForRiskyApps = \"[true]\" | rename userAgent as user_agent | fillnull | stats count min(_time) as firstTime max(_time) as lastTime by dest user src vendor_account vendor_product user_agent signature | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `azure_ad_block_user_consent_for_risky_apps_disabled_filter`",
    "Splunk_App_Context": "search",
    "Search_Duration": "-15m",
    "Cron Schedule": "*/15 * * * *",
    "Schedule Window": "5",
    "Schedule Priority": "default",
    "Trigger Condition": "Number of results is greater than 0",
    "Throttling": {
      "enabled": 1,
      "fields": "user",
      "period": "1h"
    },
    "Risk": [
      {
        "risk_object_field": "user",
        "risk_object_type": "user",
        "risk_score": 30
      }
    ],
    "Notable Title": "Azure AD Block User Consent For Risky Apps Disabled by $user$",
    "Notable Description": "User $user$ disabled the BlockUserConsentForRiskyApps Azure AD setting.",
    "Security Domain": "identity",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on Identity",
    "Drilldown Search (Legacy)": "`azure_monitor_aad` operationName=\"Update authorization policy\" user=\"$user$\" | table _time user dest signature",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1562"
    ],
    "Drilldown Name 1": "View the detection results for - \"$user$\"",
    "Drilldown Search 1": "%original_detection_search% | search  user = \"$user$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for - \"$user$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$user$\") starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "T1562_azure_ad_block_user_consent_for_risky_apps_disabled.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "T1185_azure_ad_concurrent_sessions_from_different_ips.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "The following analytic detects an Azure AD account with concurrent sessions originating from multiple unique IP addresses within a 5-minute window. It leverages Azure Active Directory NonInteractiveUserSignInLogs to identify this behavior by analyzing successful authentication events and counting distinct source IPs. This activity is significant as it may indicate session hijacking, where an attacker uses stolen session cookies to access corporate resources from a different location. If confirmed malicious, this could lead to unauthorized access to sensitive information and potential data breaches.",
    "Assumptions": "Assumptions:\n- Azure AD NonInteractiveUserSignInLogs are being ingested via EventHub\n- Splunk Add-on for Microsoft Cloud Services is installed\n- Users typically authenticate from a single IP at a time\n\nPotential Impact:\n- Session hijacking and token theft\n- Unauthorized access from multiple locations\n- Potential data breaches and account compromise",
    "origin": "custom",
    "Detection Name": "Azure AD Concurrent Sessions From Different Ips",
    "Objective": "Detect and alert on users with concurrent sessions from multiple IP addresses, which may indicate session hijacking or credential theft.",
    "Severity/Priority": "Medium",
    "Analyst Next Steps": "1. Review the source IPs associated with the concurrent sessions\n2. Check geolocation of the IPs for impossible travel scenarios\n3. Verify with the user if they are using multiple devices or VPNs\n4. Look for signs of token theft or session hijacking\n5. Consider revoking active sessions if malicious activity is confirmed",
    "Blind_Spots_False_Positives": "Blind Spots:\n- Sessions not captured in NonInteractiveUserSignInLogs\n- VPN or proxy usage that masks true IP addresses\n\nFalse Positives:\n- A user with concurrent sessions from different IPs may also represent the legitimate use of more than one device. Filter as needed and/or customize the threshold to fit your environment. Also consider the geographic location of the IP addresses and filter out IP space that belong to your organization.",
    "Required_Data_Sources": "Azure Active Directory NonInteractiveUserSignInLogs",
    "First Created": "2025-10-14T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "`azure_monitor_aad` properties.authenticationDetails{}.succeeded=true category=NonInteractiveUserSignInLogs action=success | rename properties.* as * | bucket span=5m _time | rename userAgent as user_agent | fillnull | stats count min(_time) as firstTime max(_time) as lastTime dc(src) as unique_ips values(dest) as dest values(src) as src values(user_agent) as user_agent by user _time vendor_account vendor_product category | where unique_ips > 1 | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `azure_ad_concurrent_sessions_from_different_ips_filter`",
    "Splunk_App_Context": "search",
    "Search_Duration": "-15m",
    "Cron Schedule": "*/15 * * * *",
    "Schedule Window": "5",
    "Schedule Priority": "default",
    "Trigger Condition": "Number of results is greater than 0",
    "Throttling": {
      "enabled": 1,
      "fields": "user",
      "period": "1h"
    },
    "Risk": [
      {
        "risk_object_field": "user",
        "risk_object_type": "user",
        "risk_score": 42
      }
    ],
    "Notable Title": "Azure AD Concurrent Sessions from Different IPs Detected for $user$",
    "Notable Description": "User $user$ has concurrent sessions from more than one unique IP address in the span of 5 minutes.",
    "Security Domain": "threat",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on Threat",
    "Drilldown Search (Legacy)": "`azure_monitor_aad` category=NonInteractiveUserSignInLogs user=\"$user$\" | table _time user src dest user_agent",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1185"
    ],
    "Drilldown Name 1": "View the detection results for - \"$user$\"",
    "Drilldown Search 1": "%original_detection_search% | search  user = \"$user$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for - \"$user$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$user$\") starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "T1185_azure_ad_concurrent_sessions_from_different_ips.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "T1528_azure_ad_device_code_authentication.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "The following analytic identifies Azure Device Code Phishing attacks, which can lead to Azure Account Take-Over (ATO). It leverages Azure AD SignInLogs to detect suspicious authentication requests using the device code authentication protocol. This activity is significant as it indicates potential bypassing of Multi-Factor Authentication (MFA) and Conditional Access Policies (CAPs) through phishing emails. If confirmed malicious, attackers could gain unauthorized access to Azure AD, Exchange mailboxes, and Outlook Web Application (OWA), leading to potential data breaches and unauthorized data access.",
    "Assumptions": "Assumptions:\n- Azure AD SignInLogs are being ingested via EventHub\n- Splunk Add-on for Microsoft Cloud Services is installed\n- Device code authentication protocol is being used legitimately in some cases\n\nPotential Impact:\n- Account takeover via device code phishing\n- Bypass of MFA and Conditional Access Policies\n- Unauthorized access to Azure AD and Exchange",
    "origin": "custom",
    "Detection Name": "Azure AD Device Code Authentication",
    "Objective": "Detect and alert on device code authentication attempts which may indicate phishing attacks targeting Azure AD accounts.",
    "Severity/Priority": "Medium",
    "Analyst Next Steps": "1. Verify if the user initiated the device code authentication\n2. Check the source IP and user agent for anomalies\n3. Review if the user received any suspicious emails\n4. Determine if the authentication was successful and what was accessed\n5. Consider blocking device code authentication if not needed",
    "Blind_Spots_False_Positives": "Blind Spots:\n- Device code authentication through methods not captured in SignInLogs\n- Phishing attacks using different authentication protocols\n\nFalse Positives:\n- In most organizations, device code authentication will be used to access common Microsoft service but it may be legitimate for others. Filter as needed.",
    "Required_Data_Sources": "Azure Active Directory SignInLogs",
    "First Created": "2025-05-02T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "`azure_monitor_aad` category=SignInLogs \"properties.authenticationProtocol\"=deviceCode | rename properties.* as * | rename userAgent as user_agent | fillnull | stats count min(_time) as firstTime max(_time) as lastTime by dest user src vendor_account vendor_product user_agent category | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `azure_ad_device_code_authentication_filter`",
    "Splunk_App_Context": "search",
    "Search_Duration": "-15m",
    "Cron Schedule": "*/15 * * * *",
    "Schedule Window": "5",
    "Schedule Priority": "default",
    "Trigger Condition": "Number of results is greater than 0",
    "Throttling": {
      "enabled": 1,
      "fields": "user",
      "period": "1h"
    },
    "Risk": [
      {
        "risk_object_field": "user",
        "risk_object_type": "user",
        "risk_score": 35
      }
    ],
    "Notable Title": "Azure AD Device Code Authentication Detected for $user$",
    "Notable Description": "Device code requested for $user$ from $src$",
    "Security Domain": "identity",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on Identity",
    "Drilldown Search (Legacy)": "`azure_monitor_aad` category=SignInLogs user=\"$user$\" | table _time user src dest user_agent category",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1528",
      "T1566.002"
    ],
    "Drilldown Name 1": "View the detection results for - \"$user$\"",
    "Drilldown Search 1": "%original_detection_search% | search  user = \"$user$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for - \"$user$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$user$\") starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "T1528_azure_ad_device_code_authentication.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "T1136_003_azure_ad_external_guest_user_invited.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "The following analytic detects the invitation of an external guest user within Azure AD. It leverages Azure AD AuditLogs to identify events where an external user is invited, using fields such as operationName and initiatedBy. Monitoring these invitations is crucial as they can lead to unauthorized access if abused. If confirmed malicious, this activity could allow attackers to gain access to internal resources, potentially leading to data breaches or further exploitation of the environment.",
    "Assumptions": "Assumptions:\n- Azure AD AuditLogs are being ingested via EventHub\n- Splunk Add-on for Microsoft Cloud Services is installed\n- External guest invitations are being logged\n\nPotential Impact:\n- Unauthorized external access to internal resources\n- Data exfiltration through guest accounts\n- Persistence through external identities",
    "origin": "custom",
    "Detection Name": "Azure AD External Guest User Invited",
    "Objective": "Detect and alert on external guest user invitations which may indicate unauthorized access being granted to external parties.",
    "Severity/Priority": "Medium",
    "Analyst Next Steps": "1. Identify who initiated the guest invitation (initiatedBy)\n2. Verify if the invitation was authorized and documented\n3. Review the external user's email domain for legitimacy\n4. Check if the guest user has accessed any resources\n5. Monitor for suspicious activity from the guest account",
    "Blind_Spots_False_Positives": "Blind Spots:\n- Guest invitations made through methods not captured in audit logs\n- B2B collaboration invitations through partner organizations\n\nFalse Positives:\n- Administrator may legitimately invite external guest users. Filter as needed.",
    "Required_Data_Sources": "Azure Active Directory AuditLogs",
    "First Created": "2025-05-02T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "`azure_monitor_aad` operationName=\"Invite external user\" | rename properties.* as * | rename initiatedBy.user.userPrincipalName as initiatedBy | rename targetResources{}.type as type | rename userAgent as user_agent | fillnull | stats count min(_time) as firstTime max(_time) as lastTime by dest user src vendor_account vendor_product user_agent initiatedBy type signature | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `azure_ad_external_guest_user_invited_filter`",
    "Splunk_App_Context": "search",
    "Search_Duration": "-15m",
    "Cron Schedule": "*/15 * * * *",
    "Schedule Window": "5",
    "Schedule Priority": "default",
    "Trigger Condition": "Number of results is greater than 0",
    "Throttling": {
      "enabled": 1,
      "fields": "user,initiatedBy",
      "period": "1h"
    },
    "Risk": [
      {
        "risk_object_field": "user",
        "risk_object_type": "user",
        "risk_score": 45
      },
      {
        "risk_object_field": "initiatedBy",
        "risk_object_type": "user",
        "risk_score": 45
      }
    ],
    "Notable Title": "Azure AD External Guest User Invited: $user$",
    "Notable Description": "External Guest User $user$ initiated by $initiatedBy$",
    "Security Domain": "threat",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on Threat",
    "Drilldown Search (Legacy)": "`azure_monitor_aad` operationName=\"Invite external user\" user=\"$user$\" | table _time user initiatedBy type signature",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1136.003"
    ],
    "Drilldown Name 1": "View the detection results for - \"$user$\"",
    "Drilldown Search 1": "%original_detection_search% | search  user = \"$user$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for - \"$user$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$user$\") starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "T1136_003_azure_ad_external_guest_user_invited.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "T1098_002_azure_ad_fullaccessasapp_permission_assigned.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "The following analytic detects the assignment of the 'full_access_as_app' permission to an application within Office 365 Exchange Online. This is identified by the GUID 'dc890d15-9560-4a4c-9b7f-a736ec74ec40' and the ResourceAppId '00000002-0000-0ff1-ce00-000000000000'. The detection leverages the azure_monitor_aad data source, focusing on AuditLogs with the operation name 'Update application'. This activity is significant as it grants broad control over Office 365 operations, including full access to all mailboxes and the ability to send emails as any user. If malicious, this could lead to unauthorized access and data exfiltration.",
    "Assumptions": "Assumptions:\n- Azure AD AuditLogs are being ingested via EventHub\n- Splunk Add-on for Microsoft Cloud Services is installed\n- Application permission changes are being logged\n\nPotential Impact:\n- Full access to all Exchange Online mailboxes\n- Ability to send email as any user\n- Mass data exfiltration potential",
    "origin": "custom",
    "Detection Name": "Azure AD FullAccessAsApp Permission Assigned",
    "Objective": "Detect and alert when the full_access_as_app permission is assigned to an application, which grants extensive access to Exchange Online.",
    "Severity/Priority": "High",
    "Analyst Next Steps": "1. Identify who assigned the permission and to which application\n2. Verify if the permission assignment was authorized\n3. Review the application's purpose and legitimacy\n4. Check for any mailbox access or email sending activity by the application\n5. Consider removing the permission if unauthorized",
    "Blind_Spots_False_Positives": "Blind Spots:\n- Permission assignments made through methods not captured in audit logs\n- Permissions assigned through delegated admin relationships\n\nFalse Positives:\n- The full_access_as_app API permission may be assigned to legitimate applications. Filter as needed.",
    "Required_Data_Sources": "Azure Active Directory AuditLogs",
    "First Created": "2025-05-02T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "`azure_monitor_aad` category=AuditLogs operationName=\"Update application\" | eval newvalue = mvindex('properties.targetResources{}.modifiedProperties{}.newValue',0) | spath input=newvalue | search \"{}.ResourceAppId\"=\"00000002-0000-0ff1-ce00-000000000000\" \"{}.RequiredAppPermissions{}.EntitlementId\"=\"dc890d15-9560-4a4c-9b7f-a736ec74ec40\" | eval Permissions = '{}.RequiredAppPermissions{}.EntitlementId' | rename properties.userAgent as user_agent | fillnull | stats count min(_time) as firstTime max(_time) as lastTime by dest user src vendor_account vendor_product user_agent Permissions object signature | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `azure_ad_fullaccessasapp_permission_assigned_filter`",
    "Splunk_App_Context": "search",
    "Search_Duration": "-15m",
    "Cron Schedule": "*/15 * * * *",
    "Schedule Window": "5",
    "Schedule Priority": "default",
    "Trigger Condition": "Number of results is greater than 0",
    "Throttling": {
      "enabled": 1,
      "fields": "user,object",
      "period": "1h"
    },
    "Risk": [
      {
        "risk_object_field": "user",
        "risk_object_type": "user",
        "risk_score": 48
      }
    ],
    "Notable Title": "Azure AD FullAccessAsApp Permission Assigned to $object$",
    "Notable Description": "User $user$ assigned the full_access_as_app permission to the app registration $object$",
    "Security Domain": "threat",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on Threat",
    "Drilldown Search (Legacy)": "`azure_monitor_aad` category=AuditLogs operationName=\"Update application\" user=\"$user$\" | table _time user object Permissions signature",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1098.002",
      "T1098.003"
    ],
    "Drilldown Name 1": "View the detection results for - \"$user$\"",
    "Drilldown Search 1": "%original_detection_search% | search  user = \"$user$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for - \"$user$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$user$\") starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "T1098_002_azure_ad_fullaccessasapp_permission_assigned.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "T1560_001_7zip_commandline_to_smb_share_path.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "The following analytic detects the execution of 7z or 7za processes with command lines pointing to SMB network shares. It leverages data from Endpoint Detection and Response (EDR) agents, focusing on process names and command-line arguments. This activity is significant as it may indicate an attempt to archive and exfiltrate sensitive files to a network share, a technique observed in CONTI LEAK tools. If confirmed malicious, this behavior could lead to data exfiltration, compromising sensitive information and potentially aiding further attacks.",
    "Assumptions": "Assumptions:\n- The detection is based on data that originates from Endpoint Detection and Response (EDR) agents\n- Target processes (7z.exe, 7za.exe, 7zr.exe) are being monitored\n- EDR data is properly configured and ingesting into Splunk\n\nPotential Impact:\n- Data exfiltration via network shares\n- Sensitive file archiving for unauthorized transfer\n- Ransomware staging activities",
    "origin": "custom",
    "Detection Name": "7zip CommandLine To SMB Share Path",
    "Objective": "Detect and alert on 7zip execution with command lines pointing to SMB network shares, which may indicate data exfiltration or staging for ransomware attacks.",
    "Severity/Priority": "Medium",
    "Analyst Next Steps": "1. Identify the user and endpoint executing the 7zip command\n2. Review the full command line to understand what files are being archived\n3. Check the destination SMB share path for legitimacy\n4. Review recent file access patterns on the endpoint\n5. Investigate if this is part of a larger data exfiltration campaign",
    "Blind_Spots_False_Positives": "Blind Spots:\n- 7zip executions using renamed binaries\n- Archive operations using other compression tools\n- Cloud-based file transfers not using SMB\n\nFalse Positives:\n- Legitimate backup operations using 7zip to network shares\n- IT administration activities\n- Authorized data migration tasks",
    "Required_Data_Sources": "Sysmon EventID 1, Windows Event Log Security 4688, CrowdStrike ProcessRollup2",
    "First Created": "2025-05-02T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where (Processes.process_name =\"7z.exe\" OR Processes.process_name = \"7za.exe\" OR Processes.process_name = \"7zr.exe\" OR Processes.original_file_name = \"7z.exe\" OR Processes.original_file_name =  \"7za.exe\" OR Processes.original_file_name =  \"7zr.exe\") AND (Processes.process=\"*\\\\C$\\\\*\" OR Processes.process=\"*\\\\Admin$\\\\*\" OR Processes.process=\"*\\\\IPC$\\\\*\") by Processes.action Processes.dest Processes.original_file_name Processes.parent_process Processes.parent_process_exec Processes.parent_process_guid Processes.parent_process_id Processes.parent_process_name Processes.parent_process_path Processes.process Processes.process_exec Processes.process_guid Processes.process_hash Processes.process_id Processes.process_integrity_level Processes.process_name Processes.process_path Processes.user Processes.user_id Processes.vendor_product | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `7zip_commandline_to_smb_share_path_filter`",
    "Splunk_App_Context": "search",
    "Search_Duration": "-15m",
    "Cron Schedule": "*/15 * * * *",
    "Schedule Window": "5",
    "Schedule Priority": "default",
    "Trigger Condition": "Number of results is greater than 0",
    "Throttling": {
      "enabled": 1,
      "fields": "dest,process_name",
      "period": "1h"
    },
    "Risk": [
      {
        "risk_object_field": "dest",
        "risk_object_type": "system",
        "risk_score": 35
      },
      {
        "risk_object_field": "user",
        "risk_object_type": "user",
        "risk_score": 35
      }
    ],
    "Notable Title": "7zip CommandLine To SMB Share Path Detected on $dest$",
    "Notable Description": "A 7zip process was detected executing with command line arguments pointing to SMB network shares on $dest$. This may indicate data exfiltration or staging for ransomware attacks.",
    "Security Domain": "endpoint",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on Endpoint",
    "Drilldown Search (Legacy)": "| tstats `security_content_summariesonly` count from datamodel=Endpoint.Processes where Processes.dest=\"$dest$\" by Processes.process_name Processes.process Processes.user | `drop_dm_object_name(Processes)`",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1560.001"
    ],
    "Drilldown Name 1": "",
    "Drilldown Search 1": "",
    "Drilldown Earliest 1": null,
    "Drilldown Latest 1": null,
    "Drilldown Name 2": "",
    "Drilldown Search 2": "",
    "Drilldown Earliest 2": null,
    "Drilldown Latest 2": null,
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "T1560_001_7zip_commandline_to_smb_share_path.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "T1003_001_access_lsass_memory_for_dump_creation.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "The following analytic detects attempts to dump the LSASS process memory, a common technique in credential dumping attacks. It leverages Sysmon logs, specifically EventCode 10, to identify suspicious call traces to dbgcore.dll and dbghelp.dll associated with lsass.exe. This activity is significant as it often precedes the theft of sensitive login credentials, posing a high risk of unauthorized access to systems and data. If confirmed malicious, attackers could gain access to critical credentials, enabling further compromise and lateral movement within the network.",
    "Assumptions": "Assumptions:\n- Sysmon is deployed with EventCode 10 monitoring enabled\n- LSASS process is properly monitored for access attempts\n- Sysmon TA is configured correctly in Splunk\n\nPotential Impact:\n- Credential theft and session hijacking\n- Unauthorized access to domain accounts\n- Lateral movement using harvested credentials",
    "origin": "custom",
    "Detection Name": "Access LSASS Memory for Dump Creation",
    "Objective": "Detect and alert on attempts to access LSASS process memory for credential dumping, which is a common technique used by adversaries to harvest credentials.",
    "Severity/Priority": "High",
    "Analyst Next Steps": "1. Identify the source process (SourceImage) attempting to access LSASS\n2. Review if the source process is a known credential dumping tool\n3. Check if the affected device has had recent suspicious activity\n4. Investigate the user account associated with the activity\n5. Look for persistence mechanisms on the affected host",
    "Blind_Spots_False_Positives": "Blind Spots:\n- LSASS access via other methods not using dbgcore.dll or dbghelp.dll\n- Memory dumps created through WMI or other techniques\n\nFalse Positives:\n- Administrators creating memory dumps for debugging purposes\n- Legitimate security tools accessing LSASS for protection",
    "Required_Data_Sources": "Sysmon EventID 10",
    "First Created": "2025-10-14T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "`sysmon` EventCode=10 TargetImage=*lsass.exe CallTrace=*dbgcore.dll* OR CallTrace=*dbghelp.dll* | stats count min(_time) as firstTime max(_time) as lastTime by CallTrace EventID GrantedAccess Guid Opcode ProcessID SecurityID SourceImage SourceProcessGUID SourceProcessId TargetImage TargetProcessGUID TargetProcessId UserID dest granted_access parent_process_exec parent_process_guid parent_process_id parent_process_name parent_process_path process_exec process_guid process_id process_name process_path signature signature_id user_id vendor_product | `security_content_ctime(firstTime)` |`security_content_ctime(lastTime)` | `access_lsass_memory_for_dump_creation_filter`",
    "Splunk_App_Context": "search",
    "Search_Duration": "-15m",
    "Cron Schedule": "*/15 * * * *",
    "Schedule Window": "5",
    "Schedule Priority": "default",
    "Trigger Condition": "Number of results is greater than 0",
    "Throttling": {
      "enabled": 1,
      "fields": "dest,SourceImage",
      "period": "1h"
    },
    "Risk": [
      {
        "risk_object_field": "dest",
        "risk_object_type": "system",
        "risk_score": 63
      }
    ],
    "Notable Title": "LSASS Memory Access Detected for Dump Creation on $dest$",
    "Notable Description": "Process $SourceImage$ injected into $TargetImage$ and was attempted to dump LSASS on $dest$. Adversaries tend to do this when trying to access credential material stored in the process memory of the Local Security Authority Subsystem Service (LSASS).",
    "Security Domain": "endpoint",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on Endpoint",
    "Drilldown Search (Legacy)": "`sysmon` EventCode=10 dest=\"$dest$\" | table _time SourceImage TargetImage CallTrace GrantedAccess",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1003.001"
    ],
    "Drilldown Name 1": "View the detection results for - \"$dest$\"",
    "Drilldown Search 1": "%original_detection_search% | search  dest = \"$dest$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for - \"$dest$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$dest$\") starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "T1003_001_access_lsass_memory_for_dump_creation.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "T1547_014_active_setup_registry_autostart.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "The following analytic detects suspicious modifications to the Active Setup registry for persistence and privilege escalation. It leverages data from the Endpoint.Registry data model, focusing on changes to the \"StubPath\" value within the \"SOFTWARE\\Microsoft\\Active Setup\\Installed Components\" path. This activity is significant as it is commonly used by malware, adware, and APTs to maintain persistence on compromised machines. If confirmed malicious, this could allow attackers to execute code upon system startup, potentially leading to further system compromise and unauthorized access.",
    "Assumptions": "Assumptions:\n- Registry monitoring is enabled via Sysmon EventID 13\n- Sysmon TA version 2.0 or higher is installed\n- Endpoint.Registry data model is properly configured\n\nPotential Impact:\n- Persistence mechanism establishment\n- Code execution on system startup\n- Privilege escalation",
    "origin": "custom",
    "Detection Name": "Active Setup Registry Autostart",
    "Objective": "Detect and alert on suspicious modifications to the Active Setup registry that may indicate persistence or privilege escalation attempts.",
    "Severity/Priority": "High",
    "Analyst Next Steps": "1. Identify the process that modified the registry entry\n2. Review the StubPath value for suspicious commands or executables\n3. Check if the modification was made by a legitimate installer\n4. Investigate the user account associated with the change\n5. Look for related persistence mechanisms on the endpoint",
    "Blind_Spots_False_Positives": "Blind Spots:\n- Registry modifications made through WMI or other indirect methods\n- Modifications to other persistence registry keys not covered\n\nFalse Positives:\n- Active setup installer may add or modify this registry\n- Legitimate software installations",
    "Required_Data_Sources": "Sysmon EventID 13",
    "First Created": "2025-05-02T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime FROM datamodel=Endpoint.Registry WHERE (Registry.registry_value_name= \"StubPath\" Registry.registry_path = \"*\\\\SOFTWARE\\\\Microsoft\\\\Active Setup\\\\Installed Components*\") by Registry.action Registry.dest Registry.process_guid Registry.process_id Registry.registry_hive Registry.registry_path Registry.registry_key_name Registry.registry_value_data Registry.registry_value_name Registry.registry_value_type Registry.status Registry.user Registry.vendor_product | `drop_dm_object_name(Registry)` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`| `active_setup_registry_autostart_filter`",
    "Splunk_App_Context": "search",
    "Search_Duration": "-15m",
    "Cron Schedule": "*/15 * * * *",
    "Schedule Window": "5",
    "Schedule Priority": "default",
    "Trigger Condition": "Number of results is greater than 0",
    "Throttling": {
      "enabled": 1,
      "fields": "dest,registry_path",
      "period": "1h"
    },
    "Risk": [
      {
        "risk_object_field": "dest",
        "risk_object_type": "system",
        "risk_score": 64
      },
      {
        "risk_object_field": "user",
        "risk_object_type": "user",
        "risk_score": 64
      }
    ],
    "Notable Title": "Active Setup Registry Autostart Modified on $dest$",
    "Notable Description": "Modified/added/deleted registry entry $registry_path$ on $dest$",
    "Security Domain": "endpoint",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on Endpoint",
    "Drilldown Search (Legacy)": "| tstats `security_content_summariesonly` count FROM datamodel=Endpoint.Registry WHERE Registry.dest=\"$dest$\" by Registry.registry_path Registry.registry_value_name Registry.registry_value_data | `drop_dm_object_name(Registry)`",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1547.014"
    ],
    "Drilldown Name 1": "View the detection results for - \"$dest$\" and \"$user$\"",
    "Drilldown Search 1": "%original_detection_search% | search  dest = \"$dest$\" user = \"$user$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for - \"$dest$\" and \"$user$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$dest$\", \"$user$\") starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "T1547_014_active_setup_registry_autostart.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "T1552_002_add_defaultuser_and_password_in_registry.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "The following analytic detects suspicious registry modifications that implement auto admin logon by adding DefaultUserName and DefaultPassword values. It leverages data from the Endpoint.Registry data model, specifically monitoring changes to the \"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\" registry path. This activity is significant because it is associated with BlackMatter ransomware, which uses this technique to automatically log on to compromised hosts and continue encryption after a safe mode boot. If confirmed malicious, this could allow attackers to maintain persistence and further encrypt the network, leading to significant data loss and operational disruption.",
    "Assumptions": "Assumptions:\n- Registry monitoring is enabled via Sysmon EventID 12 and 13\n- Sysmon TA version 2.0 or higher is installed\n- Endpoint.Registry data model is properly configured\n\nPotential Impact:\n- Automatic admin logon after reboot\n- Ransomware persistence mechanism\n- Continued encryption after safe mode boot",
    "origin": "custom",
    "Detection Name": "Add DefaultUser And Password In Registry",
    "Objective": "Detect and alert on registry modifications that add DefaultUserName and DefaultPassword values, which may indicate ransomware attempting to establish auto admin logon for persistence.",
    "Severity/Priority": "Medium",
    "Analyst Next Steps": "1. Identify the process that modified the registry entry\n2. Check if the modification is associated with known ransomware behavior\n3. Review recent malware alerts on the affected endpoint\n4. Investigate if the system was recently rebooted into safe mode\n5. Look for encryption activity on the endpoint",
    "Blind_Spots_False_Positives": "Blind Spots:\n- Registry modifications made through WMI or other indirect methods\n- Modifications to Winlogon using different techniques\n\nFalse Positives:\n- Legitimate auto-logon configurations by administrators\n- Kiosk or shared workstation configurations",
    "Required_Data_Sources": "Sysmon EventID 12, Sysmon EventID 13",
    "First Created": "2025-05-02T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime FROM datamodel=Endpoint.Registry WHERE (Registry.registry_path= \"*SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon*\" AND Registry.registry_value_name= DefaultPassword OR Registry.registry_value_name= DefaultUserName) by Registry.action Registry.dest Registry.process_guid Registry.process_id Registry.registry_hive Registry.registry_path Registry.registry_key_name Registry.registry_value_data Registry.registry_value_name Registry.registry_value_type Registry.status Registry.user Registry.vendor_product | `drop_dm_object_name(Registry)` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `add_defaultuser_and_password_in_registry_filter`",
    "Splunk_App_Context": "search",
    "Search_Duration": "-15m",
    "Cron Schedule": "*/15 * * * *",
    "Schedule Window": "5",
    "Schedule Priority": "default",
    "Trigger Condition": "Number of results is greater than 0",
    "Throttling": {
      "enabled": 1,
      "fields": "dest,registry_value_name",
      "period": "1h"
    },
    "Risk": [
      {
        "risk_object_field": "dest",
        "risk_object_type": "system",
        "risk_score": 25
      }
    ],
    "Notable Title": "DefaultUser and Password Added in Registry on $dest$",
    "Notable Description": "Modified registry key $registry_key_name$ with registry value $registry_value_name$ to prepare autoadminlogon",
    "Security Domain": "endpoint",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on Endpoint",
    "Drilldown Search (Legacy)": "| tstats `security_content_summariesonly` count FROM datamodel=Endpoint.Registry WHERE Registry.dest=\"$dest$\" Registry.registry_path=\"*Winlogon*\" by Registry.registry_path Registry.registry_value_name Registry.registry_value_data | `drop_dm_object_name(Registry)`",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1552.002"
    ],
    "Drilldown Name 1": "View the detection results for - \"$dest$\"",
    "Drilldown Search 1": "%original_detection_search% | search  dest = \"$dest$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for - \"$dest$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$dest$\") starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "T1552_002_add_defaultuser_and_password_in_registry.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "T1087_002_adsisearcher_account_discovery.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "The following analytic detects the use of the `[Adsisearcher]` type accelerator in PowerShell to query Active Directory for domain users. It leverages PowerShell Script Block Logging (EventCode=4104) to identify script blocks containing `[adsisearcher]`, `objectcategory=user`, and `.findAll()`. This activity is significant as it may indicate an attempt by adversaries or Red Teams to enumerate domain users for situational awareness and Active Directory discovery. If confirmed malicious, this could lead to further reconnaissance, privilege escalation, or lateral movement within the network.",
    "Assumptions": "Assumptions:\n- PowerShell Script Block Logging (EventCode 4104) is enabled\n- PowerShell operational logs are ingested into Splunk\n- The powershell macro is properly configured\n\nPotential Impact:\n- Domain user enumeration\n- Active Directory reconnaissance\n- Preparation for privilege escalation or lateral movement",
    "origin": "custom",
    "Detection Name": "AdsiSearcher Account Discovery",
    "Objective": "Detect and alert on the use of [Adsisearcher] type accelerator in PowerShell to query Active Directory for domain users, which may indicate reconnaissance activity.",
    "Severity/Priority": "Medium",
    "Analyst Next Steps": "1. Review the full PowerShell script block for additional context\n2. Identify the user executing the PowerShell command\n3. Determine if this is authorized administrative activity or Red Team testing\n4. Check for other reconnaissance activities from the same endpoint\n5. Investigate if the user account has been compromised",
    "Blind_Spots_False_Positives": "Blind Spots:\n- PowerShell commands executed in constrained language mode\n- AD queries using other methods (net user, dsquery, etc.)\n\nFalse Positives:\n- Administrators or power users using this command for troubleshooting\n- Legitimate IT automation scripts",
    "Required_Data_Sources": "Powershell Script Block Logging 4104",
    "First Created": "2025-10-14T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "`powershell` EventCode=4104 ScriptBlockText = \"*[adsisearcher]*\" ScriptBlockText = \"*objectcategory=user*\" ScriptBlockText = \"*.findAll()*\" | fillnull | stats count min(_time) as firstTime max(_time) as lastTime by dest signature signature_id user_id vendor_product EventID Guid Opcode Name Path ProcessID ScriptBlockId ScriptBlockText | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `adsisearcher_account_discovery_filter`",
    "Splunk_App_Context": "search",
    "Search_Duration": "-15m",
    "Cron Schedule": "*/15 * * * *",
    "Schedule Window": "5",
    "Schedule Priority": "default",
    "Trigger Condition": "Number of results is greater than 0",
    "Throttling": {
      "enabled": 1,
      "fields": "dest,user_id",
      "period": "1h"
    },
    "Risk": [
      {
        "risk_object_field": "dest",
        "risk_object_type": "system",
        "risk_score": 25
      },
      {
        "risk_object_field": "user_id",
        "risk_object_type": "user",
        "risk_score": 25
      }
    ],
    "Notable Title": "AdsiSearcher Account Discovery Detected on $dest$",
    "Notable Description": "Powershell process has been used for user enumeration on $dest$",
    "Security Domain": "endpoint",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on Endpoint",
    "Drilldown Search (Legacy)": "`powershell` EventCode=4104 dest=\"$dest$\" | table _time ScriptBlockText user_id",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1087.002"
    ],
    "Drilldown Name 1": "View the detection results for - \"$dest$\" and \"$user_id$\"",
    "Drilldown Search 1": "%original_detection_search% | search  dest = \"$dest$\" user_id = \"$user_id$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for - \"$dest$\" and \"$user_id$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$dest$\", \"$user_id$\") starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "T1087_002_adsisearcher_account_discovery.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "T1003_attacker_tools_on_endpoint.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "The following analytic detects the execution of tools commonly exploited by cybercriminals, such as those used for unauthorized access, network scanning, or data exfiltration. It leverages process activity data from Endpoint Detection and Response (EDR) agents, focusing on known attacker tool names. This activity is significant because it serves as an early warning system for potential security incidents, enabling prompt response. If confirmed malicious, this activity could lead to unauthorized access, data theft, or further network compromise, posing a severe threat to the organization's security infrastructure.",
    "Assumptions": "Assumptions:\n- EDR agents are deployed and reporting process activity\n- The attacker_tools.csv lookup is current and maintained\n- Process GUID, process name, and parent process are being ingested\n\nPotential Impact:\n- Unauthorized access to systems\n- Data exfiltration\n- Network reconnaissance and scanning\n- Credential harvesting",
    "origin": "custom",
    "Detection Name": "Attacker Tools On Endpoint",
    "Objective": "Detect and alert on the execution of known attacker tools on endpoints, which may indicate malicious activity or compromised systems.",
    "Severity/Priority": "High",
    "Analyst Next Steps": "1. Identify the tool detected and understand its capabilities\n2. Review the user and endpoint executing the tool\n3. Determine if this is authorized penetration testing or Red Team activity\n4. Check for related malicious activity on the endpoint\n5. Isolate the endpoint if malicious activity is confirmed",
    "Blind_Spots_False_Positives": "Blind Spots:\n- Attacker tools not included in the lookup table\n- Renamed or obfuscated attacker tools\n- Tools executed via memory-only techniques\n\nFalse Positives:\n- Some administrator activity can be potentially triggered\n- Authorized penetration testing or Red Team exercises",
    "Required_Data_Sources": "Sysmon EventID 1, Windows Event Log Security 4688, CrowdStrike ProcessRollup2, Cisco Network Visibility Module Flow Data",
    "First Created": "2025-07-29T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime values(Processes.process) as process values(Processes.parent_process) as parent_process from datamodel=Endpoint.Processes where [| inputlookup attacker_tools | rename attacker_tool_names AS Processes.process_name | fields Processes.process_name] AND Processes.dest!=unknown AND Processes.user!=unknown by Processes.action Processes.dest Processes.original_file_name Processes.parent_process Processes.parent_process_exec Processes.parent_process_guid Processes.parent_process_id Processes.parent_process_name Processes.parent_process_path Processes.process Processes.process_exec Processes.process_guid Processes.process_hash Processes.process_id Processes.process_integrity_level Processes.process_name Processes.process_path Processes.user Processes.user_id Processes.vendor_product | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `drop_dm_object_name(Processes)` | lookup attacker_tools attacker_tool_names AS process_name OUTPUT description | search description !=false| `attacker_tools_on_endpoint_filter`",
    "Splunk_App_Context": "search",
    "Search_Duration": "-15m",
    "Cron Schedule": "*/15 * * * *",
    "Schedule Window": "5",
    "Schedule Priority": "default",
    "Trigger Condition": "Number of results is greater than 0",
    "Throttling": {
      "enabled": 1,
      "fields": "dest,process_name,user",
      "period": "1h"
    },
    "Risk": [
      {
        "risk_object_field": "user",
        "risk_object_type": "user",
        "risk_score": 64
      },
      {
        "risk_object_field": "dest",
        "risk_object_type": "system",
        "risk_score": 64
      }
    ],
    "Notable Title": "Attacker Tool $process_name$ Detected on $dest$",
    "Notable Description": "An attacker tool $process_name$, listed in attacker_tools.csv is executed on host $dest$ by User $user$. This process $process_name$ is known to do- $description$",
    "Security Domain": "endpoint",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on Endpoint",
    "Drilldown Search (Legacy)": "| tstats `security_content_summariesonly` count from datamodel=Endpoint.Processes where Processes.dest=\"$dest$\" by Processes.process_name Processes.process Processes.user | `drop_dm_object_name(Processes)`",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1003",
      "T1036.005",
      "T1595"
    ],
    "Drilldown Name 1": "View the detection results for - \"$user$\" and \"$dest$\"",
    "Drilldown Search 1": "%original_detection_search% | search  user = \"$user$\" dest = \"$dest$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for - \"$user$\" and \"$dest$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$user$\", \"$dest$\") starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "T1003_attacker_tools_on_endpoint.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "T1553_004_attempt_to_add_certificate_to_untrusted_store.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "The following analytic detects attempts to add a certificate to the untrusted certificate store using the 'certutil -addstore' command. It leverages process activity and command-line arguments from Endpoint Detection and Response (EDR) logs mapped to the Splunk `Processes` data model. This activity is significant as it may indicate an attacker trying to disable security tools to gain unauthorized access. If confirmed malicious, this could lead to the compromise of system security, allowing attackers to bypass defenses and potentially escalate privileges or persist in the environment.",
    "Assumptions": "Assumptions:\n- EDR agents are deployed and reporting process activity\n- Process GUID, process name, and parent process are being ingested\n- Complete command-line executions are logged\n\nPotential Impact:\n- Security tool bypass\n- Certificate trust manipulation\n- Defense evasion",
    "origin": "custom",
    "Detection Name": "Attempt To Add Certificate To Untrusted Store",
    "Objective": "Detect and alert on attempts to add certificates to the untrusted certificate store using certutil, which may indicate an attacker attempting to disable security tools.",
    "Severity/Priority": "Medium",
    "Analyst Next Steps": "1. Identify the certificate being added and its purpose\n2. Review the user and endpoint executing the command\n3. Determine if this is authorized administrative activity\n4. Check if security tools have been affected\n5. Investigate the parent process for signs of compromise",
    "Blind_Spots_False_Positives": "Blind Spots:\n- Certificate manipulation using other tools or APIs\n- PowerShell-based certificate store modifications\n\nFalse Positives:\n- Legitimate administrators adding a certificate to the untrusted certificate store\n- Certificate management activities on a large number of systems",
    "Required_Data_Sources": "Sysmon EventID 1, Windows Event Log Security 4688, CrowdStrike ProcessRollup2",
    "First Created": "2025-10-06T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "| tstats `security_content_summariesonly` count min(_time) as firstTime values(Processes.process) as process max(_time) as lastTime from datamodel=Endpoint.Processes where `process_certutil` (Processes.process=*-addstore*) by Processes.action Processes.dest Processes.original_file_name Processes.parent_process Processes.parent_process_exec Processes.parent_process_guid Processes.parent_process_id Processes.parent_process_name Processes.parent_process_path Processes.process Processes.process_exec Processes.process_guid Processes.process_hash Processes.process_id Processes.process_integrity_level Processes.process_name Processes.process_path Processes.user Processes.user_id Processes.vendor_product | `drop_dm_object_name(\"Processes\")` | `security_content_ctime(firstTime)` |`security_content_ctime(lastTime)` | `attempt_to_add_certificate_to_untrusted_store_filter`",
    "Splunk_App_Context": "search",
    "Search_Duration": "-15m",
    "Cron Schedule": "*/15 * * * *",
    "Schedule Window": "5",
    "Schedule Priority": "default",
    "Trigger Condition": "Number of results is greater than 0",
    "Throttling": {
      "enabled": 1,
      "fields": "dest,process_name,user",
      "period": "1h"
    },
    "Risk": [
      {
        "risk_object_field": "user",
        "risk_object_type": "user",
        "risk_score": 35
      },
      {
        "risk_object_field": "dest",
        "risk_object_type": "system",
        "risk_score": 35
      }
    ],
    "Notable Title": "Attempt to Add Certificate to Untrusted Store on $dest$",
    "Notable Description": "An instance of $parent_process_name$ spawning $process_name$ was identified attempting to add a certificate to the store on endpoint $dest$ by user $user$.",
    "Security Domain": "endpoint",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on Endpoint",
    "Drilldown Search (Legacy)": "| tstats `security_content_summariesonly` count from datamodel=Endpoint.Processes where Processes.dest=\"$dest$\" Processes.process_name=\"certutil.exe\" by Processes.process Processes.user | `drop_dm_object_name(Processes)`",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1553.004"
    ],
    "Drilldown Name 1": "View the detection results for - \"$user$\" and \"$dest$\"",
    "Drilldown Search 1": "%original_detection_search% | search  user = \"$user$\" dest = \"$dest$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for - \"$user$\" and \"$dest$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$user$\", \"$dest$\") starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "T1553_004_attempt_to_add_certificate_to_untrusted_store.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "T1552_002_auto_admin_logon_registry_entry.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "The following analytic detects a suspicious registry modification that enables auto admin logon on a host. It leverages data from the Endpoint.Registry data model, specifically looking for changes to the \"AutoAdminLogon\" value within the \"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\" registry path. This activity is significant because it was observed in BlackMatter ransomware attacks to maintain access after a safe mode reboot, facilitating further encryption. If confirmed malicious, this could allow attackers to automatically log in and continue their operations, potentially leading to widespread network encryption and data loss.",
    "Assumptions": "Assumptions:\n- Registry monitoring is enabled via Sysmon EventID 13\n- Sysmon TA version 2.0 or higher is installed\n- Endpoint.Registry data model is properly configured\n\nPotential Impact:\n- Automatic admin logon after reboot\n- Ransomware persistence mechanism\n- Continued malicious operations after safe mode boot",
    "origin": "custom",
    "Detection Name": "Auto Admin Logon Registry Entry",
    "Objective": "Detect and alert on registry modifications that enable auto admin logon, which may indicate ransomware or persistence mechanisms.",
    "Severity/Priority": "High",
    "Analyst Next Steps": "1. Identify the process that modified the registry entry\n2. Check if the modification is associated with known ransomware behavior\n3. Review recent malware alerts on the affected endpoint\n4. Investigate if the system was recently rebooted into safe mode\n5. Look for related persistence mechanisms",
    "Blind_Spots_False_Positives": "Blind Spots:\n- Registry modifications made through WMI or other indirect methods\n- Modifications using different registry keys for auto-logon\n\nFalse Positives:\n- Legitimate auto-logon configurations by administrators\n- Kiosk or shared workstation configurations",
    "Required_Data_Sources": "Sysmon EventID 13",
    "First Created": "2025-05-02T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime FROM datamodel=Endpoint.Registry WHERE (Registry.registry_path= \"*SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon*\" AND Registry.registry_value_name=AutoAdminLogon AND Registry.registry_value_data=1) by Registry.action Registry.dest Registry.process_guid Registry.process_id Registry.registry_hive Registry.registry_path Registry.registry_key_name Registry.registry_value_data Registry.registry_value_name Registry.registry_value_type Registry.status Registry.user Registry.vendor_product | `drop_dm_object_name(Registry)` | where isnotnull(registry_value_data) | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `auto_admin_logon_registry_entry_filter`",
    "Splunk_App_Context": "search",
    "Search_Duration": "-15m",
    "Cron Schedule": "*/15 * * * *",
    "Schedule Window": "5",
    "Schedule Priority": "default",
    "Trigger Condition": "Number of results is greater than 0",
    "Throttling": {
      "enabled": 1,
      "fields": "dest,registry_value_name",
      "period": "1h"
    },
    "Risk": [
      {
        "risk_object_field": "dest",
        "risk_object_type": "system",
        "risk_score": 63
      }
    ],
    "Notable Title": "Auto Admin Logon Registry Entry Modified on $dest$",
    "Notable Description": "Modified registry key $registry_key_name$ with registry value $registry_value_name$ to prepare autoadminlogon",
    "Security Domain": "endpoint",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on Endpoint",
    "Drilldown Search (Legacy)": "| tstats `security_content_summariesonly` count FROM datamodel=Endpoint.Registry WHERE Registry.dest=\"$dest$\" Registry.registry_path=\"*Winlogon*\" by Registry.registry_path Registry.registry_value_name Registry.registry_value_data | `drop_dm_object_name(Registry)`",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1552.002"
    ],
    "Drilldown Name 1": "View the detection results for - \"$dest$\"",
    "Drilldown Search 1": "%original_detection_search% | search  dest = \"$dest$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for - \"$dest$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$dest$\") starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "T1552_002_auto_admin_logon_registry_entry.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "T1204_002_batch_file_write_to_system32.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "The following analytic detects the creation of a batch file (.bat) within the Windows system directory tree, specifically in the System32 or SysWOW64 folders. It leverages data from the Endpoint datamodel, focusing on process and filesystem events to identify this behavior. This activity is significant because writing batch files to system directories can be indicative of malicious intent, such as persistence mechanisms or system manipulation. If confirmed malicious, this could allow an attacker to execute arbitrary commands with elevated privileges, potentially compromising the entire system.",
    "Assumptions": "Assumptions:\n- Sysmon EventID 11 is enabled for file creation monitoring\n- Endpoint datamodel is properly configured\n- File system events are being ingested into Splunk\n\nPotential Impact:\n- Persistence mechanism establishment\n- Arbitrary command execution with elevated privileges\n- System manipulation",
    "origin": "custom",
    "Detection Name": "Batch File Write to System32",
    "Objective": "Detect and alert on the creation of batch files in Windows system directories, which may indicate malicious activity or persistence mechanisms.",
    "Severity/Priority": "High",
    "Analyst Next Steps": "1. Confirm the path of the batch file identified by the search\n2. Review the contents of the batch file if possible\n3. Identify the process that created the file\n4. Check if this is legitimate administrative activity\n5. Investigate the user account associated with the file creation",
    "Blind_Spots_False_Positives": "Blind Spots:\n- Batch files created in other system directories\n- Script files with different extensions (.cmd, .ps1)\n\nFalse Positives:\n- Batch file paths containing the string \"system32\" but not the actual Windows system directory\n- Administrator copying a legitimate batch file in this directory tree",
    "Required_Data_Sources": "Sysmon EventID 11",
    "First Created": "2025-05-02T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime FROM datamodel=Endpoint.Filesystem where Filesystem.file_path IN (\"*\\\\system32\\\\*\",\"*\\\\syswow64\\\\*\") Filesystem.file_name=\"*.bat\" by Filesystem.action Filesystem.dest Filesystem.file_access_time Filesystem.file_create_time Filesystem.file_hash Filesystem.file_modify_time Filesystem.file_name Filesystem.file_path Filesystem.file_acl Filesystem.file_size Filesystem.process_guid Filesystem.process_id Filesystem.user Filesystem.vendor_product | `drop_dm_object_name(Filesystem)` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `batch_file_write_to_system32_filter`",
    "Splunk_App_Context": "search",
    "Search_Duration": "-15m",
    "Cron Schedule": "*/15 * * * *",
    "Schedule Window": "5",
    "Schedule Priority": "default",
    "Trigger Condition": "Number of results is greater than 0",
    "Throttling": {
      "enabled": 1,
      "fields": "dest,file_name,user",
      "period": "1h"
    },
    "Risk": [
      {
        "risk_object_field": "user",
        "risk_object_type": "user",
        "risk_score": 63
      },
      {
        "risk_object_field": "dest",
        "risk_object_type": "system",
        "risk_score": 63
      }
    ],
    "Notable Title": "Batch File Written to System32 on $dest$",
    "Notable Description": "A file - $file_name$ was written to system32 has occurred on endpoint $dest$ by user $user$.",
    "Security Domain": "endpoint",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on Endpoint",
    "Drilldown Search (Legacy)": "| tstats `security_content_summariesonly` count FROM datamodel=Endpoint.Filesystem WHERE Filesystem.dest=\"$dest$\" Filesystem.file_path=\"*system32*\" by Filesystem.file_name Filesystem.file_path Filesystem.user | `drop_dm_object_name(Filesystem)`",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1204.002"
    ],
    "Drilldown Name 1": "View the detection results for - \"$user$\" and \"$dest$\"",
    "Drilldown Search 1": "%original_detection_search% | search  user = \"$user$\" dest = \"$dest$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for - \"$user$\" and \"$dest$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$user$\", \"$dest$\") starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "T1204_002_batch_file_write_to_system32.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "T1490_bcdedit_failure_recovery_modification.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "The following analytic detects modifications to the Windows error recovery boot configurations using bcdedit.exe with flags such as \"recoveryenabled\" and \"no\". It leverages data from Endpoint Detection and Response (EDR) agents, focusing on process names, parent processes, and command-line executions. This activity is significant because ransomware often disables recovery options to prevent system restoration, making it crucial for SOC analysts to investigate. If confirmed malicious, this could hinder recovery efforts, allowing ransomware to cause extensive damage and complicate remediation.",
    "Assumptions": "Assumptions:\n- EDR agents are deployed and reporting process activity\n- Process GUID, process name, and parent process are being ingested\n- Complete command-line executions are logged\n\nPotential Impact:\n- Disabled Windows recovery options\n- Inability to restore system after ransomware attack\n- Complicated remediation efforts",
    "origin": "custom",
    "Detection Name": "BCDEdit Failure Recovery Modification",
    "Objective": "Detect and alert on modifications to Windows error recovery boot configurations using bcdedit.exe, which may indicate ransomware attempting to prevent system restoration.",
    "Severity/Priority": "High",
    "Analyst Next Steps": "1. Identify the user and endpoint executing the bcdedit command\n2. Review the full command line for additional context\n3. Check for ransomware indicators on the endpoint\n4. Investigate the parent process for signs of compromise\n5. Look for shadow copy deletion or other destructive activities",
    "Blind_Spots_False_Positives": "Blind Spots:\n- Boot configuration modifications using other tools or APIs\n- WMI-based boot configuration changes\n\nFalse Positives:\n- Administrators modifying the boot configuration for legitimate purposes\n- System administrators configuring test environments",
    "Required_Data_Sources": "Sysmon EventID 1, Windows Event Log Security 4688, CrowdStrike ProcessRollup2",
    "First Created": "2025-05-02T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name = bcdedit.exe Processes.process=\"*recoveryenabled*\" (Processes.process=\"* no*\") by Processes.action Processes.dest Processes.original_file_name Processes.parent_process Processes.parent_process_exec Processes.parent_process_guid Processes.parent_process_id Processes.parent_process_name Processes.parent_process_path Processes.process Processes.process_exec Processes.process_guid Processes.process_hash Processes.process_id Processes.process_integrity_level Processes.process_name Processes.process_path Processes.user Processes.user_id Processes.vendor_product | `drop_dm_object_name(Processes)` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `bcdedit_failure_recovery_modification_filter`",
    "Splunk_App_Context": "search",
    "Search_Duration": "-15m",
    "Cron Schedule": "*/15 * * * *",
    "Schedule Window": "5",
    "Schedule Priority": "default",
    "Trigger Condition": "Number of results is greater than 0",
    "Throttling": {
      "enabled": 1,
      "fields": "dest,process_name,user",
      "period": "1h"
    },
    "Risk": [
      {
        "risk_object_field": "user",
        "risk_object_type": "user",
        "risk_score": 80
      },
      {
        "risk_object_field": "dest",
        "risk_object_type": "system",
        "risk_score": 80
      }
    ],
    "Notable Title": "BCDEdit Failure Recovery Modification on $dest$",
    "Notable Description": "An instance of $parent_process_name$ spawning $process_name$ was identified on endpoint $dest$ by user $user$ attempting to disable the ability to recover the endpoint.",
    "Security Domain": "endpoint",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on Endpoint",
    "Drilldown Search (Legacy)": "| tstats `security_content_summariesonly` count from datamodel=Endpoint.Processes where Processes.dest=\"$dest$\" Processes.process_name=\"bcdedit.exe\" by Processes.process Processes.user | `drop_dm_object_name(Processes)`",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1490"
    ],
    "Drilldown Name 1": "View the detection results for - \"$user$\" and \"$dest$\"",
    "Drilldown Search 1": "%original_detection_search% | search  user = \"$user$\" dest = \"$dest$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for - \"$user$\" and \"$dest$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$user$\", \"$dest$\") starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "T1490_bcdedit_failure_recovery_modification.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "T1055_003_browser_process_injection_remote_debugging.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "This detection identifies potential process injection attacks targeting browser processes and sensitive credential-handling applications. Adversaries leverage Windows API calls such as SetThreadContext, CreateRemoteThread, and QueueUserApc to inject malicious code into legitimate processes like Chrome, Edge, Firefox, and credential management tools (KeePass, FileZilla, WinSCP, PuTTY). This technique is commonly used to enable remote debugging capabilities in browsers, allowing attackers to intercept credentials, session cookies, authentication tokens, and other sensitive data in real-time. The attack bypasses traditional endpoint security controls by operating within trusted processes.",
    "Assumptions": "Assumptions:\n- Microsoft Defender for Endpoint is deployed and actively reporting to Azure Event Hub\n- Target processes (browsers, credential managers) are running in the environment\n- The mscs:azure:eventhub:defender sourcetype is properly configured and ingesting data\n- API call monitoring is enabled in Defender for Endpoint\n\nPotential Impact:\n- Credential theft and session hijacking\n- Unauthorized access to sensitive systems via stolen SSH/FTP credentials\n- Password database extraction from KeePass\n- Browser-based MFA bypass through cookie/token theft\n- Lateral movement using harvested credentials",
    "origin": "custom",
    "Detection Name": "T1055.003  Process Injection - Browser Process Injection to Enable Remote Debugging",
    "Objective": "Detect and alert on process injection attempts targeting browser processes and credential management applications that may indicate an adversary attempting to enable remote debugging capabilities for credential harvesting, session hijacking, or data exfiltration.",
    "Severity/Priority": "High",
    "Analyst Next Steps": "1. Identify the initiating process (properties.InitiatingProcessFileName) and examine its legitimacy - is it a known LOLBin, unsigned binary, or running from a suspicious path?\n2. Review the initiating process command line for suspicious arguments such as --remote-debugging-port, --headless, or encoded commands\n3. Check if the affected device (properties.DeviceName) has had recent suspicious activity (malware alerts, unusual logins, policy violations)\n4. Investigate the SHA1 hash of the initiating process against threat intelligence platforms (VirusTotal, MISP)\n5. Determine if the user account associated with the activity is compromised by reviewing recent authentication events\n6. Check for persistence mechanisms on the affected host (scheduled tasks, registry run keys, services)\n7. Look for network connections from the target process to external IPs, especially on uncommon ports\n8. Isolate the endpoint if malicious activity is confirmed and preserve forensic evidence\n9. Reset credentials for any applications potentially compromised (browser sessions, KeePass databases, SSH/FTP accounts)",
    "Blind_Spots_False_Positives": "Blind Spots:\n- Process injection techniques using NtMapViewOfSection or other less common APIs not covered by this detection\n- Attackers using fileless malware that doesn't trigger Defender API monitoring\n- Injection into browser processes not included in the filter list (Opera, Brave, Vivaldi)\n- Legitimate remote debugging enabled via command-line arguments rather than injection\n- Environments where Defender for Endpoint is not deployed or API monitoring is disabled\n\nFalse Positives:\n- Legitimate debugging tools used by developers (Visual Studio, Chrome DevTools remote debugging)\n- Endpoint security products that use similar injection techniques for protection\n- Accessibility software that interacts with browser processes\n- Browser extensions or plugins that utilize remote APIs\n- Automated testing frameworks (Selenium, Puppeteer) that enable remote debugging\n- IT administration tools that interact with process memory for legitimate purposes",
    "Required_Data_Sources": "Microsoft Defender for Endpoint via Azure Event Hub (sourcetype: mscs:azure:eventhub:defender), specifically the DeviceEvents table with ActionType fields capturing API call telemetry (SetThreadContextRemoteApiCall, CreateRemoteThreadApiCall, QueueUserApcRemoteApiCall)",
    "First Created": "2025-01-19T00:00:00.000Z",
    "Last Modified": "2025-01-19T17:29:29.029Z",
    "Search String": "index=azure_cloud sourcetype=mscs:azure:eventhub:defender \n(properties.ActionType=\"SetThreadContextRemoteApiCall\" OR properties.ActionType=\"CreateRemoteThreadApiCall\" OR properties.ActionType=\"QueueUserApcRemoteApiCall\")\nproperties.FileName IN (\"msedge.exe\",\"chrome.exe\",\"msedgewebview2.exe\", \"firefox.exe\", \"keypass.exe\", \"filezilla.exe\", \"winscp.exe\", \"putty.exe\")\n| table _time properties.DeviceName properties.FileName properties.FolderPath properties.SHA1 properties.ProcessCommandLine properties.InitiatingProcessFileName properties.InitiatingProcessCommandLine user",
    "Splunk_App_Context": "search",
    "Search_Duration": "-15m",
    "Cron Schedule": "*/15 * * * *",
    "Schedule Window": "5",
    "Schedule Priority": "default",
    "Trigger Condition": "Number of results is greater than 0",
    "Throttling": {
      "enabled": 1,
      "fields": "properties.DeviceName,properties.InitiatingProcessFileName",
      "period": "1h"
    },
    "Risk": [
      {
        "risk_object_field": "properties.DeviceName",
        "risk_object_type": "system",
        "risk_score": 80
      },
      {
        "risk_object_field": "user",
        "risk_object_type": "user",
        "risk_score": 60
      }
    ],
    "Notable Title": "Process Injection Detected: $properties.InitiatingProcessFileName$ injected into $properties.FileName$ on $properties.DeviceName$",
    "Notable Description": "A process injection attack was detected on $properties.DeviceName$. The process $properties.InitiatingProcessFileName$ attempted to inject code into $properties.FileName$ using $properties.ActionType$. This technique is commonly used to enable remote debugging in browsers for credential theft or to extract sensitive data from credential management applications. Immediate investigation is recommended to determine if this is malicious activity or a false positive from legitimate software.",
    "Security Domain": "endpoint",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on Defender",
    "Drilldown Search (Legacy)": "index=azure_cloud sourcetype=mscs:azure:eventhub:defender properties.DeviceName=\"$properties.DeviceName$\" | table _time properties.ActionType properties.FileName properties.InitiatingProcessFileName properties.ProcessCommandLine user",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1055.003",
      "T1185",
      "T1539",
      "T1555"
    ],
    "Drilldown Name 1": "Investigate All Process Injection Activity by Initiating Process",
    "Drilldown Search 1": "index=azure_cloud sourcetype=mscs:azure:eventhub:defender (properties.ActionType=\"SetThreadContextRemoteApiCall\" OR properties.ActionType=\"CreateRemoteThreadApiCall\" OR properties.ActionType=\"QueueUserApcRemoteApiCall\" OR properties.ActionType=\"WriteProcessMemoryApiCall\" OR properties.ActionType=\"NtAllocateVirtualMemoryApiCall\") properties.InitiatingProcessFileName=\"$properties.InitiatingProcessFileName$\" | stats count by _time properties.DeviceName properties.FileName properties.InitiatingProcessFileName properties.InitiatingProcessCommandLine properties.ActionType user | sort -_time",
    "Drilldown Earliest 1": "-30d",
    "Drilldown Latest 1": "now",
    "Drilldown Name 2": "Review All Endpoint Activity for Affected Device",
    "Drilldown Search 2": "index=azure_cloud sourcetype=mscs:azure:eventhub:defender properties.DeviceName=\"$properties.DeviceName$\" | stats count by properties.ActionType properties.FileName properties.InitiatingProcessFileName | sort -count | head 50",
    "Drilldown Earliest 2": "-7d",
    "Drilldown Latest 2": "now",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "Test Plan:\n\n1. Atomic Red Team Test (T1055.003):\n   - Execute Atomic Test #1: Process Injection via CreateRemoteThread\n   - Command: Invoke-AtomicTest T1055.003 -TestNumbers 1\n   - Expected Result: Alert should trigger when injection targets monitored processes\n\n2. Manual Validation:\n   - Use a controlled penetration testing tool (Cobalt Strike, Metasploit) in a test environment\n   - Perform process injection into chrome.exe or msedge.exe\n   - Verify the detection fires and captures the correct initiating process\n\n3. Browser Remote Debugging Test:\n   - Use a tool like ChromeDP or Puppeteer to inject and enable remote debugging\n   - Verify detection captures the injection API calls\n\n4. False Positive Validation:\n   - Run common developer tools (Visual Studio debugger, Chrome DevTools)\n   - Document any legitimate tools that trigger the detection\n   - Update exclusions if necessary\n\n5. Field Extraction Verification:\n   - Confirm all table fields are properly populated\n   - Verify DeviceName, FileName, InitiatingProcessFileName, and user fields contain expected values\n\n6. Throttling Test:\n   - Trigger multiple alerts for the same device/process combination\n   - Verify throttling prevents alert fatigue (1 alert per hour per unique combination)",
    "_sourceFile": "T1055_003_browser_process_injection_remote_debugging.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "network_detect_windows_dns_sigred_via_splunk_stream.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "Shannon Davis, Splunk",
        "Title": ""
      }
    ],
    "Description": "The following analytic detects attempts to exploit the SIGRed vulnerability (CVE-2020-1350) in Windows DNS servers. It leverages Splunk Stream DNS and TCP data to identify DNS SIG and KEY records, as well as TCP payloads exceeding 65KB. This activity is significant because SIGRed is a critical wormable vulnerability that allows remote code execution. If confirmed malicious, an attacker could gain unauthorized access, execute arbitrary code, and potentially disrupt services, leading to severe data breaches and infrastructure compromise. Immediate investigation and remediation are crucial to mitigate these risks.",
    "Assumptions": "Assumptions:\nYou must be ingesting Splunk Stream DNS and Splunk Stream TCP. We are detecting SIG and KEY records via stream:dns and TCP payload over 65KB in size via stream:tcp. Replace the macro definitions ('stream:dns' and 'stream:tcp') with configurations for your Splunk environment.\n\nPotential Impact:\nSevere - Remote code execution on Windows DNS servers, potential domain-wide compromise.",
    "origin": "custom",
    "Detection Name": "Detect Windows DNS SIGRed via Splunk Stream",
    "Objective": "Detect attempts to exploit the SIGRed vulnerability (CVE-2020-1350) targeting Windows DNS servers to prevent remote code execution attacks.",
    "Severity/Priority": "high",
    "Analyst Next Steps": "1. Verify whether the DNS server is patched against CVE-2020-1350.\n2. Examine the flow_id for associated suspicious activity.\n3. Check for signs of exploitation or post-exploitation behavior.\n4. Isolate affected systems if exploitation is confirmed.",
    "Blind_Spots_False_Positives": "Known False Positives: unknown",
    "Required_Data_Sources": "Splunk Stream DNS, Splunk Stream TCP",
    "First Created": "2020-07-28T00:00:00.000Z",
    "Last Modified": "2025-05-02T00:00:00.000Z",
    "Search String": "`stream_dns` | spath \"query_type{}\" | search \"query_type{}\" IN (SIG,KEY) | spath protocol_stack | search protocol_stack=\"ip:tcp:dns\" | append [search `stream_tcp` bytes_out>65000] | `detect_windows_dns_sigred_via_splunk_stream_filter` | stats count by flow_id | where count>1 | fields - count",
    "Splunk_App_Context": "",
    "Search_Duration": "",
    "Cron Schedule": "",
    "Schedule Window": "",
    "Schedule Priority": "default",
    "Trigger Condition": "",
    "Throttling": {
      "enabled": 0,
      "fields": "",
      "period": ""
    },
    "Risk": [
      {
        "risk_object_field": "flow_id",
        "risk_object_type": "other",
        "risk_score": 25
      }
    ],
    "Notable Title": "Detect Windows DNS SIGRed via Splunk Stream",
    "Notable Description": "Potential SIGRed activity detected",
    "Security Domain": "network",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on ",
    "Drilldown Search (Legacy)": "",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1203"
    ],
    "Drilldown Name 1": "",
    "Drilldown Search 1": "",
    "Drilldown Earliest 1": null,
    "Drilldown Latest 1": null,
    "Drilldown Name 2": "",
    "Drilldown Search 2": "",
    "Drilldown Earliest 2": null,
    "Drilldown Latest 2": null,
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "network_detect_windows_dns_sigred_via_splunk_stream.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "network_detect_windows_dns_sigred_via_zeek.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "Shannon Davis, Splunk",
        "Title": ""
      }
    ],
    "Description": "The following analytic detects the presence of SIGRed, a critical DNS vulnerability, using Zeek DNS and Zeek Conn data. It identifies specific DNS query types (SIG and KEY) and checks for high data transfer within a flow. This detection is significant because SIGRed allows attackers to execute remote code on Windows DNS servers, potentially leading to unauthorized access and control. If confirmed malicious, this activity could result in data exfiltration, service disruption, or further network compromise. Immediate investigation and mitigation, such as patching or isolating the affected server, are crucial.",
    "Assumptions": "Assumptions:\nYou must be ingesting Zeek DNS and Zeek Conn data into Splunk. Zeek data should also be getting ingested in JSON format. We are detecting SIG and KEY records via bro:dns:json and TCP payload over 65KB in size via bro:conn:json. The Network Resolution and Network Traffic datamodels are in use for this search.\n\nPotential Impact:\nCritical - Remote code execution on Windows DNS servers, potential for data exfiltration and network compromise.",
    "origin": "custom",
    "Detection Name": "Detect Windows DNS SIGRed via Zeek",
    "Objective": "Detect SIGRed vulnerability (CVE-2020-1350) exploitation attempts using Zeek network data to prevent remote code execution on Windows DNS servers.",
    "Severity/Priority": "high",
    "Analyst Next Steps": "1. Verify whether the DNS server is patched against CVE-2020-1350.\n2. Analyze the flow_id for associated malicious activity.\n3. Check for signs of exploitation or post-exploitation behavior.\n4. Isolate affected systems if exploitation is confirmed and apply patches.",
    "Blind_Spots_False_Positives": "Known False Positives: unknown",
    "Required_Data_Sources": "Zeek DNS (bro:dns:json), Zeek Conn (bro:conn:json), Network Resolution datamodel, Network Traffic datamodel",
    "First Created": "2020-07-28T00:00:00.000Z",
    "Last Modified": "2025-05-02T00:00:00.000Z",
    "Search String": "| tstats `security_content_summariesonly` count from datamodel=Network_Resolution where DNS.query_type IN (SIG,KEY) by DNS.flow_id | rename DNS.flow_id as flow_id | append [| tstats  `security_content_summariesonly` count from datamodel=Network_Traffic where All_Traffic.bytes_in>65000 by All_Traffic.flow_id | rename All_Traffic.flow_id as flow_id] | `detect_windows_dns_sigred_via_zeek_filter` | stats count by flow_id | where count>1 | fields - count",
    "Splunk_App_Context": "",
    "Search_Duration": "",
    "Cron Schedule": "",
    "Schedule Window": "",
    "Schedule Priority": "default",
    "Trigger Condition": "",
    "Throttling": {
      "enabled": 0,
      "fields": "",
      "period": ""
    },
    "Risk": [
      {
        "risk_object_field": "flow_id",
        "risk_object_type": "other",
        "risk_score": 25
      }
    ],
    "Notable Title": "Detect Windows DNS SIGRed via Zeek",
    "Notable Description": "Potential SIGRed activity detected",
    "Security Domain": "endpoint",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on ",
    "Drilldown Search (Legacy)": "",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1203"
    ],
    "Drilldown Name 1": "",
    "Drilldown Search 1": "",
    "Drilldown Earliest 1": null,
    "Drilldown Latest 1": null,
    "Drilldown Name 2": "",
    "Drilldown Search 2": "",
    "Drilldown Earliest 2": null,
    "Drilldown Latest 2": null,
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "network_detect_windows_dns_sigred_via_zeek.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "network_windows_abused_web_services.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "Teoderick Contreras, Splunk",
        "Title": ""
      }
    ],
    "Description": "The following analytic detects a suspicious process making DNS queries to known, abused web services such as text-paste sites, VoIP, secure tunneling, instant messaging, and digital distribution platforms. This detection leverages Sysmon logs with Event ID 22, focusing on specific query names. This activity is significant as it may indicate an adversary attempting to download malicious files, a common initial access technique. If confirmed malicious, this could lead to unauthorized code execution, data exfiltration, or further compromise of the target host.",
    "Assumptions": "Assumptions:\nThis detection relies on sysmon logs with the Event ID 22, DNS Query. We suggest you run this detection at least once a day over the last 14 days.\n\nPotential Impact:\nHigh - Potential malware download, C2 communication, or data exfiltration through abused web services.",
    "origin": "custom",
    "Detection Name": "Windows Abused Web Services",
    "Objective": "Detect suspicious DNS queries to commonly abused web services that may indicate malware communication or data exfiltration.",
    "Severity/Priority": "medium",
    "Analyst Next Steps": "1. Investigate the process making the DNS query.\n2. Check if the service usage is legitimate for the organization.\n3. Correlate with other suspicious activities from the same host.\n4. Block the service if confirmed malicious.",
    "Blind_Spots_False_Positives": "Known False Positives: Noise and false positive can be seen if the following instant messaging is allowed to use within corporate network. In this case, a filter is needed.",
    "Required_Data_Sources": "Sysmon EventID 22",
    "First Created": "2023-09-04T00:00:00.000Z",
    "Last Modified": "2025-05-26T00:00:00.000Z",
    "Search String": "`sysmon` EventCode=22 QueryName IN (\"*pastebin*\",\"\"*textbin*\"\", \"*ngrok.io*\", \"*discord*\", \"*duckdns.org*\", \"*pasteio.com*\") | stats count min(_time) as firstTime max(_time) as lastTime by answer answer_count dvc process_exec process_guid process_name query query_count reply_code_id signature signature_id src user_id vendor_product QueryName QueryResults QueryStatus | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `windows_abused_web_services_filter`",
    "Splunk_App_Context": "",
    "Search_Duration": "",
    "Cron Schedule": "",
    "Schedule Window": "",
    "Schedule Priority": "default",
    "Trigger Condition": "",
    "Throttling": {
      "enabled": 0,
      "fields": "",
      "period": ""
    },
    "Risk": [
      {
        "risk_object_field": "dvc",
        "risk_object_type": "system",
        "risk_score": 36
      }
    ],
    "Notable Title": "Windows Abused Web Services",
    "Notable Description": "a network connection on known abused web services from $dvc$",
    "Security Domain": "endpoint",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on ",
    "Drilldown Search (Legacy)": "",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1102"
    ],
    "Drilldown Name 1": "View the detection results for - \"$dest$\"",
    "Drilldown Search 1": "%original_detection_search% | search  dest = \"$dest$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for - \"$dest$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$dest$\") starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "network_windows_abused_web_services.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "network_windows_ad_replication_service_traffic.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "Steven Dick",
        "Title": ""
      }
    ],
    "Description": "The following analytic identifies unexpected Active Directory replication traffic from non-domain controller sources. It leverages data from the Network Traffic datamodel, specifically looking for applications related to AD replication. This activity is significant because AD replication traffic should typically only occur between domain controllers. Detection of such traffic from other sources may indicate malicious activities like DCSync or DCShadow, which are used for credential dumping. If confirmed malicious, this could allow attackers to exfiltrate sensitive credentials, leading to unauthorized access and potential domain-wide compromise.",
    "Assumptions": "Assumptions:\nTo successfully implement this search, you need to be ingesting application aware firewall or proxy logs into the Network Datamodel. Categorize all known domain controller Assets servers with an appropriate category for filtering.\n\nPotential Impact:\nCritical - Credential theft via DCSync/DCShadow attacks could lead to domain-wide compromise.",
    "origin": "custom",
    "Detection Name": "Windows AD Replication Service Traffic",
    "Objective": "Detect unexpected Active Directory replication traffic from non-domain controller sources to identify potential DCSync or DCShadow attacks.",
    "Severity/Priority": "critical",
    "Analyst Next Steps": "1. Verify if the source is a legitimate domain controller.\n2. Check for DCSync or DCShadow attack indicators.\n3. Review user accounts associated with the traffic.\n4. Isolate the source if malicious activity is confirmed.",
    "Blind_Spots_False_Positives": "Known False Positives: New domain controllers or certain scripts run by administrators.",
    "Required_Data_Sources": "Network Traffic datamodel, Application aware firewall or proxy logs",
    "First Created": "2023-11-07T00:00:00.000Z",
    "Last Modified": "2025-05-02T00:00:00.000Z",
    "Search String": "| tstats `security_content_summariesonly` count values(All_Traffic.transport) as transport values(All_Traffic.user) as user values(All_Traffic.src_category) as src_category values(All_Traffic.dest_category) as dest_category min(_time) as firstTime max(_time) as lastTime from datamodel=Network_Traffic where All_Traffic.app IN (\"ms-dc-replication\",\"*drsr*\",\"ad drs\") by All_Traffic.src All_Traffic.dest All_Traffic.app | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `drop_dm_object_name(\"All_Traffic\")` | `windows_ad_replication_service_traffic_filter`",
    "Splunk_App_Context": "",
    "Search_Duration": "",
    "Cron Schedule": "",
    "Schedule Window": "",
    "Schedule Priority": "default",
    "Trigger Condition": "",
    "Throttling": {
      "enabled": 0,
      "fields": "",
      "period": ""
    },
    "Risk": [
      {
        "risk_object_field": "dest",
        "risk_object_type": "system",
        "risk_score": 100
      }
    ],
    "Notable Title": "Windows AD Replication Service Traffic",
    "Notable Description": "Active Directory Replication Traffic from Unknown Source - $src$",
    "Security Domain": "network",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on ",
    "Drilldown Search (Legacy)": "",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1003.006",
      "T1207"
    ],
    "Drilldown Name 1": "",
    "Drilldown Search 1": "",
    "Drilldown Earliest 1": null,
    "Drilldown Latest 1": null,
    "Drilldown Name 2": "",
    "Drilldown Search 2": "",
    "Drilldown Earliest 2": null,
    "Drilldown Latest 2": null,
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "network_windows_ad_replication_service_traffic.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "network_windows_ad_rogue_domain_controller_network_activity.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "Dean Luxton",
        "Title": ""
      }
    ],
    "Description": "The following analytic identifies unauthorized replication RPC calls from non-domain controller devices. It leverages Zeek wire data to detect specific RPC operations like DrsReplicaAdd and DRSGetNCChanges, filtering out legitimate domain controllers. This activity is significant as it may indicate an attempt to introduce a rogue domain controller, which can compromise the integrity of the Active Directory environment. If confirmed malicious, this could allow attackers to manipulate directory data, escalate privileges, and persist within the network, posing a severe security risk.",
    "Assumptions": "Assumptions:\nRun zeek on domain controllers to capture the DCE RPC calls, ensure the domain controller categories are defined in Assets and Identities.\n\nPotential Impact:\nCritical - Rogue domain controller introduction can lead to AD compromise, privilege escalation, and persistence.",
    "origin": "custom",
    "Detection Name": "Windows AD Rogue Domain Controller Network Activity",
    "Objective": "Detect unauthorized AD replication RPC calls from non-domain controller devices to identify potential rogue domain controller attacks.",
    "Severity/Priority": "critical",
    "Analyst Next Steps": "1. Verify the source device category and whether it is a legitimate DC.\n2. Investigate the RPC operations being performed.\n3. Check for other indicators of DCShadow or rogue DC attacks.\n4. Isolate the suspicious device immediately if confirmed malicious.",
    "Blind_Spots_False_Positives": "Known False Positives: None.",
    "Required_Data_Sources": "Zeek RPC logs, Assets and Identities with domain controller categories",
    "First Created": "2023-11-07T00:00:00.000Z",
    "Last Modified": "2025-05-02T00:00:00.000Z",
    "Search String": "`zeek_rpc` DrsReplicaAdd OR DRSGetNCChanges | where NOT (dest_category=\"Domain Controller\") OR NOT (src_category=\"Domain Controller\") | fillnull value=\"Unknown\" src_category, dest_category | table _time endpoint operation src src_category dest dest_category | `windows_ad_rogue_domain_controller_network_activity_filter`",
    "Splunk_App_Context": "",
    "Search_Duration": "",
    "Cron Schedule": "",
    "Schedule Window": "",
    "Schedule Priority": "default",
    "Trigger Condition": "",
    "Throttling": {
      "enabled": 0,
      "fields": "",
      "period": ""
    },
    "Risk": [
      {
        "risk_object_field": "dest",
        "risk_object_type": "system",
        "risk_score": 100
      }
    ],
    "Notable Title": "Windows AD Rogue Domain Controller Network Activity",
    "Notable Description": "Rogue DC Activity Detected from $src_category$ device $src$ to $dest$ ($dest_category$)",
    "Security Domain": "network",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on ",
    "Drilldown Search (Legacy)": "",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1207"
    ],
    "Drilldown Name 1": "",
    "Drilldown Search 1": "",
    "Drilldown Earliest 1": null,
    "Drilldown Latest 1": null,
    "Drilldown Name 2": "",
    "Drilldown Search 2": "",
    "Drilldown Earliest 2": null,
    "Drilldown Latest 2": null,
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "network_windows_ad_rogue_domain_controller_network_activity.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "network_windows_dns_query_request_by_telegram_bot_api.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "Teoderick Contreras, Splunk",
        "Title": ""
      }
    ],
    "Description": "The following analytic detects the execution of a DNS query by a process to the associated Telegram API domain, which could indicate access via a Telegram bot commonly used by malware for command and control (C2) communications. By monitoring DNS queries related to Telegram's infrastructure, the detection identifies potential attempts to establish covert communication channels between a compromised system and external malicious actors. This behavior is often observed in cyberattacks where Telegram bots are used to receive commands or exfiltrate data, making it a key indicator of suspicious or malicious activity within a network.",
    "Assumptions": "Assumptions:\nTo successfully implement this search, you need to be ingesting logs with the process name and eventcode = 22 dnsquery executions from your endpoints. If you are using Sysmon, you must have at least version 6.0.4 of the Sysmon TA.\n\nPotential Impact:\nHigh - C2 communication via Telegram bot, potential data exfiltration.",
    "origin": "custom",
    "Detection Name": "Windows DNS Query Request by Telegram Bot API",
    "Objective": "Detect DNS queries to Telegram API that may indicate malware using Telegram bots for command and control communications.",
    "Severity/Priority": "medium",
    "Analyst Next Steps": "1. Identify the process making the Telegram API query.\n2. Investigate if the process is legitimate or potentially malicious.\n3. Check for other signs of C2 activity or data exfiltration.\n4. Block Telegram API if not legitimate for the organization.",
    "Blind_Spots_False_Positives": "Known False Positives: a third party automation using telegram API.",
    "Required_Data_Sources": "Sysmon EventID 22",
    "First Created": "2024-08-07T00:00:00.000Z",
    "Last Modified": "2025-08-22T00:00:00.000Z",
    "Search String": "`sysmon` EventCode=22  query = \"api.telegram.org\" process_name != \"telegram.exe\" | stats count min(_time) as firstTime max(_time) as lastTime by answer answer_count dvc process_exec process_guid process_name query query_count reply_code_id signature signature_id src user_id vendor_product QueryName QueryResults QueryStatus | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `windows_dns_query_request_by_telegram_bot_api_filter`",
    "Splunk_App_Context": "",
    "Search_Duration": "",
    "Cron Schedule": "",
    "Schedule Window": "",
    "Schedule Priority": "default",
    "Trigger Condition": "",
    "Throttling": {
      "enabled": 0,
      "fields": "",
      "period": ""
    },
    "Risk": [
      {
        "risk_object_field": "dvc",
        "risk_object_type": "system",
        "risk_score": 36
      }
    ],
    "Notable Title": "Windows DNS Query Request by Telegram Bot API",
    "Notable Description": "DNS query by a telegram bot [$query$] on [$dvc$].",
    "Security Domain": "endpoint",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on ",
    "Drilldown Search (Legacy)": "",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1071.004",
      "T1102.002"
    ],
    "Drilldown Name 1": "View the detection results for - \"$dest$\"",
    "Drilldown Search 1": "%original_detection_search% | search  dest = \"$dest$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for - \"$dest$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$dest$\") starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "network_windows_dns_query_request_by_telegram_bot_api.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "network_windows_gather_victim_network_info_through_ip_check_web_services.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "Teoderick Contreras, Splunk",
        "Title": ""
      }
    ],
    "Description": "The following analytic detects processes attempting to connect to known IP check web services. This behavior is identified using Sysmon EventCode 22 logs, specifically monitoring DNS queries to services like \"wtfismyip.com\" and \"ipinfo.io\". This activity is significant as it is commonly used by malware, such as Trickbot, for reconnaissance to determine the infected machine's IP address. If confirmed malicious, this could allow attackers to gather network information, aiding in further attacks or lateral movement within the network.",
    "Assumptions": "Assumptions:\nTo successfully implement this search, you need to be ingesting logs with the process name, dns query name process path, and query status from your endpoints like EventCode 22. If you are using Sysmon, you must have at least version 12 of the Sysmon TA.\n\nPotential Impact:\nMedium - Reconnaissance activity that could lead to further attacks or lateral movement.",
    "origin": "custom",
    "Detection Name": "Windows Gather Victim Network Info Through Ip Check Web Services",
    "Objective": "Detect processes making DNS queries to IP check services that may indicate malware reconnaissance activity.",
    "Severity/Priority": "medium",
    "Analyst Next Steps": "1. Identify the process making the IP check query.\n2. Determine if the process is legitimate or potentially malicious.\n3. Correlate with other suspicious activities from the same host.\n4. Check for known malware signatures or behavior.",
    "Blind_Spots_False_Positives": "Known False Positives: Filter internet browser application to minimize the false positive of this detection.",
    "Required_Data_Sources": "Sysmon EventID 22",
    "First Created": "2022-08-01T00:00:00.000Z",
    "Last Modified": "2025-10-31T00:00:00.000Z",
    "Search String": "`sysmon` EventCode=22  QueryName IN (\"*wtfismyip.com\", \"*checkip.*\", \"*ipecho.net\", \"*ipinfo.io\", \"*api.ipify.org\", \"*icanhazip.com\", \"*ip.anysrc.com\",\"*api.ip.sb\", \"ident.me\", \"www.myexternalip.com\", \"*zen.spamhaus.org\", \"*cbl.abuseat.org\", \"*b.barracudacentral.org\", \"*dnsbl-1.uceprotect.net\", \"*spam.dnsbl.sorbs.net\", \"*iplogger.org*\", \"*ip-api.com*\", \"*geoip.*\", \"*icanhazip.*\", \"*ipwho.is*\", \"*ifconfig.me*\", \"*myip.com*\", \"*ipstack.com*\", \"*myexternalip.com*\", \"*ip-api.io*\", \"*trackip.net*\", \"*ipgeolocation.io*\", \"*ipfind.io*\", \"*freegeoip.app*\", \"*ipv4bot.whatismyipaddress.com*\") |  stats  min(_time) as firstTime max(_time) as lastTime count by answer answer_count dvc process_exec process_guid process_name query query_count reply_code_id signature signature_id src user_id vendor_product QueryName QueryResults QueryStatus | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `windows_gather_victim_network_info_through_ip_check_web_services_filter`",
    "Splunk_App_Context": "",
    "Search_Duration": "",
    "Cron Schedule": "",
    "Schedule Window": "",
    "Schedule Priority": "default",
    "Trigger Condition": "",
    "Throttling": {
      "enabled": 0,
      "fields": "",
      "period": ""
    },
    "Risk": [
      {
        "risk_object_field": "dvc",
        "risk_object_type": "system",
        "risk_score": 36
      }
    ],
    "Notable Title": "Windows Gather Victim Network Info Through Ip Check Web Services",
    "Notable Description": "a network connection on known abused web services from $dvc$",
    "Security Domain": "endpoint",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on ",
    "Drilldown Search (Legacy)": "",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1590.005"
    ],
    "Drilldown Name 1": "View the detection results for - \"$dest$\"",
    "Drilldown Search 1": "%original_detection_search% | search  dest = \"$dest$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for - \"$dest$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$dest$\") starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "network_windows_gather_victim_network_info_through_ip_check_web_services.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "network_windows_multi_hop_proxy_tor_website_query.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "Teoderick Contreras, Splunk",
        "Title": ""
      }
    ],
    "Description": "The following analytic identifies DNS queries to known TOR proxy websites, such as \"*.torproject.org\" and \"www.theonionrouter.com\". It leverages Sysmon EventCode 22 to detect these queries by monitoring DNS query events from endpoints. This activity is significant because adversaries often use TOR proxies to disguise the source of their malicious traffic, making it harder to trace their actions. If confirmed malicious, this behavior could indicate an attempt to obfuscate network traffic, potentially allowing attackers to exfiltrate data or communicate with command and control servers undetected.",
    "Assumptions": "Assumptions:\nTo successfully implement this search, you need to be ingesting logs with the process name and sysmon eventcode = 22 dns query events from your endpoints. If you are using Sysmon, you must have at least version 6.0.4 of the Sysmon TA.\n\nPotential Impact:\nHigh - TOR usage may indicate data exfiltration or C2 communication attempts.",
    "origin": "custom",
    "Detection Name": "Windows Multi hop Proxy TOR Website Query",
    "Objective": "Detect DNS queries to TOR-related domains that may indicate use of TOR proxies for traffic obfuscation.",
    "Severity/Priority": "medium",
    "Analyst Next Steps": "1. Identify the process making the TOR-related DNS query.\n2. Determine if TOR usage is authorized for the user/system.\n3. Check for data exfiltration or C2 indicators.\n4. Block TOR if not authorized for the organization.",
    "Blind_Spots_False_Positives": "Known False Positives: third party application may use this proxies if allowed in production environment. Filter is needed.",
    "Required_Data_Sources": "Sysmon EventID 22",
    "First Created": "2022-09-29T00:00:00.000Z",
    "Last Modified": "2025-07-28T00:00:00.000Z",
    "Search String": "`sysmon` EventCode=22 QueryName IN (\"*.torproject.org\", \"www.theonionrouter.com\") | stats count min(_time) as firstTime max(_time) as lastTime by answer answer_count dvc process_exec process_guid process_name query query_count reply_code_id signature signature_id src user_id vendor_product QueryName QueryResults QueryStatus | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `windows_multi_hop_proxy_tor_website_query_filter`",
    "Splunk_App_Context": "",
    "Search_Duration": "",
    "Cron Schedule": "",
    "Schedule Window": "",
    "Schedule Priority": "default",
    "Trigger Condition": "",
    "Throttling": {
      "enabled": 0,
      "fields": "",
      "period": ""
    },
    "Risk": [
      {
        "risk_object_field": "dvc",
        "risk_object_type": "system",
        "risk_score": 25
      }
    ],
    "Notable Title": "Windows Multi hop Proxy TOR Website Query",
    "Notable Description": "a process $process_name$ is having a dns query in a tor domain $QueryName$ in $dvc$",
    "Security Domain": "endpoint",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on ",
    "Drilldown Search (Legacy)": "",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1071.003"
    ],
    "Drilldown Name 1": "View the detection results for - \"$dest$\"",
    "Drilldown Search 1": "%original_detection_search% | search  dest = \"$dest$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for - \"$dest$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$dest$\") starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "network_windows_multi_hop_proxy_tor_website_query.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "network_windows_remote_desktop_network_bruteforce_attempt.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "Jose Hernandez, Bhavin Patel, Splunk",
        "Title": ""
      }
    ],
    "Description": "The following analytic identifies potential Remote Desktop Protocol (RDP) brute force attacks by monitoring network traffic for RDP application activity. This query detects potential RDP brute force attacks by identifying source IPs that have made more than 10 connection attempts to the same RDP port on a host within a one-hour window. The results are presented in a table that includes the source and destination IPs, destination port, number of attempts, and the times of the first and last connection attempts, helping to prioritize IPs based on the intensity of activity.",
    "Assumptions": "Assumptions:\nYou must ensure that your network traffic data is populating the Network_Traffic data model. Adjust the count and duration thresholds as necessary to tune the sensitivity of your detection.\n\nPotential Impact:\nHigh - Successful RDP brute force could lead to unauthorized access and system compromise.",
    "origin": "custom",
    "Detection Name": "Windows Remote Desktop Network Bruteforce Attempt",
    "Objective": "Detect RDP brute force attacks by identifying excessive connection attempts to RDP ports within a short time window.",
    "Severity/Priority": "medium",
    "Analyst Next Steps": "1. Investigate the source IP for malicious activity.\n2. Check if the target system was compromised.\n3. Review authentication logs for successful logins.\n4. Block the source IP if confirmed malicious.",
    "Blind_Spots_False_Positives": "Known False Positives: RDP gateways may have unusually high amounts of traffic from all other hosts' RDP applications in the network. Any legitimate RDP traffic using wrong/expired credentials will be also detected as a false positive.",
    "Required_Data_Sources": "Sysmon EventID 3, Network Traffic datamodel",
    "First Created": "2020-03-01T00:00:00.000Z",
    "Last Modified": "2025-08-01T00:00:00.000Z",
    "Search String": "| tstats `security_content_summariesonly` count, min(_time) as firstTime, max(_time) as lastTime values(Al_Traffic.src_port) as src_port from datamodel=Network_Traffic where (All_Traffic.app=rdp OR All_Traffic.dest_port=3389)   by All_Traffic.action All_Traffic.app All_Traffic.dest All_Traffic.dest_ip All_Traffic.dest_port All_Traffic.direction  All_Traffic.dvc All_Traffic.protocol All_Traffic.protocol_version All_Traffic.src All_Traffic.src_ip  All_Traffic.transport All_Traffic.user All_Traffic.vendor_product | `drop_dm_object_name(\"All_Traffic\")`  | eval duration=lastTime-firstTime  | where count > 10 AND duration < 3600  | `security_content_ctime(firstTime)`  | `security_content_ctime(lastTime)`  | `windows_remote_desktop_network_bruteforce_attempt_filter`",
    "Splunk_App_Context": "",
    "Search_Duration": "",
    "Cron Schedule": "",
    "Schedule Window": "",
    "Schedule Priority": "default",
    "Trigger Condition": "",
    "Throttling": {
      "enabled": 0,
      "fields": "",
      "period": ""
    },
    "Risk": [
      {
        "risk_object_field": "dest",
        "risk_object_type": "system",
        "risk_score": 25
      }
    ],
    "Notable Title": "Windows Remote Desktop Network Bruteforce Attempt",
    "Notable Description": "$dest$ may be the target of an RDP Bruteforce from $src$",
    "Security Domain": "network",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on ",
    "Drilldown Search (Legacy)": "",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1110.001"
    ],
    "Drilldown Name 1": "View the detection results for - \"$dest$\"",
    "Drilldown Search 1": "%original_detection_search% | search  dest = \"$dest$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for - \"$dest$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$dest$\") starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "network_windows_remote_desktop_network_bruteforce_attempt.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "network_windows_spearphishing_attachment_connect_to_none_ms_office_domain.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "Teoderick Contreras, Splunk",
        "Title": ""
      }
    ],
    "Description": "The following analytic identifies suspicious Office documents that connect to non-Microsoft Office domains. It leverages Sysmon EventCode 22 to detect processes like winword.exe or excel.exe making DNS queries to domains outside of *.office.com or *.office.net. This activity is significant as it may indicate a spearphishing attempt using malicious documents to download or connect to harmful content. If confirmed malicious, this could lead to unauthorized data access, malware infection, or further network compromise.",
    "Assumptions": "Assumptions:\nTo successfully implement this search, you need to be ingesting logs with the process name, parent process, and command-line executions from your endpoints. If you are using Sysmon, you must have at least version 6.0.4 of the Sysmon TA.\n\nPotential Impact:\nHigh - Spearphishing with malicious documents could lead to malware infection and data compromise.",
    "origin": "custom",
    "Detection Name": "Windows Spearphishing Attachment Connect To None MS Office Domain",
    "Objective": "Detect Office applications connecting to non-Microsoft domains that may indicate spearphishing with malicious documents.",
    "Severity/Priority": "medium",
    "Analyst Next Steps": "1. Investigate the Office document that triggered the alert.\n2. Examine the destination domain for malicious indicators.\n3. Check if the user received a suspicious email with an attachment.\n4. Isolate the endpoint if malware is confirmed.",
    "Blind_Spots_False_Positives": "Known False Positives: Windows Office document may contain legitimate url link other than MS office Domain. filter is needed.",
    "Required_Data_Sources": "Sysmon EventID 22",
    "First Created": "2022-09-19T00:00:00.000Z",
    "Last Modified": "2025-05-02T00:00:00.000Z",
    "Search String": "`sysmon` EventCode=22 Image IN (\"*\\\\winword.exe\",\"*\\\\excel.exe\",\"*\\\\powerpnt.exe\",\"*\\\\mspub.exe\",\"*\\\\visio.exe\",\"*\\\\wordpad.exe\",\"*\\\\wordview.exe\",\"*\\\\onenote.exe\", \"*\\\\onenotem.exe\",\"*\\\\onenoteviewer.exe\",\"*\\\\onenoteim.exe\", \"*\\\\msaccess.exe\") AND NOT(QueryName IN (\"*.office.com\", \"*.office.net\")) | stats count min(_time) as firstTime max(_time) as lastTime by answer answer_count dvc process_exec process_guid process_name query query_count reply_code_id signature signature_id src user_id vendor_product QueryName QueryResults QueryStatus | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `windows_spearphishing_attachment_connect_to_none_ms_office_domain_filter`",
    "Splunk_App_Context": "",
    "Search_Duration": "",
    "Cron Schedule": "",
    "Schedule Window": "",
    "Schedule Priority": "default",
    "Trigger Condition": "",
    "Throttling": {
      "enabled": 0,
      "fields": "",
      "period": ""
    },
    "Risk": [
      {
        "risk_object_field": "dvc",
        "risk_object_type": "system",
        "risk_score": 49
      }
    ],
    "Notable Title": "Windows Spearphishing Attachment Connect To None MS Office Domain",
    "Notable Description": "Suspicious Office document connecting to non-Microsoft domain detected",
    "Security Domain": "endpoint",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on ",
    "Drilldown Search (Legacy)": "",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1566.001"
    ],
    "Drilldown Name 1": "",
    "Drilldown Search 1": "",
    "Drilldown Earliest 1": null,
    "Drilldown Latest 1": null,
    "Drilldown Name 2": "",
    "Drilldown Search 2": "",
    "Drilldown Earliest 2": null,
    "Drilldown Latest 2": null,
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "network_windows_spearphishing_attachment_connect_to_none_ms_office_domain.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "web_citrix_adc_exploitation_cve_2023_3519.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "The following analytic identifies potential exploitation attempts against Citrix ADC related to CVE-2023-3519. It detects POST requests to specific web endpoints associated with this vulnerability by leveraging the Web datamodel. This activity is significant as CVE-2023-3519 involves a SAML processing overflow issue that can lead to memory corruption, posing a high risk. If confirmed malicious, attackers could exploit this to execute arbitrary code, escalate privileges, or disrupt services, making it crucial for SOC analysts to monitor and investigate these alerts promptly.",
    "Assumptions": "Assumptions:\n\nPotential Impact:",
    "origin": "custom",
    "Detection Name": "Citrix ADC Exploitation CVE-2023-3519",
    "Objective": "Detect potential exploitation attempts against Citrix ADC via CVE-2023-3519",
    "Severity/Priority": "medium",
    "Analyst Next Steps": "1. Verify if the target is a Citrix ADC/Gateway device\n2. Review the POST requests to SAML-related endpoints\n3. Check for memory corruption or unusual behavior on the device\n4. Correlate with other network activity from the source IP\n5. If exploitation is confirmed, isolate the device and apply patches",
    "Blind_Spots_False_Positives": "False positives may be present based on organization use of SAML utilities. Filter, or restrict the analytic to Citrix devices only.",
    "Required_Data_Sources": "Palo Alto Network Threat",
    "First Created": "2026-01-22T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "| tstats count min(_time) as firstTime max(_time) as lastTime from datamodel=Web where Web.url IN (\"*/saml/login\",\"/cgi/samlauth\",\"*/saml/activelogin\",\"/cgi/samlart?samlart=*\",\"*/cgi/logout\",\"/gwtest/formssso?event=start&target=*\",\"/netscaler/ns_gui/vpn/*\")  Web.http_method=POST by Web.http_user_agent, Web.status Web.http_method, Web.url, Web.url_length, Web.src, Web.dest, sourcetype | `drop_dm_object_name(\"Web\")` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `citrix_adc_exploitation_cve_2023_3519_filter`",
    "Splunk_App_Context": "",
    "Search_Duration": "",
    "Cron Schedule": "",
    "Schedule Window": "",
    "Schedule Priority": "default",
    "Trigger Condition": "",
    "Throttling": {
      "enabled": 0,
      "fields": "",
      "period": ""
    },
    "Risk": [
      {
        "risk_object_field": "$dest$",
        "risk_object_type": "system",
        "risk_score": 25
      }
    ],
    "Notable Title": "Citrix ADC Exploitation CVE-2023-3519",
    "Notable Description": "Potential Citrix ADC exploitation attempt via CVE-2023-3519 detected on $dest$",
    "Security Domain": "endpoint",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on ",
    "Drilldown Search (Legacy)": "",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1190"
    ],
    "Drilldown Name 1": "",
    "Drilldown Search 1": "",
    "Drilldown Earliest 1": null,
    "Drilldown Latest 1": null,
    "Drilldown Name 2": "",
    "Drilldown Search 2": "",
    "Drilldown Earliest 2": null,
    "Drilldown Latest 2": null,
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "web_citrix_adc_exploitation_cve_2023_3519.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "web_detect_f5_tmui_rce_cve_2020_5902.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "The following analytic identifies remote code execution (RCE) attempts targeting F5 BIG-IP, BIG-IQ, and Traffix SDC devices, specifically exploiting CVE-2020-5902. It uses regex to detect patterns in syslog data that match known exploit strings such as \"hsqldb;\" and directory traversal sequences. This activity is significant because successful exploitation can allow attackers to execute arbitrary commands on the affected devices, leading to full system compromise. If confirmed malicious, this could result in unauthorized access, data exfiltration, or further lateral movement within the network.",
    "Assumptions": "Assumptions:\n\nPotential Impact:",
    "origin": "custom",
    "Detection Name": "Detect F5 TMUI RCE CVE-2020-5902",
    "Objective": "Detect remote code execution attempts targeting F5 BIG-IP devices via CVE-2020-5902",
    "Severity/Priority": "medium",
    "Analyst Next Steps": "1. Verify if the target is an F5 BIG-IP device\n2. Review syslog data for exploit patterns\n3. Check for successful command execution on the device\n4. Correlate with other network activity from the source IP\n5. If exploitation is confirmed, isolate the device and apply patches",
    "Blind_Spots_False_Positives": "unknown",
    "Required_Data_Sources": "",
    "First Created": "2026-01-22T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "`f5_bigip_rogue` | regex _raw=\"(hsqldb;|.*\\\\.\\\\.;.*)\" | search `detect_f5_tmui_rce_cve_2020_5902_filter`",
    "Splunk_App_Context": "",
    "Search_Duration": "",
    "Cron Schedule": "",
    "Schedule Window": "",
    "Schedule Priority": "default",
    "Trigger Condition": "",
    "Throttling": {
      "enabled": 0,
      "fields": "",
      "period": ""
    },
    "Risk": [
      {
        "risk_object_field": "$dest$",
        "risk_object_type": "system",
        "risk_score": 25
      }
    ],
    "Notable Title": "Detect F5 TMUI RCE CVE-2020-5902",
    "Notable Description": "Potential F5 TMUI RCE traffic",
    "Security Domain": "network",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on ",
    "Drilldown Search (Legacy)": "",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1190"
    ],
    "Drilldown Name 1": "",
    "Drilldown Search 1": "",
    "Drilldown Earliest 1": null,
    "Drilldown Latest 1": null,
    "Drilldown Name 2": "",
    "Drilldown Search 2": "",
    "Drilldown Earliest 2": null,
    "Drilldown Latest 2": null,
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "web_detect_f5_tmui_rce_cve_2020_5902.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "web_fortinet_appliance_auth_bypass.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "The following analytic detects attempts to exploit CVE-2022-40684, a Fortinet appliance authentication bypass vulnerability. It identifies REST API requests to the /api/v2/ endpoint using various HTTP methods (GET, POST, PUT, DELETE) that may indicate unauthorized modifications, such as adding SSH keys or creating new users. This detection leverages the Web datamodel to monitor specific URL patterns and HTTP methods. This activity is significant as it can lead to unauthorized access and control over the appliance. If confirmed malicious, attackers could gain persistent access, reroute network traffic, or capture sensitive information.",
    "Assumptions": "Assumptions:\n\nPotential Impact:",
    "origin": "custom",
    "Detection Name": "Fortinet Appliance Auth bypass",
    "Objective": "Detect attempts to exploit Fortinet appliance authentication bypass vulnerability CVE-2022-40684",
    "Severity/Priority": "high",
    "Analyst Next Steps": "1. Verify if the target is a Fortinet appliance\n2. Review the REST API requests to /api/v2/ endpoints\n3. Check for unauthorized SSH keys or new user accounts\n4. Correlate with network activity for persistence indicators\n5. If exploitation is confirmed, isolate the appliance and apply patches",
    "Blind_Spots_False_Positives": "GET requests will be noisy and need to be filtered out or removed from the query based on volume. Restrict analytic to known publicly facing Fortigates, or run analytic as a Hunt until properly tuned. It is also possible the user agent may be filtered on Report Runner or Node.js only for the exploit, however, it is unknown at this if other user agents may be used.",
    "Required_Data_Sources": "Palo Alto Network Threat",
    "First Created": "2026-01-22T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "| tstats count min(_time) as firstTime max(_time) as lastTime from datamodel=Web where Web.url IN (\"*/api/v2/cmdb/system/admin*\")  Web.http_method IN (\"GET\", \"PUT\") by Web.http_user_agent, Web.http_method, Web.url, Web.url_length, Web.src, Web.dest, sourcetype | `drop_dm_object_name(\"Web\")` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `fortinet_appliance_auth_bypass_filter`",
    "Splunk_App_Context": "",
    "Search_Duration": "",
    "Cron Schedule": "",
    "Schedule Window": "",
    "Schedule Priority": "default",
    "Trigger Condition": "",
    "Throttling": {
      "enabled": 0,
      "fields": "",
      "period": ""
    },
    "Risk": [
      {
        "risk_object_field": "$dest$",
        "risk_object_type": "system",
        "risk_score": 81
      }
    ],
    "Notable Title": "Fortinet Appliance Auth bypass",
    "Notable Description": "Potential CVE-2022-40684 against a Fortinet appliance may be occurring against $dest$.",
    "Security Domain": "network",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on ",
    "Drilldown Search (Legacy)": "",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1190",
      "T1133"
    ],
    "Drilldown Name 1": "View the detection results for - \"$dest$\"",
    "Drilldown Search 1": "%original_detection_search% | search  dest = \"$dest$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for - \"$dest$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$dest$\") starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "web_fortinet_appliance_auth_bypass.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "web_jenkins_arbitrary_file_read_cve_2024_23897.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "The following analytic identifies attempts to exploit Jenkins Arbitrary File Read CVE-2024-23897. It detects HTTP POST requests to Jenkins URLs containing \"*/cli?remoting=false*\" with a 200 status code. This activity is significant as it indicates potential unauthorized access to sensitive files on the Jenkins server, such as credentials and private keys. If confirmed malicious, this could lead to severe data breaches, unauthorized access, and further exploitation within the environment.",
    "Assumptions": "Assumptions:\n\nPotential Impact:",
    "origin": "custom",
    "Detection Name": "Jenkins Arbitrary File Read CVE-2024-23897",
    "Objective": "Detect attempts to exploit Jenkins Arbitrary File Read vulnerability CVE-2024-23897",
    "Severity/Priority": "high",
    "Analyst Next Steps": "1. Verify if the target is a Jenkins server\n2. Review the POST requests to /cli endpoint\n3. Check for successful file reads (200 status code)\n4. Analyze what files may have been accessed\n5. If exploitation is confirmed, isolate the Jenkins server and apply patches",
    "Blind_Spots_False_Positives": "False positives should be limited as this detection is based on a specific URL path and HTTP status code. Adjust the search as necessary to fit the environment.",
    "Required_Data_Sources": "Nginx Access",
    "First Created": "2026-01-22T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "| tstats count min(_time) as firstTime max(_time) as lastTime from datamodel=Web where Web.url=\"*/cli?remoting=false*\" Web.status=200 Web.http_method=POST by Web.src, Web.dest, Web.http_user_agent, Web.url Web.status, Web.http_method | `drop_dm_object_name(\"Web\")` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `jenkins_arbitrary_file_read_cve_2024_23897_filter`",
    "Splunk_App_Context": "",
    "Search_Duration": "",
    "Cron Schedule": "",
    "Schedule Window": "",
    "Schedule Priority": "default",
    "Trigger Condition": "",
    "Throttling": {
      "enabled": 0,
      "fields": "",
      "period": ""
    },
    "Risk": [
      {
        "risk_object_field": "$dest$",
        "risk_object_type": "system",
        "risk_score": 81
      }
    ],
    "Notable Title": "Jenkins Arbitrary File Read CVE-2024-23897",
    "Notable Description": "Jenkins Arbitrary File Read CVE-2024-23897 against $dest$ by $src$.",
    "Security Domain": "network",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on ",
    "Drilldown Search (Legacy)": "",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1190"
    ],
    "Drilldown Name 1": "View the detection results for - \"$dest$\"",
    "Drilldown Search 1": "%original_detection_search% | search  dest = \"$dest$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for - \"$dest$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$dest$\") starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "web_jenkins_arbitrary_file_read_cve_2024_23897.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "web_jsp_request_via_url.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "The following analytic identifies URL requests associated with CVE-2022-22965 (Spring4Shell) exploitation attempts, specifically targeting webshell access on a remote webserver. It detects HTTP GET requests with URLs containing \".jsp?cmd=\" or \"j&cmd=\" patterns. This activity is significant as it indicates potential webshell deployment, which can lead to unauthorized remote command execution. If confirmed malicious, attackers could gain control over the webserver, execute arbitrary commands, and potentially escalate privileges, leading to severe data breaches and system compromise.",
    "Assumptions": "Assumptions:\n\nPotential Impact:",
    "origin": "custom",
    "Detection Name": "Web JSP Request via URL",
    "Objective": "Detect Spring4Shell exploitation attempts via JSP webshell URL requests",
    "Severity/Priority": "high",
    "Analyst Next Steps": "1. Review the source IP and destination for legitimacy\n2. Analyze the URL patterns for webshell command indicators\n3. Check if the target system is running Spring Framework\n4. Correlate with endpoint telemetry for process execution\n5. If exploitation is confirmed, isolate the affected system",
    "Blind_Spots_False_Positives": "False positives may be present with legitimate applications. Attempt to filter by dest IP or use Asset groups to restrict to servers.",
    "Required_Data_Sources": "Nginx Access",
    "First Created": "2026-01-22T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "| tstats count from datamodel=Web where Web.http_method IN (\"GET\") Web.url IN (\"*.jsp?cmd=*\",\"*j&cmd=*\") by Web.http_user_agent Web.http_method, Web.url,Web.url_length Web.src, Web.dest sourcetype | `drop_dm_object_name(\"Web\")` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `web_jsp_request_via_url_filter`",
    "Splunk_App_Context": "",
    "Search_Duration": "",
    "Cron Schedule": "",
    "Schedule Window": "",
    "Schedule Priority": "default",
    "Trigger Condition": "",
    "Throttling": {
      "enabled": 0,
      "fields": "",
      "period": ""
    },
    "Risk": [
      {
        "risk_object_field": "$dest$",
        "risk_object_type": "system",
        "risk_score": 72
      }
    ],
    "Notable Title": "Web JSP Request via URL",
    "Notable Description": "A suspicious URL has been requested against $dest$ by $src$, related to web shell activity.",
    "Security Domain": "network",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on ",
    "Drilldown Search (Legacy)": "",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1133",
      "T1190",
      "T1505.003"
    ],
    "Drilldown Name 1": "View the detection results for - \"$dest$\"",
    "Drilldown Search 1": "%original_detection_search% | search  dest = \"$dest$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for - \"$dest$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$dest$\") starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "web_jsp_request_via_url.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "web_log4shell_jndi_payload_injection_attempt.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "The following analytic identifies attempts to inject Log4Shell JNDI payloads via web calls. It leverages the Web datamodel and uses regex to detect patterns like `${jndi:ldap://` in raw web event data, including HTTP headers. This activity is significant because it targets vulnerabilities in Java web applications using Log4j, such as Apache Struts and Solr. If confirmed malicious, this could allow attackers to execute arbitrary code, potentially leading to full system compromise. Immediate investigation is required to determine if the attempt was successful and to mitigate any potential exploitation.",
    "Assumptions": "Assumptions:\n\nPotential Impact:",
    "origin": "custom",
    "Detection Name": "Log4Shell JNDI Payload Injection Attempt",
    "Objective": "Detect attempts to inject Log4Shell JNDI payloads via web calls targeting CVE-2021-44228",
    "Severity/Priority": "medium",
    "Analyst Next Steps": "1. Review the source IP and destination to determine legitimacy\n2. Check if the target system is running vulnerable Log4j versions\n3. Analyze the full URL and payload to understand the injection attempt\n4. Correlate with other security events from the same source\n5. If successful exploitation is suspected, isolate the affected system",
    "Blind_Spots_False_Positives": "If there is a vulnerability scanner looking for log4shells this will trigger, otherwise likely to have low false positives.",
    "Required_Data_Sources": "Nginx Access",
    "First Created": "2026-01-22T00:00:00.000Z",
    "Last Modified": "2026-01-22T00:00:00.000Z",
    "Search String": "| from datamodel Web.Web | regex _raw=\"[jJnNdDiI]{4}(\\:|\\%3A|\\/|\\%2F)\\w+(\\:\\/\\/|\\%3A\\%2F\\%2F)(\\$\\{.*?\\}(\\.)?)?\" | fillnull | stats count by action, category, dest, dest_port, http_content_type, http_method, http_referrer, http_user_agent, site, src, url, url_domain, user | `log4shell_jndi_payload_injection_attempt_filter`",
    "Splunk_App_Context": "",
    "Search_Duration": "",
    "Cron Schedule": "",
    "Schedule Window": "",
    "Schedule Priority": "default",
    "Trigger Condition": "",
    "Throttling": {
      "enabled": 0,
      "fields": "",
      "period": ""
    },
    "Risk": [
      {
        "risk_object_field": "$user$",
        "risk_object_type": "user",
        "risk_score": 15
      },
      {
        "risk_object_field": "$dest$",
        "risk_object_type": "system",
        "risk_score": 15
      }
    ],
    "Notable Title": "Log4Shell JNDI Payload Injection Attempt",
    "Notable Description": "CVE-2021-44228 Log4Shell triggered for host $dest$",
    "Security Domain": "threat",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on ",
    "Drilldown Search (Legacy)": "",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1190",
      "T1133"
    ],
    "Drilldown Name 1": "View the detection results for - \"$user$\" and \"$dest$\"",
    "Drilldown Search 1": "%original_detection_search% | search  user = \"$user$\" dest = \"$dest$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for - \"$user$\" and \"$dest$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$user$\", \"$dest$\") starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "web_log4shell_jndi_payload_injection_attempt.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "access_Access_-_T1213_-_Collection_-_Data_from_Information_Repositories_-_Nexus_Repository_Suspiciou.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "Detects suspicious or automated search activity in Nexus repositories that may indicate adversary reconnaissance, data harvesting, or scraping attempts.\n\nThis detection monitors for abnormal access patterns including:\n- High-volume scraping: More than 200 requests with 100+ unique paths in 5 minutes\n- Broad repository enumeration: Accessing more than 10 different repositories\n- Repeated targeted access: High request count to limited paths (potential credential stuffing or brute force)\n- General suspicious patterns: Elevated request counts or path enumeration above baseline\n\nAdversaries target software repositories to harvest sensitive artifacts such as credentials stored in configuration files, proprietary source code, API keys, or internal tools. This technique is commonly observed in supply chain attacks and insider threat scenarios.\n\nTechnical context: Nexus Repository Manager logs all HTTP requests including method, path, user, source IP, and response status. This detection aggregates successful GET requests over 5-minute windows to identify anomalous access volumes.",
    "Assumptions": "Assumptions:\n\nPotential Impact:",
    "origin": "custom",
    "Detection Name": "Access - T1213 - Collection - Data from Information Repositories - Nexus Repository Suspicious Search or Automated Access",
    "Objective": "Identify users or systems performing abnormal Nexus repository access patterns indicative of automated scraping, enumeration, or data harvesting activities.",
    "Severity/Priority": "high",
    "Analyst Next Steps": "1. Identify if the user account is a service account associated with CI/CD pipelines by checking the username format and correlating with your service account inventory - common patterns include jenkins-svc, gitlab-runner, or build-agent prefixes\n2. Review the user_agent field for automation indicators such as curl, wget, python-requests, go-http-client, or custom scripts versus legitimate tools like Maven, Gradle, npm, or IDE plugins\n3. Examine the accessed_paths values to determine if sensitive repositories were targeted including those containing secrets, credentials, configuration files, internal tools, or proprietary source code\n4. Check if the src_ip belongs to known infrastructure by querying your CMDB or asset inventory - determine if it is a build server, developer workstation, or unknown/external system\n5. Correlate with authentication logs to identify how the user authenticated and whether there are signs of credential compromise such as password spraying, impossible travel, or unusual login times\n6. Investigate the behavior classification context - high_volume_scraping suggests automated exfiltration, broad_repo_enumeration indicates reconnaissance, repeated_targeted_access may indicate brute force or targeted theft\n7. Query historical access patterns for this user over the past 30 days to determine if this volume is anomalous compared to their baseline activity\n8. Check for concurrent suspicious activity from the same src_ip targeting other systems or applications in your environment\n9. Review any recent account changes, permission grants, or role modifications for the affected user account\n10. Contact the user or system owner directly to validate the activity is expected and authorized\n11. If malicious activity is confirmed, disable the user account, rotate any credentials that may have been exposed, and preserve Nexus access logs for forensic analysis\n12. Document findings and escalate to incident response if data exfiltration or supply chain compromise is suspected",
    "Blind_Spots_False_Positives": "Known Detection Gaps:\n- Low-and-slow enumeration staying below threshold values over extended periods\n- Access via internal proxies or load balancers masking true source IP\n- Direct database access bypassing web request logging\n- Legitimate service accounts with stolen credentials appearing as normal CI/CD activity\n- Unauthenticated/anonymous access to public repositories may not populate user field\n\nFalse Positive Scenarios:\n- CI/CD build pipelines (Jenkins, GitLab CI, Azure DevOps) downloading dependencies during large builds\n- Legitimate repository mirroring or backup processes\n- Maven/Gradle/npm dependency resolution for projects with many dependencies\n- Security scanning tools (Nexus IQ, Snyk, WhiteSource) auditing repositories\n- Developer IDE plugins pre-fetching artifacts for autocomplete\n- New project onboarding with first-time dependency downloads\n\nTuning Advice: Create allowlist for known CI/CD service accounts and build server IP ranges. Adjust thresholds based on 30-day baseline analysis.",
    "Required_Data_Sources": "index:nexus sourcetype:nexus:request_log",
    "First Created": "2026-01-24T02:46:33.000Z",
    "Last Modified": "2026-01-26T17:10:08.615Z",
    "Search String": "index=\"nexus\" sourcetype=\"nexus:request_log\" method=GET status=200\n| bin _time span=5m\n| stats count as request_count\n        dc(url_path) as unique_paths\n        dc(scope) as unique_repos\n        sum(bytes) as total_bytes\n        values(url_path) as accessed_paths\n        latest(user_agent) as user_agent\n        by _time, user, src_ip, host\n| where request_count > 50 OR unique_paths > 30 OR unique_repos > 5\n| eval behavior=case(\n    request_count > 200 AND unique_paths > 100, \"high_volume_scraping\",\n    unique_repos > 10, \"broad_repo_enumeration\",\n    request_count > 50 AND unique_paths < 5, \"repeated_targeted_access\",\n    1=1, \"suspicious_search_pattern\"\n)\n| eval bytes_mb=round(total_bytes/1024/1024, 2)\n| eval dest=host\n| table _time, user, src_ip, dest, request_count, unique_paths, unique_repos, bytes_mb, behavior, user_agent",
    "Splunk_App_Context": "",
    "Search_Duration": "",
    "Cron Schedule": "*/15 * * * *",
    "Schedule Window": "5",
    "Schedule Priority": "",
    "Trigger Condition": "Number of results is greater than 0",
    "Throttling": {
      "enabled": 1,
      "fields": "user,src_ip",
      "period": "1h"
    },
    "Risk": [
      {
        "risk_object_field": "$user$",
        "risk_object_type": "user",
        "risk_score": 75
      },
      {
        "risk_object_field": "$dest$",
        "risk_object_type": "system",
        "risk_score": 75
      }
    ],
    "Notable Title": "Suspicious Nexus Repository Access: $behavior$ by $user$ from $src_ip$",
    "Notable Description": "User $user$ from source IP $src_ip$ exhibited suspicious repository access behavior classified as $behavior$ on $dest$. In a 5-minute window, the user made $request_count$ requests accessing $unique_paths$ unique paths across $unique_repos$ repositories, downloading approximately $bytes_mb$ MB of data. User agent: $user_agent$. Investigate for potential data harvesting, credential theft, or supply chain reconnaissance.",
    "Security Domain": "access",
    "Drilldown Name (Legacy)": "",
    "Drilldown Search (Legacy)": "",
    "Drilldown Earliest Offset (Legacy)": null,
    "Drilldown Latest Offset (Legacy)": null,
    "Mitre ID": [
      "T1213"
    ],
    "Proposed Test Plan": "1. Manual validation: Use curl/wget to make 60+ GET requests to repository paths within 5 minutes from test account\n2. Automated test: Deploy script enumerating 10+ different repository scopes to trigger broad_repo_enumeration\n3. Targeted access test: Make 75 requests to same 3 paths to trigger repeated_targeted_access behavior\n4. High-volume test: Execute scraping script downloading 250+ unique artifacts to validate high_volume_scraping detection\n5. Negative test: Verify normal developer activity (10-20 requests) does not trigger alert\n6. Service account test: Confirm allowlisted CI/CD accounts are properly excluded after tuning",
    "Drilldown Name 1": "View Events Associated to this Notable on",
    "Drilldown Search 1": "",
    "Drilldown Earliest 1": "2592000",
    "Drilldown Latest 1": "86400",
    "Drilldown Name 2": "Comprehensive User Investigation - Nexus Repository Activity",
    "Drilldown Search 2": "index=\"nexus\" sourcetype=\"nexus:request_log\" user=\"$user$\"\n| eval investigation_category=case(\n    status=200 AND method=\"GET\" AND (match(url_path, \"(?i)(secret|credential|password|key|token|config)\") OR match(scope, \"(?i)(internal|private|secure)\")), \"1_SENSITIVE_REPO_ACCESS\",\n    status IN (401, 403), \"2_ACCESS_DENIED_ATTEMPTS\",\n    status=404, \"3_PATH_ENUMERATION_404S\",\n    match(user_agent, \"(?i)(curl|wget|python|go-http|powershell|httpie|requests)\"), \"4_AUTOMATION_TOOL_ACCESS\",\n    match(user_agent, \"(?i)(maven|gradle|npm|pip|nuget|docker)\"), \"5_PACKAGE_MANAGER_ACCESS\",\n    method IN (\"PUT\", \"POST\", \"DELETE\"), \"6_WRITE_OPERATIONS\",\n    status=200 AND method=\"GET\", \"7_STANDARD_READ_ACCESS\",\n    1=1, \"9_OTHER_ACTIVITY\"\n)\n| eval key_indicator=case(\n    investigation_category==\"1_SENSITIVE_REPO_ACCESS\", \"SENSITIVE: \".url_path.\" (\".bytes.\" bytes)\",\n    investigation_category==\"2_ACCESS_DENIED_ATTEMPTS\", \"DENIED: \".status.\" - \".url_path,\n    investigation_category==\"3_PATH_ENUMERATION_404S\", \"NOT FOUND: \".url_path,\n    investigation_category==\"4_AUTOMATION_TOOL_ACCESS\", user_agent.\" -> \".url_path,\n    investigation_category==\"6_WRITE_OPERATIONS\", method.\": \".url_path,\n    1=1, method.\" \".url_path.\" [\".status.\"]\"\n)\n| stats\n    earliest(_time) as first_seen,\n    latest(_time) as last_seen,\n    count as event_count,\n    sum(bytes) as total_bytes,\n    dc(url_path) as unique_paths,\n    dc(scope) as unique_repos,\n    dc(src_ip) as unique_source_ips,\n    values(key_indicator) as indicators,\n    values(user_agent) as user_agents,\n    values(src_ip) as source_ips\n    by investigation_category, user\n| eval first_seen=strftime(first_seen, \"%Y-%m-%d %H:%M:%S\"),\n       last_seen=strftime(last_seen, \"%Y-%m-%d %H:%M:%S\"),\n       total_bytes_mb=round(total_bytes/1024/1024, 2)\n| sort investigation_category\n| rename\n    investigation_category as \"Investigation Category\",\n    user as \"Username\",\n    first_seen as \"First Seen\",\n    last_seen as \"Last Seen\",\n    event_count as \"Event Count\",\n    total_bytes_mb as \"Total MB Downloaded\",\n    unique_paths as \"Unique Paths\",\n    unique_repos as \"Unique Repositories\",\n    unique_source_ips as \"Unique Source IPs\",\n    indicators as \"Key Indicators\",\n    user_agents as \"User Agents\",\n    source_ips as \"Source IPs\"",
    "Drilldown Earliest 2": "-7d",
    "Drilldown Latest 2": "now",
    "Drilldown Name 3": "Cross-Source Correlation - Source IP Activity Across Environment",
    "Drilldown Search 3": "index IN (nexus, proxy, firewall, auth, web) src_ip=\"$src_ip$\"\n| eval investigation_category=case(\n    index=\"nexus\" AND sourcetype=\"nexus:request_log\", \"1_NEXUS_REPOSITORY_ACCESS\",\n    index=\"auth\" OR sourcetype=\"*auth*\" OR sourcetype=\"*login*\", \"2_AUTHENTICATION_EVENTS\",\n    index=\"proxy\" OR sourcetype=\"*proxy*\", \"3_PROXY_WEB_TRAFFIC\",\n    index=\"firewall\" OR sourcetype=\"*firewall*\", \"4_FIREWALL_CONNECTIONS\",\n    index=\"web\" OR sourcetype=\"*access*\", \"5_OTHER_WEB_APPLICATIONS\",\n    1=1, \"9_OTHER_ACTIVITY\"\n)\n| eval key_indicator=case(\n    investigation_category==\"1_NEXUS_REPOSITORY_ACCESS\", user.\" accessed \".url_path,\n    investigation_category==\"2_AUTHENTICATION_EVENTS\", coalesce(user, account).\" - \".coalesce(action, status),\n    investigation_category==\"3_PROXY_WEB_TRAFFIC\", coalesce(url, dest).\" [\".coalesce(category, \"uncategorized\").\"]\",\n    investigation_category==\"4_FIREWALL_CONNECTIONS\", src_ip.\" -> \".dest_ip.\":\".dest_port.\" (\".action.\")\",\n    1=1, sourcetype.\" event\"\n)\n| eval normalized_user=coalesce(user, account, src_user, \"unknown\")\n| stats\n    earliest(_time) as first_seen,\n    latest(_time) as last_seen,\n    count as event_count,\n    dc(index) as data_sources,\n    dc(host) as unique_hosts_touched,\n    values(key_indicator) as indicators,\n    values(normalized_user) as associated_users,\n    values(index) as indexes_seen\n    by investigation_category, src_ip\n| eval first_seen=strftime(first_seen, \"%Y-%m-%d %H:%M:%S\"),\n       last_seen=strftime(last_seen, \"%Y-%m-%d %H:%M:%S\")\n| sort investigation_category\n| rename\n    investigation_category as \"Investigation Category\",\n    src_ip as \"Source IP\",\n    first_seen as \"First Seen\",\n    last_seen as \"Last Seen\",\n    event_count as \"Event Count\",\n    data_sources as \"Data Sources\",\n    unique_hosts_touched as \"Unique Hosts\",\n    indicators as \"Key Indicators\",\n    associated_users as \"Associated Users\",\n    indexes_seen as \"Indexes\"",
    "Drilldown Earliest 3": "-7d",
    "Drilldown Latest 3": "now",
    "Drilldown Name 4": "User Baseline Comparison - Deviation Analysis",
    "Drilldown Search 4": "index=\"nexus\" sourcetype=\"nexus:request_log\" method=GET status=200 earliest=-30d\n| bin _time span=1d\n| stats count as daily_requests dc(url_path) as daily_unique_paths dc(scope) as daily_unique_repos by _time, user\n| stats avg(daily_requests) as avg_requests stdev(daily_requests) as stdev_requests avg(daily_unique_paths) as avg_paths avg(daily_unique_repos) as avg_repos latest(daily_requests) as latest_requests latest(daily_unique_paths) as latest_paths by user\n| eval deviation_score=round((latest_requests - avg_requests) / max(stdev_requests, 1), 2)\n| eval risk_level=case(deviation_score > 5, \"CRITICAL\", deviation_score > 3, \"HIGH\", deviation_score > 2, \"MEDIUM\", 1=1, \"LOW\")\n| where user=\"$user$\" OR deviation_score > 3\n| sort -deviation_score\n| rename user as \"Username\", avg_requests as \"Avg Daily Requests\", latest_requests as \"Latest Daily Requests\", deviation_score as \"Deviation Score\", risk_level as \"Risk Level\"",
    "Drilldown Earliest 4": "-7d",
    "Drilldown Latest 4": "now",
    "Drilldown Name 5": "Sensitive Repository Path Analysis",
    "Drilldown Search 5": "index=\"nexus\" sourcetype=\"nexus:request_log\" user=\"$user$\" status=200\n    (url_path=\"*secret*\" OR url_path=\"*credential*\" OR url_path=\"*password*\" OR url_path=\"*config*\" OR url_path=\"*key*\" OR url_path=\"*token*\" OR url_path=\"*internal*\" OR url_path=\"*private*\")\n| stats count as access_count sum(bytes) as total_bytes earliest(_time) as first_access latest(_time) as last_access values(src_ip) as source_ips by url_path, scope, user\n| eval first_access=strftime(first_access, \"%Y-%m-%d %H:%M:%S\"), last_access=strftime(last_access, \"%Y-%m-%d %H:%M:%S\"), total_mb=round(total_bytes/1024/1024, 2)\n| sort -access_count\n| rename url_path as \"Sensitive Path\", scope as \"Repository\", access_count as \"Access Count\", total_mb as \"MB Downloaded\", first_access as \"First Access\", last_access as \"Last Access\", source_ips as \"Source IPs\"",
    "Drilldown Earliest 5": "-7d",
    "Drilldown Latest 5": "now",
    "Drilldown Name 6": "User Agent and Automation Tool Analysis",
    "Drilldown Search 6": "index=\"nexus\" sourcetype=\"nexus:request_log\" user=\"$user$\"\n| eval tool_category=case(\n    match(user_agent, \"(?i)(curl|wget|httpie)\"), \"CLI_DOWNLOAD_TOOLS\",\n    match(user_agent, \"(?i)(python|requests|urllib)\"), \"PYTHON_AUTOMATION\",\n    match(user_agent, \"(?i)(go-http|golang)\"), \"GO_AUTOMATION\",\n    match(user_agent, \"(?i)(powershell|invoke-webrequest)\"), \"POWERSHELL_AUTOMATION\",\n    match(user_agent, \"(?i)(maven|gradle|ant)\"), \"JAVA_BUILD_TOOLS\",\n    match(user_agent, \"(?i)(npm|yarn|node)\"), \"NODEJS_PACKAGE_MANAGERS\",\n    match(user_agent, \"(?i)(pip|conda|poetry)\"), \"PYTHON_PACKAGE_MANAGERS\",\n    match(user_agent, \"(?i)(docker|containerd)\"), \"CONTAINER_TOOLS\",\n    match(user_agent, \"(?i)(intellij|eclipse|vscode)\"), \"IDE_PLUGINS\",\n    match(user_agent, \"(?i)(jenkins|gitlab|azure|bamboo|teamcity)\"), \"CI_CD_SYSTEMS\",\n    1=1, \"OTHER_UNKNOWN\"\n)\n| stats count as request_count dc(url_path) as unique_paths sum(bytes) as total_bytes values(user_agent) as user_agents by tool_category, user\n| eval total_mb=round(total_bytes/1024/1024, 2)\n| sort -request_count\n| rename tool_category as \"Tool Category\", request_count as \"Requests\", unique_paths as \"Unique Paths\", total_mb as \"MB Downloaded\", user_agents as \"User Agent Strings\"",
    "Drilldown Earliest 6": "-7d",
    "Drilldown Latest 6": "now",
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "_sourceFile": "access_Access_-_T1213_-_Collection_-_Data_from_Information_Repositories_-_Nexus_Repository_Suspiciou.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "access_T1621_pingid_new_mfa_method_after_credential_reset_rule.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "The following analytic identifies the provisioning of a new MFA device shortly after a password reset. It detects this activity by correlating Windows Event Log events for password changes (EventID 4723, 4724) with PingID logs indicating device pairing. This behavior is significant as it may indicate a social engineering attack where a threat actor impersonates a valid user to reset credentials and add a new MFA device. If confirmed malicious, this activity could allow an attacker to gain persistent access to the compromised account, bypassing traditional security measures.",
    "Assumptions": "Assumptions:\nTarget environment must ingest Windows Event Log and PingID(PingOne) data sources. Specifically from logs from Active Directory Domain Controllers and JSON logging from a PingID(PingOne) enterprise environment, either via Webhook or Push Subscription.\n\nPotential Impact:",
    "origin": "custom",
    "Detection Name": "PingID New MFA Method After Credential Reset",
    "Objective": "The following analytic identifies the provisioning of a new MFA device shortly after a password reset.",
    "Severity/Priority": "High",
    "Analyst Next Steps": "",
    "Blind_Spots_False_Positives": "False positives may be generated by normal provisioning workflows that generate a password reset followed by a device registration.",
    "Required_Data_Sources": "PingID",
    "First Created": "2025-10-14T00:00:00.000Z",
    "Last Modified": "2026-01-26T17:01:46.464Z",
    "Search String": "`pingid` \"result.message\" = \"*Device Paired*\" | rex field=result.message \"Device (Unp)?(P)?aired (?<device_extract>.+)\" | eval src = coalesce('resources{}.ipaddress','resources{}.devicemodel'), user = upper('actors{}.name'), reason = 'result.message' | eval object=CASE(ISNOTNULL('resources{}.devicemodel'),'resources{}.devicemodel',true(),device_extract) | eval action=CASE(match('result.message',\"Device Paired*\"),\"created\",match('result.message', \"Device Unpaired*\"),\"deleted\") | stats count min(_time) as firstTime, max(_time) as lastTime, values(reason) as reason by src,user,action,object | join type=outer user [| search `wineventlog_security` EventID IN(4723,4724) | eval PW_Change_Time = _time, user = upper(user) | fields user,src_user,EventID,PW_Change_Time] | eval timeDiffRaw = round(lastTime - PW_Change_Time) | eval timeDiff = replace(tostring(abs(timeDiffRaw) ,\"duration\"),\"(\\d*)\\+*(\\d+):(\\d+):(\\d+)\",\"\\2 hours \\3 minutes\") | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `security_content_ctime(PW_Change_Time)` | where timeDiffRaw > 0 AND timeDiffRaw < 3600 | `pingid_new_mfa_method_after_credential_reset_filter`",
    "Splunk_App_Context": "",
    "Search_Duration": "",
    "Cron Schedule": "",
    "Schedule Window": "",
    "Schedule Priority": "default",
    "Trigger Condition": "",
    "Throttling": {
      "enabled": 0,
      "fields": "",
      "period": ""
    },
    "Risk": [
      {
        "risk_object_field": "$user$",
        "risk_object_type": "user",
        "risk_score": 50
      }
    ],
    "Notable Title": "PingID New MFA Method After Credential Reset",
    "Notable Description": "An MFA configuration change was detected for [$user$] within [$timeDiff$] of a password reset. The device [$object$] was $action$.",
    "Security Domain": "access",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on ",
    "Drilldown Search (Legacy)": "",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1621",
      "T1556.006",
      "T1098.005"
    ],
    "Drilldown Name 1": "View the detection results for - \"$user$\"",
    "Drilldown Search 1": "%original_detection_search% | search  user = \"$user$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for - \"$user$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$user$\") starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "access_T1621_pingid_new_mfa_method_after_credential_reset_rule.json"
  },
  {
    "schema_version": "1.2",
    "file_name": "access_T1621_pingid_new_mfa_method_registered_for_user_rule.json",
    "Roles": [
      {
        "Role": "Requestor",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Business Owner",
        "Name": "",
        "Title": ""
      },
      {
        "Role": "Technical Owner",
        "Name": "",
        "Title": ""
      }
    ],
    "Description": "The following analytic detects the registration of a new Multi-Factor Authentication (MFA) method for a PingID (PingOne) account. It leverages JSON logs from PingID, specifically looking for successful device pairing events. This activity is significant as adversaries who gain unauthorized access to a user account may register a new MFA method to maintain persistence. If confirmed malicious, this could allow attackers to bypass existing security measures, maintain long-term access, and potentially escalate their privileges within the compromised environment.",
    "Assumptions": "Assumptions:\nTarget environment must ingest JSON logging from a PingID(PingOne) enterprise environment, either via Webhook or Push Subscription.\n\nPotential Impact:",
    "origin": "custom",
    "Detection Name": "PingID New MFA Method Registered For User",
    "Objective": "The following analytic detects the registration of a new Multi-Factor Authentication (MFA) method for a PingID (PingOne) account.",
    "Severity/Priority": "High",
    "Analyst Next Steps": "",
    "Blind_Spots_False_Positives": "False positives may be generated by normal provisioning workflows for user device registration.",
    "Required_Data_Sources": "PingID",
    "First Created": "2025-05-02T00:00:00.000Z",
    "Last Modified": "2026-01-26T17:01:47.771Z",
    "Search String": "`pingid` \"result.message\"=\"Device Paired*\" result.status=\"SUCCESS\"   | rex field=result.message \"Device (Unp)?(P)?aired (?<device_extract>.+)\" | eval src = coalesce('resources{}.ipaddress','resources{}.devicemodel'), user = upper('actors{}.name'), reason = 'result.message' | eval object=CASE(ISNOTNULL('resources{}.devicemodel'),'resources{}.devicemodel',true(),device_extract) | eval action=CASE(match('result.message',\"Device Paired*\"),\"created\",match('result.message', \"Device Unpaired*\"),\"deleted\") | stats count min(_time) as firstTime, max(_time) as lastTime by src,user,object,action,reason | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `pingid_new_mfa_method_registered_for_user_filter`",
    "Splunk_App_Context": "",
    "Search_Duration": "",
    "Cron Schedule": "",
    "Schedule Window": "",
    "Schedule Priority": "default",
    "Trigger Condition": "",
    "Throttling": {
      "enabled": 0,
      "fields": "",
      "period": ""
    },
    "Risk": [
      {
        "risk_object_field": "$user$",
        "risk_object_type": "user",
        "risk_score": 10
      },
      {
        "risk_object_field": "$src$",
        "risk_object_type": "system",
        "risk_score": 10
      }
    ],
    "Notable Title": "PingID New MFA Method Registered For User",
    "Notable Description": "An MFA configuration change was detected for [$user$], the device [$object$] was $action$.",
    "Security Domain": "access",
    "Drilldown Name (Legacy)": "View Events Associated to this Notable on ",
    "Drilldown Search (Legacy)": "",
    "Drilldown Earliest Offset (Legacy)": "2592000",
    "Drilldown Latest Offset (Legacy)": "86400",
    "Mitre ID": [
      "T1621",
      "T1556.006",
      "T1098.005"
    ],
    "Drilldown Name 1": "View the detection results for - \"$user$\" and \"$src$\"",
    "Drilldown Search 1": "%original_detection_search% | search  user = \"$user$\" src = \"$src$\"",
    "Drilldown Earliest 1": "$info_min_time$",
    "Drilldown Latest 1": "$info_max_time$",
    "Drilldown Name 2": "View risk events for the last 7 days for - \"$user$\" and \"$src$\"",
    "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$user$\", \"$src$\") starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
    "Drilldown Earliest 2": "$info_min_time$",
    "Drilldown Latest 2": "$info_max_time$",
    "Drilldown Name 3": "",
    "Drilldown Search 3": "",
    "Drilldown Earliest 3": null,
    "Drilldown Latest 3": null,
    "Drilldown Name 4": "",
    "Drilldown Search 4": "",
    "Drilldown Earliest 4": null,
    "Drilldown Latest 4": null,
    "Drilldown Name 5": "",
    "Drilldown Search 5": "",
    "Drilldown Earliest 5": null,
    "Drilldown Latest 5": null,
    "Drilldown Name 6": "",
    "Drilldown Search 6": "",
    "Drilldown Earliest 6": null,
    "Drilldown Latest 6": null,
    "Drilldown Name 7": "",
    "Drilldown Search 7": "",
    "Drilldown Earliest 7": null,
    "Drilldown Latest 7": null,
    "Drilldown Name 8": "",
    "Drilldown Search 8": "",
    "Drilldown Earliest 8": null,
    "Drilldown Latest 8": null,
    "Drilldown Name 9": "",
    "Drilldown Search 9": "",
    "Drilldown Earliest 9": null,
    "Drilldown Latest 9": null,
    "Drilldown Name 10": "",
    "Drilldown Search 10": "",
    "Drilldown Earliest 10": null,
    "Drilldown Latest 10": null,
    "Drilldown Name 11": "",
    "Drilldown Search 11": "",
    "Drilldown Earliest 11": null,
    "Drilldown Latest 11": null,
    "Drilldown Name 12": "",
    "Drilldown Search 12": "",
    "Drilldown Earliest 12": null,
    "Drilldown Latest 12": null,
    "Drilldown Name 13": "",
    "Drilldown Search 13": "",
    "Drilldown Earliest 13": null,
    "Drilldown Latest 13": null,
    "Drilldown Name 14": "",
    "Drilldown Search 14": "",
    "Drilldown Earliest 14": null,
    "Drilldown Latest 14": null,
    "Drilldown Name 15": "",
    "Drilldown Search 15": "",
    "Drilldown Earliest 15": null,
    "Drilldown Latest 15": null,
    "Proposed Test Plan": "",
    "_sourceFile": "access_T1621_pingid_new_mfa_method_registered_for_user_rule.json"
  }
]