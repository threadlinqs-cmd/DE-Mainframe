{
  "schema_version": "1.2",
  "file_name": "T1003_001_access_lsass_memory_for_dump_creation.json",
  "Roles": [
    {
      "Role": "Requestor",
      "Name": "",
      "Title": ""
    },
    {
      "Role": "Business Owner",
      "Name": "",
      "Title": ""
    },
    {
      "Role": "Technical Owner",
      "Name": "",
      "Title": ""
    }
  ],
  "Description": "The following analytic detects attempts to dump the LSASS process memory, a common technique in credential dumping attacks. It leverages Sysmon logs, specifically EventCode 10, to identify suspicious call traces to dbgcore.dll and dbghelp.dll associated with lsass.exe. This activity is significant as it often precedes the theft of sensitive login credentials, posing a high risk of unauthorized access to systems and data. If confirmed malicious, attackers could gain access to critical credentials, enabling further compromise and lateral movement within the network.",
  "Assumptions": "Assumptions:\n- Sysmon is deployed with EventCode 10 monitoring enabled\n- LSASS process is properly monitored for access attempts\n- Sysmon TA is configured correctly in Splunk\n\nPotential Impact:\n- Credential theft and session hijacking\n- Unauthorized access to domain accounts\n- Lateral movement using harvested credentials",
  "origin": "custom",
  "Detection Name": "Access LSASS Memory for Dump Creation",
  "Objective": "Detect and alert on attempts to access LSASS process memory for credential dumping, which is a common technique used by adversaries to harvest credentials.",
  "Severity/Priority": "High",
  "Analyst Next Steps": "1. Identify the source process (SourceImage) attempting to access LSASS\n2. Review if the source process is a known credential dumping tool\n3. Check if the affected device has had recent suspicious activity\n4. Investigate the user account associated with the activity\n5. Look for persistence mechanisms on the affected host",
  "Blind_Spots_False_Positives": "Blind Spots:\n- LSASS access via other methods not using dbgcore.dll or dbghelp.dll\n- Memory dumps created through WMI or other techniques\n\nFalse Positives:\n- Administrators creating memory dumps for debugging purposes\n- Legitimate security tools accessing LSASS for protection",
  "Required_Data_Sources": "Sysmon EventID 10",
  "First Created": "2025-10-14T00:00:00.000Z",
  "Last Modified": "2026-01-22T00:00:00.000Z",
  "Search String": "`sysmon` EventCode=10 TargetImage=*lsass.exe CallTrace=*dbgcore.dll* OR CallTrace=*dbghelp.dll* | stats count min(_time) as firstTime max(_time) as lastTime by CallTrace EventID GrantedAccess Guid Opcode ProcessID SecurityID SourceImage SourceProcessGUID SourceProcessId TargetImage TargetProcessGUID TargetProcessId UserID dest granted_access parent_process_exec parent_process_guid parent_process_id parent_process_name parent_process_path process_exec process_guid process_id process_name process_path signature signature_id user_id vendor_product | `security_content_ctime(firstTime)` |`security_content_ctime(lastTime)` | `access_lsass_memory_for_dump_creation_filter`",
  "Splunk_App_Context": "search",
  "Search_Duration": "-15m",
  "Cron Schedule": "*/15 * * * *",
  "Schedule Window": "5",
  "Schedule Priority": "default",
  "Trigger Condition": "Number of results is greater than 0",
  "Throttling": {
    "enabled": 1,
    "fields": "dest,SourceImage",
    "period": "1h"
  },
  "Risk": [
    {
      "risk_object_field": "dest",
      "risk_object_type": "system",
      "risk_score": 63
    }
  ],
  "Notable Title": "LSASS Memory Access Detected for Dump Creation on $dest$",
  "Notable Description": "Process $SourceImage$ injected into $TargetImage$ and was attempted to dump LSASS on $dest$. Adversaries tend to do this when trying to access credential material stored in the process memory of the Local Security Authority Subsystem Service (LSASS).",
  "Security Domain": "endpoint",
  "Drilldown Name (Legacy)": "View Events Associated to this Notable on Endpoint",
  "Drilldown Search (Legacy)": "`sysmon` EventCode=10 dest=\"$dest$\" | table _time SourceImage TargetImage CallTrace GrantedAccess",
  "Drilldown Earliest Offset (Legacy)": "2592000",
  "Drilldown Latest Offset (Legacy)": "86400",
  "Mitre ID": [
    "T1003.001"
  ],
  "Drilldown Name 1": "View the detection results for - \"$dest$\"",
  "Drilldown Search 1": "%original_detection_search% | search  dest = \"$dest$\"",
  "Drilldown Earliest 1": "$info_min_time$",
  "Drilldown Latest 1": "$info_max_time$",
  "Drilldown Name 2": "View risk events for the last 7 days for - \"$dest$\"",
  "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$dest$\") starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
  "Drilldown Earliest 2": "$info_min_time$",
  "Drilldown Latest 2": "$info_max_time$",
  "Drilldown Name 3": "",
  "Drilldown Search 3": "",
  "Drilldown Earliest 3": null,
  "Drilldown Latest 3": null,
  "Drilldown Name 4": "",
  "Drilldown Search 4": "",
  "Drilldown Earliest 4": null,
  "Drilldown Latest 4": null,
  "Drilldown Name 5": "",
  "Drilldown Search 5": "",
  "Drilldown Earliest 5": null,
  "Drilldown Latest 5": null,
  "Drilldown Name 6": "",
  "Drilldown Search 6": "",
  "Drilldown Earliest 6": null,
  "Drilldown Latest 6": null,
  "Drilldown Name 7": "",
  "Drilldown Search 7": "",
  "Drilldown Earliest 7": null,
  "Drilldown Latest 7": null,
  "Drilldown Name 8": "",
  "Drilldown Search 8": "",
  "Drilldown Earliest 8": null,
  "Drilldown Latest 8": null,
  "Drilldown Name 9": "",
  "Drilldown Search 9": "",
  "Drilldown Earliest 9": null,
  "Drilldown Latest 9": null,
  "Drilldown Name 10": "",
  "Drilldown Search 10": "",
  "Drilldown Earliest 10": null,
  "Drilldown Latest 10": null,
  "Drilldown Name 11": "",
  "Drilldown Search 11": "",
  "Drilldown Earliest 11": null,
  "Drilldown Latest 11": null,
  "Drilldown Name 12": "",
  "Drilldown Search 12": "",
  "Drilldown Earliest 12": null,
  "Drilldown Latest 12": null,
  "Drilldown Name 13": "",
  "Drilldown Search 13": "",
  "Drilldown Earliest 13": null,
  "Drilldown Latest 13": null,
  "Drilldown Name 14": "",
  "Drilldown Search 14": "",
  "Drilldown Earliest 14": null,
  "Drilldown Latest 14": null,
  "Drilldown Name 15": "",
  "Drilldown Search 15": "",
  "Drilldown Earliest 15": null,
  "Drilldown Latest 15": null,
  "Proposed Test Plan": ""
}