{
  "schema_version": "1.2",
  "file_name": "application_m365_copilot_jailbreak_attempts.json",
  "Roles": [
    {
      "Role": "Requestor",
      "Name": "",
      "Title": ""
    },
    {
      "Role": "Business Owner",
      "Name": "",
      "Title": ""
    },
    {
      "Role": "Technical Owner",
      "Name": "",
      "Title": ""
    }
  ],
  "Description": "Detects M365 Copilot jailbreak attempts through prompt injection techniques including rule manipulation, system bypass commands, and AI impersonation requests that attempt to circumvent built-in safety controls. The detection searches exported eDiscovery prompt logs for jailbreak keywords like \"pretend you are,\" \"act as,\" \"rules=,\" \"ignore,\" \"bypass,\" and \"override\" in the Subject_Title field, assigning severity scores based on the manipulation type (score of 4 for amoral impersonation or explicit rule injection, score of 3 for entity roleplay or bypass commands). Prompts with a jailbreak score of 2 or higher are flagged, prioritizing the most severe attempts to override AI safety mechanisms through direct instruction injection or unauthorized persona adoption.",
  "Assumptions": "Assumptions:\n- M365 Copilot prompt logs are exported via Microsoft Purview eDiscovery\n- Logs include Subject_Title field containing prompt text\n- Users interacting with M365 Copilot are being monitored\n\nPotential Impact:\n- AI safety control bypass\n- Unauthorized system behavior manipulation\n- Policy violations through prompt injection",
  "origin": "custom",
  "Detection Name": "M365 Copilot Jailbreak Attempts",
  "Objective": "Detect and alert on users attempting M365 Copilot jailbreaks through prompt injection techniques to bypass AI safety controls.",
  "Severity/Priority": "Low",
  "Analyst Next Steps": "1. Review the jailbreak score and triggering keywords\n2. Examine the full prompt text for context and intent\n3. Check user history for previous jailbreak attempts\n4. Verify if user has legitimate reasons (security testing, AI research)\n5. Consider escalation if pattern indicates malicious intent",
  "Blind_Spots_False_Positives": "Blind Spots:\n- Prompts not captured in eDiscovery exports\n- Obfuscated or encoded jailbreak attempts\n- New jailbreak techniques not covered by detection patterns\n\nFalse Positives:\n- Legitimate users discussing AI ethics research, security professionals testing system robustness, developers creating training materials for AI safety, or academic discussions about AI limitations and behavioral constraints may trigger false positives.",
  "Required_Data_Sources": "M365 Exported eDiscovery Prompts",
  "First Created": "2025-09-24T00:00:00.000Z",
  "Last Modified": "2026-01-22T00:00:00.000Z",
  "Search String": "`m365_exported_ediscovery_prompt_logs` | search Subject_Title=\"*pretend you are*\" OR Subject_Title=\"*act as*\" OR Subject_Title=\"*rules=*\" OR Subject_Title=\"*ignore*\" OR Subject_Title=\"*bypass*\" OR Subject_Title=\"*override*\" | eval user = Sender | eval jailbreak_score=case( match(Subject_Title, \"(?i)pretend you are.*amoral\"), 4, match(Subject_Title, \"(?i)act as.*entities\"), 3, match(Subject_Title, \"(?i)(ignore|bypass|override)\"), 3, match(Subject_Title, \"(?i)rules\\s*=\"), 4, 1=1, 1) | where jailbreak_score >= 2 | table _time, user, Subject_Title, jailbreak_score, Workload, Size | sort -jailbreak_score, -_time | `m365_copilot_jailbreak_attempts_filter`",
  "Splunk_App_Context": "search",
  "Search_Duration": "-24h",
  "Cron Schedule": "0 * * * *",
  "Schedule Window": "5",
  "Schedule Priority": "default",
  "Trigger Condition": "Number of results is greater than 0",
  "Throttling": {
    "enabled": 1,
    "fields": "user",
    "period": "1h"
  },
  "Risk": [
    {
      "risk_object_field": "user",
      "risk_object_type": "user",
      "risk_score": 10
    }
  ],
  "Notable Title": "M365 Copilot Jailbreak Attempt Detected for $user$",
  "Notable Description": "User $user$ attempted M365 Copilot Jailbreak with score $jailbreak_score$ using prompt injection techniques to bypass AI safety controls and manipulate system behavior, potentially violating acceptable use policies.",
  "Security Domain": "endpoint",
  "Drilldown Name (Legacy)": "View Events Associated to this Notable on Endpoint",
  "Drilldown Search (Legacy)": "`m365_exported_ediscovery_prompt_logs` Sender=\"$user$\" | table _time Sender Subject_Title Workload Size",
  "Drilldown Earliest Offset (Legacy)": "2592000",
  "Drilldown Latest Offset (Legacy)": "86400",
  "Mitre ID": [
    "T1562.001"
  ],
  "Drilldown Name 1": "View the detection results for - \"$user$\"",
  "Drilldown Search 1": "%original_detection_search% | search  \"$Suser = \"$user$\"",
  "Drilldown Earliest 1": "$info_min_time$",
  "Drilldown Latest 1": "$info_max_time$",
  "Drilldown Name 2": "View risk events for the last 7 days for \"$user$\"",
  "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$user$\", starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
  "Drilldown Earliest 2": "$info_min_time$",
  "Drilldown Latest 2": "$info_max_time$",
  "Drilldown Name 3": "",
  "Drilldown Search 3": "",
  "Drilldown Earliest 3": null,
  "Drilldown Latest 3": null,
  "Drilldown Name 4": "",
  "Drilldown Search 4": "",
  "Drilldown Earliest 4": null,
  "Drilldown Latest 4": null,
  "Drilldown Name 5": "",
  "Drilldown Search 5": "",
  "Drilldown Earliest 5": null,
  "Drilldown Latest 5": null,
  "Drilldown Name 6": "",
  "Drilldown Search 6": "",
  "Drilldown Earliest 6": null,
  "Drilldown Latest 6": null,
  "Drilldown Name 7": "",
  "Drilldown Search 7": "",
  "Drilldown Earliest 7": null,
  "Drilldown Latest 7": null,
  "Drilldown Name 8": "",
  "Drilldown Search 8": "",
  "Drilldown Earliest 8": null,
  "Drilldown Latest 8": null,
  "Drilldown Name 9": "",
  "Drilldown Search 9": "",
  "Drilldown Earliest 9": null,
  "Drilldown Latest 9": null,
  "Drilldown Name 10": "",
  "Drilldown Search 10": "",
  "Drilldown Earliest 10": null,
  "Drilldown Latest 10": null,
  "Drilldown Name 11": "",
  "Drilldown Search 11": "",
  "Drilldown Earliest 11": null,
  "Drilldown Latest 11": null,
  "Drilldown Name 12": "",
  "Drilldown Search 12": "",
  "Drilldown Earliest 12": null,
  "Drilldown Latest 12": null,
  "Drilldown Name 13": "",
  "Drilldown Search 13": "",
  "Drilldown Earliest 13": null,
  "Drilldown Latest 13": null,
  "Drilldown Name 14": "",
  "Drilldown Search 14": "",
  "Drilldown Earliest 14": null,
  "Drilldown Latest 14": null,
  "Drilldown Name 15": "",
  "Drilldown Search 15": "",
  "Drilldown Earliest 15": null,
  "Drilldown Latest 15": null,
  "Proposed Test Plan": ""
}