{
  "schema_version": "1.2",
  "file_name": "network_detect_windows_dns_sigred_via_splunk_stream.json",
  "Roles": [
    {
      "Role": "Requestor",
      "Name": "",
      "Title": ""
    },
    {
      "Role": "Business Owner",
      "Name": "",
      "Title": ""
    },
    {
      "Role": "Technical Owner",
      "Name": "Shannon Davis, Splunk",
      "Title": ""
    }
  ],
  "Description": "The following analytic detects attempts to exploit the SIGRed vulnerability (CVE-2020-1350) in Windows DNS servers. It leverages Splunk Stream DNS and TCP data to identify DNS SIG and KEY records, as well as TCP payloads exceeding 65KB. This activity is significant because SIGRed is a critical wormable vulnerability that allows remote code execution. If confirmed malicious, an attacker could gain unauthorized access, execute arbitrary code, and potentially disrupt services, leading to severe data breaches and infrastructure compromise. Immediate investigation and remediation are crucial to mitigate these risks.",
  "Assumptions": "Assumptions:\nYou must be ingesting Splunk Stream DNS and Splunk Stream TCP. We are detecting SIG and KEY records via stream:dns and TCP payload over 65KB in size via stream:tcp. Replace the macro definitions ('stream:dns' and 'stream:tcp') with configurations for your Splunk environment.\n\nPotential Impact:\nSevere - Remote code execution on Windows DNS servers, potential domain-wide compromise.",
  "origin": "custom",
  "Detection Name": "Detect Windows DNS SIGRed via Splunk Stream",
  "Objective": "Detect attempts to exploit the SIGRed vulnerability (CVE-2020-1350) targeting Windows DNS servers to prevent remote code execution attacks.",
  "Severity/Priority": "high",
  "Analyst Next Steps": "1. Verify whether the DNS server is patched against CVE-2020-1350.\n2. Examine the flow_id for associated suspicious activity.\n3. Check for signs of exploitation or post-exploitation behavior.\n4. Isolate affected systems if exploitation is confirmed.",
  "Blind_Spots_False_Positives": "Known False Positives: unknown",
  "Required_Data_Sources": "Splunk Stream DNS, Splunk Stream TCP",
  "First Created": "2020-07-28T00:00:00.000Z",
  "Last Modified": "2025-05-02T00:00:00.000Z",
  "Search String": "`stream_dns` | spath \"query_type{}\" | search \"query_type{}\" IN (SIG,KEY) | spath protocol_stack | search protocol_stack=\"ip:tcp:dns\" | append [search `stream_tcp` bytes_out>65000] | `detect_windows_dns_sigred_via_splunk_stream_filter` | stats count by flow_id | where count>1 | fields - count",
  "Splunk_App_Context": "",
  "Search_Duration": "",
  "Cron Schedule": "",
  "Schedule Window": "",
  "Schedule Priority": "default",
  "Trigger Condition": "",
  "Throttling": {
    "enabled": 0,
    "fields": "",
    "period": ""
  },
  "Risk": [
    {
      "risk_object_field": "flow_id",
      "risk_object_type": "other",
      "risk_score": 25
    }
  ],
  "Notable Title": "Detect Windows DNS SIGRed via Splunk Stream",
  "Notable Description": "Potential SIGRed activity detected",
  "Security Domain": "network",
  "Drilldown Name (Legacy)": "View Events Associated to this Notable on ",
  "Drilldown Search (Legacy)": "",
  "Drilldown Earliest Offset (Legacy)": "2592000",
  "Drilldown Latest Offset (Legacy)": "86400",
  "Mitre ID": [
    "T1203"
  ],
  "Drilldown Name 1": "",
  "Drilldown Search 1": "",
  "Drilldown Earliest 1": null,
  "Drilldown Latest 1": null,
  "Drilldown Name 2": "",
  "Drilldown Search 2": "",
  "Drilldown Earliest 2": null,
  "Drilldown Latest 2": null,
  "Drilldown Name 3": "",
  "Drilldown Search 3": "",
  "Drilldown Earliest 3": null,
  "Drilldown Latest 3": null,
  "Drilldown Name 4": "",
  "Drilldown Search 4": "",
  "Drilldown Earliest 4": null,
  "Drilldown Latest 4": null,
  "Drilldown Name 5": "",
  "Drilldown Search 5": "",
  "Drilldown Earliest 5": null,
  "Drilldown Latest 5": null,
  "Drilldown Name 6": "",
  "Drilldown Search 6": "",
  "Drilldown Earliest 6": null,
  "Drilldown Latest 6": null,
  "Drilldown Name 7": "",
  "Drilldown Search 7": "",
  "Drilldown Earliest 7": null,
  "Drilldown Latest 7": null,
  "Drilldown Name 8": "",
  "Drilldown Search 8": "",
  "Drilldown Earliest 8": null,
  "Drilldown Latest 8": null,
  "Drilldown Name 9": "",
  "Drilldown Search 9": "",
  "Drilldown Earliest 9": null,
  "Drilldown Latest 9": null,
  "Drilldown Name 10": "",
  "Drilldown Search 10": "",
  "Drilldown Earliest 10": null,
  "Drilldown Latest 10": null,
  "Drilldown Name 11": "",
  "Drilldown Search 11": "",
  "Drilldown Earliest 11": null,
  "Drilldown Latest 11": null,
  "Drilldown Name 12": "",
  "Drilldown Search 12": "",
  "Drilldown Earliest 12": null,
  "Drilldown Latest 12": null,
  "Drilldown Name 13": "",
  "Drilldown Search 13": "",
  "Drilldown Earliest 13": null,
  "Drilldown Latest 13": null,
  "Drilldown Name 14": "",
  "Drilldown Search 14": "",
  "Drilldown Earliest 14": null,
  "Drilldown Latest 14": null,
  "Drilldown Name 15": "",
  "Drilldown Search 15": "",
  "Drilldown Earliest 15": null,
  "Drilldown Latest 15": null,
  "Proposed Test Plan": ""
}