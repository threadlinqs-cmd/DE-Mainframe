{
  "schema_version": "1.2",
  "file_name": "audit_t0000_discovery_demo_detection_as_code.json",
  "Roles": [
    {
      "Role": "Requestor",
      "Name": "Hatim Bakkali",
      "Title": "Senior Developer - Detection Engineering"
    },
    {
      "Role": "Business Owner",
      "Name": "",
      "Title": ""
    },
    {
      "Role": "Technical Owner",
      "Name": "",
      "Title": ""
    }
  ],
  "Description": "Demo detection as code and store the Splunk output search",
  "Assumptions": "Assumptions: nothing\n\nPotential Impact: nothing",
  "origin": "custom",
  "Detection Name": "T0000 - Discovery - DEMO Detection as Code",
  "Objective": "The objective is to demonstrate the \n\nTesting Tuning Demo\n\nTesting Retrofit Demo",
  "Severity/Priority": "critical",
  "Analyst Next Steps": "Review",
  "Blind_Spots_False_Positives": "No Blind spot",
  "Required_Data_Sources": "REST",
  "First Created": "2026-01-02T00:00:00.000Z",
  "Last Modified": "2026-01-05T14:00:34.086Z",
  "Search String": "| rest /servicesNS/-/-/saved/searches splunk_server=local count=0\n| `boc_use_cases`\n\n| eval origin=\"custom\"\n\n| eval \"Detection Name\" = coalesce(title, name, \"UNKNOWN_DETECTION\")\n| eval file_name = lower(replace('Detection Name', \"[^A-Za-z0-9]+\", \"_\")) . \".json\"\n\n| eval Objective   = coalesce(description, \"\")\n| eval Description = coalesce(description, \"\")\n| eval Assumptions = \"\"\n\n| eval \"Search String\"     = coalesce(search, \"\")\n| eval \"Cron Schedule\"     = coalesce(cron_schedule, \"\")\n| eval \"Schedule Window\"   = if(isnull(schedule_window), \"\", tostring(schedule_window))\n| eval \"Schedule Priority\" = coalesce(schedule_priority, \"\")\n\n| eval earliest = coalesce('dispatch.earliest_time', \"\")\n| eval latest   = coalesce('dispatch.latest_time', \"\")\n| eval \"Search_Duration\" = earliest . \" to \" . latest\n\n| eval \"Trigger Condition\" = coalesce(\n    alert_condition,\n    coalesce(alert_type,\"\") . \" \" . coalesce(alert_comparator,\"\") . \" \" . tostring(coalesce(alert_threshold,\"\"))\n)\n\n| eval \"Severity/Priority\"           = coalesce('action.notable.param.severity', \"\")\n| eval \"Analyst Next Steps\"          = coalesce('action.notable.param.next_steps', \"\")\n| eval \"Required_Data_Sources\"       = \"\"\n| eval \"Blind_Spots_False_Positives\" = \"\"\n\n| eval \"First Created\" = null()\n| eval \"Last Modified\" = coalesce(updated, null())\n\n| eval throttle_enabled = tonumber(coalesce('alert.suppress', 0))\n| eval throttle_fields  = coalesce('alert.suppress.fields', \"\")\n| eval throttle_period  = coalesce('alert.suppress.period', \"\")\n| eval throttling_str   = json_object(\n    \"enabled\", throttle_enabled,\n    \"fields\",  throttle_fields,\n    \"period\",  throttle_period\n)\n\n| eval risk_raw = coalesce('action.risk.param._risk', \"[]\")\n| eval risk_raw = replace(risk_raw, \"[\\r\\n]\", \"\")\n| eval risk_array_str = if(match(trim(risk_raw), \"^\\[.*\\]$\"), trim(risk_raw), \"[]\")\n\n| eval \"Notable Title\"       = coalesce('action.notable.param.rule_title', \"\")\n| eval \"Notable Description\" = coalesce('action.notable.param.rule_description', \"\")\n| eval \"Security Domain\"     = coalesce('action.notable.param.security_domain', \"\")\n\n| eval \"Splunk_App_Context\" = coalesce('eai:acl.app', \"\")\n\n| eval annotations_raw = coalesce('action.correlationsearch.annotations', \"{}\")\n| spath input=annotations_raw path=mitre_attack{} output=mitre_mv\n| eval mitre_array_str = \"[\" . if(isnull(mitre_mv) OR mvcount(mitre_mv)=0, \"\", \"\\\"\" . mvjoin(mitre_mv, \"\\\",\\\"\") . \"\\\"\") . \"]\"\n\n\n| eval \"Drilldown Name (Legacy)\"   = coalesce('action.notable.param.drilldown_name', \"\")\n| eval \"Drilldown Search (Legacy)\" = coalesce('action.notable.param.drilldown_search', \"\")\n| eval \"Drilldown Earliest Offset (Legacy)\" = tonumber(coalesce('action.notable.param.drilldown_earliest_offset', \"\"))\n| eval \"Drilldown Latest Offset (Legacy)\"   = tonumber(coalesce('action.notable.param.drilldown_latest_offset', \"\"))\n\n| eval dd_json = coalesce('action.notable.param.drilldown_searches', \"[]\")\n| spath input=dd_json path={}.name            output=dd_name_mv\n| spath input=dd_json path={}.search          output=dd_search_mv\n| spath input=dd_json path={}.earliest_offset output=dd_earliest_mv\n| spath input=dd_json path={}.latest_offset   output=dd_latest_mv\n\n| eval \"Drilldown Name 1\"=coalesce(mvindex(dd_name_mv,0),\"\"),   \"Drilldown Search 1\"=coalesce(mvindex(dd_search_mv,0),\"\"),   \"Drilldown Earliest 1\"=tonumber(mvindex(dd_earliest_mv,0)),   \"Drilldown Latest 1\"=tonumber(mvindex(dd_latest_mv,0))\n| eval \"Drilldown Name 2\"=coalesce(mvindex(dd_name_mv,1),\"\"),   \"Drilldown Search 2\"=coalesce(mvindex(dd_search_mv,1),\"\"),   \"Drilldown Earliest 2\"=tonumber(mvindex(dd_earliest_mv,1)),   \"Drilldown Latest 2\"=tonumber(mvindex(dd_latest_mv,1))\n| eval \"Drilldown Name 3\"=coalesce(mvindex(dd_name_mv,2),\"\"),   \"Drilldown Search 3\"=coalesce(mvindex(dd_search_mv,2),\"\"),   \"Drilldown Earliest 3\"=tonumber(mvindex(dd_earliest_mv,2)),   \"Drilldown Latest 3\"=tonumber(mvindex(dd_latest_mv,2))\n| eval \"Drilldown Name 4\"=coalesce(mvindex(dd_name_mv,3),\"\"),   \"Drilldown Search 4\"=coalesce(mvindex(dd_search_mv,3),\"\"),   \"Drilldown Earliest 4\"=tonumber(mvindex(dd_earliest_mv,3)),   \"Drilldown Latest 4\"=tonumber(mvindex(dd_latest_mv,3))\n| eval \"Drilldown Name 5\"=coalesce(mvindex(dd_name_mv,4),\"\"),   \"Drilldown Search 5\"=coalesce(mvindex(dd_search_mv,4),\"\"),   \"Drilldown Earliest 5\"=tonumber(mvindex(dd_earliest_mv,4)),   \"Drilldown Latest 5\"=tonumber(mvindex(dd_latest_mv,4))\n| eval \"Drilldown Name 6\"=coalesce(mvindex(dd_name_mv,5),\"\"),   \"Drilldown Search 6\"=coalesce(mvindex(dd_search_mv,5),\"\"),   \"Drilldown Earliest 6\"=tonumber(mvindex(dd_earliest_mv,5)),   \"Drilldown Latest 6\"=tonumber(mvindex(dd_latest_mv,5))\n| eval \"Drilldown Name 7\"=coalesce(mvindex(dd_name_mv,6),\"\"),   \"Drilldown Search 7\"=coalesce(mvindex(dd_search_mv,6),\"\"),   \"Drilldown Earliest 7\"=tonumber(mvindex(dd_earliest_mv,6)),   \"Drilldown Latest 7\"=tonumber(mvindex(dd_latest_mv,6))\n| eval \"Drilldown Name 8\"=coalesce(mvindex(dd_name_mv,7),\"\"),   \"Drilldown Search 8\"=coalesce(mvindex(dd_search_mv,7),\"\"),   \"Drilldown Earliest 8\"=tonumber(mvindex(dd_earliest_mv,7)),   \"Drilldown Latest 8\"=tonumber(mvindex(dd_latest_mv,7))\n| eval \"Drilldown Name 9\"=coalesce(mvindex(dd_name_mv,8),\"\"),   \"Drilldown Search 9\"=coalesce(mvindex(dd_search_mv,8),\"\"),   \"Drilldown Earliest 9\"=tonumber(mvindex(dd_earliest_mv,8)),   \"Drilldown Latest 9\"=tonumber(mvindex(dd_latest_mv,8))\n| eval \"Drilldown Name 10\"=coalesce(mvindex(dd_name_mv,9),\"\"),  \"Drilldown Search 10\"=coalesce(mvindex(dd_search_mv,9),\"\"),  \"Drilldown Earliest 10\"=tonumber(mvindex(dd_earliest_mv,9)),  \"Drilldown Latest 10\"=tonumber(mvindex(dd_latest_mv,9))\n| eval \"Drilldown Name 11\"=coalesce(mvindex(dd_name_mv,10),\"\"), \"Drilldown Search 11\"=coalesce(mvindex(dd_search_mv,10),\"\"), \"Drilldown Earliest 11\"=tonumber(mvindex(dd_earliest_mv,10)), \"Drilldown Latest 11\"=tonumber(mvindex(dd_latest_mv,10))\n| eval \"Drilldown Name 12\"=coalesce(mvindex(dd_name_mv,11),\"\"), \"Drilldown Search 12\"=coalesce(mvindex(dd_search_mv,11),\"\"), \"Drilldown Earliest 12\"=tonumber(mvindex(dd_earliest_mv,11)), \"Drilldown Latest 12\"=tonumber(mvindex(dd_latest_mv,11))\n| eval \"Drilldown Name 13\"=coalesce(mvindex(dd_name_mv,12),\"\"), \"Drilldown Search 13\"=coalesce(mvindex(dd_search_mv,12),\"\"), \"Drilldown Earliest 13\"=tonumber(mvindex(dd_earliest_mv,12)), \"Drilldown Latest 13\"=tonumber(mvindex(dd_latest_mv,12))\n| eval \"Drilldown Name 14\"=coalesce(mvindex(dd_name_mv,13),\"\"), \"Drilldown Search 14\"=coalesce(mvindex(dd_search_mv,13),\"\"), \"Drilldown Earliest 14\"=tonumber(mvindex(dd_earliest_mv,13)), \"Drilldown Latest 14\"=tonumber(mvindex(dd_latest_mv,13))\n| eval \"Drilldown Name 15\"=coalesce(mvindex(dd_name_mv,14),\"\"), \"Drilldown Search 15\"=coalesce(mvindex(dd_search_mv,14),\"\"), \"Drilldown Earliest 15\"=tonumber(mvindex(dd_earliest_mv,14)), \"Drilldown Latest 15\"=tonumber(mvindex(dd_latest_mv,14))\n\n| eval roles_array_str = \"[{\\\"Role\\\":\\\"Requestor\\\",\\\"Name\\\":\\\"Name1\\\",\\\"Title\\\":\\\"Role1\\\"},{\\\"Role\\\":\\\"Business Owner\\\",\\\"Name\\\":\\\"Name2\\\",\\\"Title\\\":\\\"Role2\\\"},{\\\"Role\\\":\\\"Technical Owner\\\",\\\"Name\\\":\\\"Name3\\\",\\\"Title\\\":\\\"Role3\\\"}]\"\n\n\n| eval json_obj = json_object(\n  \"schema_version\",\"1.2\",\n  \"file_name\", file_name,\n  \"Roles\",\"__ROLES__\",\n  \"Description\", Description,\n  \"Assumptions\", Assumptions,\n  \"origin\", origin,\n\n  \"Detection Name\", 'Detection Name',\n  \"Objective\", Objective,\n  \"Severity/Priority\", 'Severity/Priority',\n  \"Analyst Next Steps\", 'Analyst Next Steps',\n  \"Blind_Spots_False_Positives\", 'Blind_Spots_False_Positives',\n  \"Required_Data_Sources\", 'Required_Data_Sources',\n  \"First Created\", 'First Created',\n  \"Last Modified\", 'Last Modified',\n  \"Search String\", 'Search String',\n  \"Splunk_App_Context\", 'Splunk_App_Context',\n  \"Search_Duration\", 'Search_Duration',\n  \"Cron Schedule\", 'Cron Schedule',\n  \"Schedule Window\", 'Schedule Window',\n  \"Schedule Priority\", 'Schedule Priority',\n  \"Trigger Condition\", 'Trigger Condition',\n\n  \"Throttling\", \"__THROTTLING__\",\n\n  \"Risk\", \"__RISK__\",\n\n  \"Notable Title\", 'Notable Title',\n  \"Notable Description\", 'Notable Description',\n  \"Security Domain\", 'Security Domain',\n\n  \"Drilldown Name (Legacy)\", 'Drilldown Name (Legacy)',\n  \"Drilldown Search (Legacy)\", 'Drilldown Search (Legacy)',\n  \"Drilldown Earliest Offset (Legacy)\", 'Drilldown Earliest Offset (Legacy)',\n  \"Drilldown Latest Offset (Legacy)\", 'Drilldown Latest Offset (Legacy)',\n\n  \"Drilldown Name 1\", 'Drilldown Name 1', \"Drilldown Search 1\", 'Drilldown Search 1', \"Drilldown Earliest 1\", 'Drilldown Earliest 1', \"Drilldown Latest 1\", 'Drilldown Latest 1',\n  \"Drilldown Name 2\", 'Drilldown Name 2', \"Drilldown Search 2\", 'Drilldown Search 2', \"Drilldown Earliest 2\", 'Drilldown Earliest 2', \"Drilldown Latest 2\", 'Drilldown Latest 2',\n  \"Drilldown Name 3\", 'Drilldown Name 3', \"Drilldown Search 3\", 'Drilldown Search 3', \"Drilldown Earliest 3\", 'Drilldown Earliest 3', \"Drilldown Latest 3\", 'Drilldown Latest 3',\n  \"Drilldown Name 4\", 'Drilldown Name 4', \"Drilldown Search 4\", 'Drilldown Search 4', \"Drilldown Earliest 4\", 'Drilldown Earliest 4', \"Drilldown Latest 4\", 'Drilldown Latest 4',\n  \"Drilldown Name 5\", 'Drilldown Name 5', \"Drilldown Search 5\", 'Drilldown Search 5', \"Drilldown Earliest 5\", 'Drilldown Earliest 5', \"Drilldown Latest 5\", 'Drilldown Latest 5',\n  \"Drilldown Name 6\", 'Drilldown Name 6', \"Drilldown Search 6\", 'Drilldown Search 6', \"Drilldown Earliest 6\", 'Drilldown Earliest 6', \"Drilldown Latest 6\", 'Drilldown Latest 6',\n  \"Drilldown Name 7\", 'Drilldown Name 7', \"Drilldown Search 7\", 'Drilldown Search 7', \"Drilldown Earliest 7\", 'Drilldown Earliest 7', \"Drilldown Latest 7\", 'Drilldown Latest 7',\n  \"Drilldown Name 8\", 'Drilldown Name 8', \"Drilldown Search 8\", 'Drilldown Search 8', \"Drilldown Earliest 8\", 'Drilldown Earliest 8', \"Drilldown Latest 8\", 'Drilldown Latest 8',\n  \"Drilldown Name 9\", 'Drilldown Name 9', \"Drilldown Search 9\", 'Drilldown Search 9', \"Drilldown Earliest 9\", 'Drilldown Earliest 9', \"Drilldown Latest 9\", 'Drilldown Latest 9',\n  \"Drilldown Name 10\", 'Drilldown Name 10', \"Drilldown Search 10\", 'Drilldown Search 10', \"Drilldown Earliest 10\", 'Drilldown Earliest 10', \"Drilldown Latest 10\", 'Drilldown Latest 10',\n  \"Drilldown Name 11\", 'Drilldown Name 11', \"Drilldown Search 11\", 'Drilldown Search 11', \"Drilldown Earliest 11\", 'Drilldown Earliest 11', \"Drilldown Latest 11\", 'Drilldown Latest 11',\n  \"Drilldown Name 12\", 'Drilldown Name 12', \"Drilldown Search 12\", 'Drilldown Search 12', \"Drilldown Earliest 12\", 'Drilldown Earliest 12', \"Drilldown Latest 12\", 'Drilldown Latest 12',\n  \"Drilldown Name 13\", 'Drilldown Name 13', \"Drilldown Search 13\", 'Drilldown Search 13', \"Drilldown Earliest 13\", 'Drilldown Earliest 13', \"Drilldown Latest 13\", 'Drilldown Latest 13',\n  \"Drilldown Name 14\", 'Drilldown Name 14', \"Drilldown Search 14\", 'Drilldown Search 14', \"Drilldown Earliest 14\", 'Drilldown Earliest 14', \"Drilldown Latest 14\", 'Drilldown Latest 14',\n  \"Drilldown Name 15\", 'Drilldown Name 15', \"Drilldown Search 15\", 'Drilldown Search 15', \"Drilldown Earliest 15\", 'Drilldown Earliest 15', \"Drilldown Latest 15\", 'Drilldown Latest 15',\n\n  \"Mitre ID\", \"__MITRE__\"\n)\n\n| eval json_obj = replace(json_obj, \"\\\"__ROLES__\\\"\", roles_array_str)\n| eval json_obj = replace(json_obj, \"\\\"__THROTTLING__\\\"\", throttling_str)\n| eval json_obj = replace(json_obj, \"\\\"__MITRE__\\\"\", mitre_array_str)\n| eval json_obj = replace(json_obj, \"\\\"__RISK__\\\"\", risk_array_str)\n\n| eval json = json_obj\n| table title json",
  "Splunk_App_Context": "",
  "Search_Duration": "",
  "Cron Schedule": "29 * * * *",
  "Schedule Window": "auto",
  "Schedule Priority": "higher",
  "Trigger Condition": "",
  "Throttling": {
    "enabled": 1,
    "fields": "src,src_user,command_line",
    "period": "3000s"
  },
  "Risk": [
    {
      "risk_object_field": "$src$",
      "risk_object_type": "user",
      "risk_score": 200
    }
  ],
  "Notable Title": "T0000 - Discovery - DEMO Detection as Code",
  "Notable Description": "T0000 - Discovery - DEMO Detection as Code detected on ",
  "Security Domain": "audit",
  "Drilldown Name (Legacy)": "View Events Associated to this Notable on DrillDown1",
  "Drilldown Search (Legacy)": "index=linux AND host=$src$ AND type=SYSCALL AND AUID=$src_user$ \n    AND (SYSCALL=exec* OR (( syscall IN (59,322) AND arch=c000003e) OR( syscall IN (11,358) AND arch=40000003)) )\n    AND earliest=$dd_min_time$ AND latest=$dd_max_time$ \n|rename  auid as src_uid, AUID as src_user, euid as dest_uid, EUID as dest_user, host as src, arch AS t_arch, a* as s_a*\n| table _time src msg, t_arch, uid, UID, src_uid, src_user, dest_uid, dest_user, ses, ppid pid exe comm syscall, SYSCALL\n| join type=left msg \n    [| search index=linux AND host=$src$ AND type=EXECVE AND earliest=$dd_min_time$ AND latest=$dd_max_time$  \n    | rename argc AS t_argc, arch AS t_arch, auid AS t_auid, app AS t_app, action AS t_action, a* AS e_a*\n    | foreach e_a* \n        [ eval <<FIELD>>=if(isnotnull(<<FIELD>>), if(match(<<FIELD>>, \"^([A-F0-9]{2})+$\"), urldecode(replace(<<FIELD>>,\"([A-F0-9]{2})\",\"%\\1\")) , <<FIELD>>), null() )] \n     | foreach e_a* [eval command=mvappend(command, '<<FIELD>>')]  | eval command = mvjoin(command, \" \")\n     | table msg, command, t_argc ] \n| rename t_argc as argc, t_arch as arch\n| table _time src uid, UID, src_uid, src_user, dest_uid, dest_user, ses, command, argc, ppid pid exe comm syscall, SYSCALL, arch\n| sort 0 + _time\n",
  "Drilldown Earliest Offset (Legacy)": "2592000",
  "Drilldown Latest Offset (Legacy)": "86400",
  "Mitre ID": [],
  "Drilldown Name 1": "View Events Associated to this Notable on DrillDown2",
  "Drilldown Search 1": "index=linux AND host=$src$ AND type=SYSCALL AND AUID=$src_user$ \n    AND (SYSCALL=exec* OR (( syscall IN (59,322) AND arch=c000003e) OR( syscall IN (11,358) AND arch=40000003)) )\n    AND earliest=$dd_min_time$ AND latest=$dd_max_time$ \n|rename  auid as src_uid, AUID as src_user, euid as dest_uid, EUID as dest_user, host as src, arch AS t_arch, a* as s_a*\n| table _time src msg, t_arch, uid, UID, src_uid, src_user, dest_uid, dest_user, ses, ppid pid exe comm syscall, SYSCALL\n| join type=left msg \n    [| search index=linux AND host=$src$ AND type=EXECVE AND earliest=$dd_min_time$ AND latest=$dd_max_time$  \n    | rename argc AS t_argc, arch AS t_arch, auid AS t_auid, app AS t_app, action AS t_action, a* AS e_a*\n    | foreach e_a* \n        [ eval <<FIELD>>=if(isnotnull(<<FIELD>>), if(match(<<FIELD>>, \"^([A-F0-9]{2})+$\"), urldecode(replace(<<FIELD>>,\"([A-F0-9]{2})\",\"%\\1\")) , <<FIELD>>), null() )] \n     | foreach e_a* [eval command=mvappend(command, '<<FIELD>>')]  | eval command = mvjoin(command, \" \")\n     | table msg, command, t_argc ] \n| rename t_argc as argc, t_arch as arch\n| table _time src uid, UID, src_uid, src_user, dest_uid, dest_user, ses, command, argc, ppid pid exe comm syscall, SYSCALL, arch\n| sort 0 + _time\n",
  "Drilldown Earliest 1": "",
  "Drilldown Latest 1": "",
  "Drilldown Name 2": "",
  "Drilldown Search 2": "",
  "Drilldown Earliest 2": null,
  "Drilldown Latest 2": null,
  "Drilldown Name 3": "",
  "Drilldown Search 3": "",
  "Drilldown Earliest 3": null,
  "Drilldown Latest 3": null,
  "Drilldown Name 4": "",
  "Drilldown Search 4": "",
  "Drilldown Earliest 4": null,
  "Drilldown Latest 4": null,
  "Drilldown Name 5": "",
  "Drilldown Search 5": "",
  "Drilldown Earliest 5": null,
  "Drilldown Latest 5": null,
  "Drilldown Name 6": "",
  "Drilldown Search 6": "",
  "Drilldown Earliest 6": null,
  "Drilldown Latest 6": null,
  "Drilldown Name 7": "",
  "Drilldown Search 7": "",
  "Drilldown Earliest 7": null,
  "Drilldown Latest 7": null,
  "Drilldown Name 8": "",
  "Drilldown Search 8": "",
  "Drilldown Earliest 8": null,
  "Drilldown Latest 8": null,
  "Drilldown Name 9": "",
  "Drilldown Search 9": "",
  "Drilldown Earliest 9": null,
  "Drilldown Latest 9": null,
  "Drilldown Name 10": "",
  "Drilldown Search 10": "",
  "Drilldown Earliest 10": null,
  "Drilldown Latest 10": null,
  "Drilldown Name 11": "",
  "Drilldown Search 11": "",
  "Drilldown Earliest 11": null,
  "Drilldown Latest 11": null,
  "Drilldown Name 12": "",
  "Drilldown Search 12": "",
  "Drilldown Earliest 12": null,
  "Drilldown Latest 12": null,
  "Drilldown Name 13": "",
  "Drilldown Search 13": "",
  "Drilldown Earliest 13": null,
  "Drilldown Latest 13": null,
  "Drilldown Name 14": "",
  "Drilldown Search 14": "",
  "Drilldown Earliest 14": null,
  "Drilldown Latest 14": null,
  "Drilldown Name 15": "",
  "Drilldown Search 15": "",
  "Drilldown Earliest 15": null,
  "Drilldown Latest 15": null
}