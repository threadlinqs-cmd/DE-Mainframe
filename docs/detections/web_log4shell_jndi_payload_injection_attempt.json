{
  "schema_version": "1.2",
  "file_name": "web_log4shell_jndi_payload_injection_attempt.json",
  "Roles": [
    {
      "Role": "Requestor",
      "Name": "",
      "Title": ""
    },
    {
      "Role": "Business Owner",
      "Name": "",
      "Title": ""
    },
    {
      "Role": "Technical Owner",
      "Name": "",
      "Title": ""
    }
  ],
  "Description": "The following analytic identifies attempts to inject Log4Shell JNDI payloads via web calls. It leverages the Web datamodel and uses regex to detect patterns like `${jndi:ldap://` in raw web event data, including HTTP headers. This activity is significant because it targets vulnerabilities in Java web applications using Log4j, such as Apache Struts and Solr. If confirmed malicious, this could allow attackers to execute arbitrary code, potentially leading to full system compromise. Immediate investigation is required to determine if the attempt was successful and to mitigate any potential exploitation.",
  "Assumptions": "Assumptions:\n\nPotential Impact:",
  "origin": "custom",
  "Detection Name": "Log4Shell JNDI Payload Injection Attempt",
  "Objective": "Detect attempts to inject Log4Shell JNDI payloads via web calls targeting CVE-2021-44228",
  "Severity/Priority": "medium",
  "Analyst Next Steps": "1. Review the source IP and destination to determine legitimacy\n2. Check if the target system is running vulnerable Log4j versions\n3. Analyze the full URL and payload to understand the injection attempt\n4. Correlate with other security events from the same source\n5. If successful exploitation is suspected, isolate the affected system",
  "Blind_Spots_False_Positives": "If there is a vulnerability scanner looking for log4shells this will trigger, otherwise likely to have low false positives.",
  "Required_Data_Sources": "Nginx Access",
  "First Created": "2026-01-22T00:00:00.000Z",
  "Last Modified": "2026-01-22T00:00:00.000Z",
  "Search String": "| from datamodel Web.Web | regex _raw=\"[jJnNdDiI]{4}(\\:|\\%3A|\\/|\\%2F)\\w+(\\:\\/\\/|\\%3A\\%2F\\%2F)(\\$\\{.*?\\}(\\.)?)?\" | fillnull | stats count by action, category, dest, dest_port, http_content_type, http_method, http_referrer, http_user_agent, site, src, url, url_domain, user | `log4shell_jndi_payload_injection_attempt_filter`",
  "Splunk_App_Context": "",
  "Search_Duration": "",
  "Cron Schedule": "",
  "Schedule Window": "",
  "Schedule Priority": "default",
  "Trigger Condition": "",
  "Throttling": {
    "enabled": 0,
    "fields": "",
    "period": ""
  },
  "Risk": [
    {
      "risk_object_field": "$user$",
      "risk_object_type": "user",
      "risk_score": 15
    },
    {
      "risk_object_field": "$dest$",
      "risk_object_type": "system",
      "risk_score": 15
    }
  ],
  "Notable Title": "Log4Shell JNDI Payload Injection Attempt",
  "Notable Description": "CVE-2021-44228 Log4Shell triggered for host $dest$",
  "Security Domain": "threat",
  "Drilldown Name (Legacy)": "View Events Associated to this Notable on ",
  "Drilldown Search (Legacy)": "",
  "Drilldown Earliest Offset (Legacy)": "2592000",
  "Drilldown Latest Offset (Legacy)": "86400",
  "Mitre ID": [
    "T1190",
    "T1133"
  ],
  "Drilldown Name 1": "View the detection results for - \"$user$\" and \"$dest$\"",
  "Drilldown Search 1": "%original_detection_search% | search  user = \"$user$\" dest = \"$dest$\"",
  "Drilldown Earliest 1": "$info_min_time$",
  "Drilldown Latest 1": "$info_max_time$",
  "Drilldown Name 2": "View risk events for the last 7 days for - \"$user$\" and \"$dest$\"",
  "Drilldown Search 2": "| from datamodel Risk.All_Risk | search normalized_risk_object IN (\"$user$\", \"$dest$\") starthoursago=168  | stats count min(_time) as firstTime max(_time) as lastTime values(search_name) as \"Search Name\" values(risk_message) as \"Risk Message\" values(analyticstories) as \"Analytic Stories\" values(annotations._all) as \"Annotations\" values(annotations.mitre_attack.mitre_tactic) as \"ATT&CK Tactics\" by normalized_risk_object | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`",
  "Drilldown Earliest 2": "$info_min_time$",
  "Drilldown Latest 2": "$info_max_time$",
  "Drilldown Name 3": "",
  "Drilldown Search 3": "",
  "Drilldown Earliest 3": null,
  "Drilldown Latest 3": null,
  "Drilldown Name 4": "",
  "Drilldown Search 4": "",
  "Drilldown Earliest 4": null,
  "Drilldown Latest 4": null,
  "Drilldown Name 5": "",
  "Drilldown Search 5": "",
  "Drilldown Earliest 5": null,
  "Drilldown Latest 5": null,
  "Drilldown Name 6": "",
  "Drilldown Search 6": "",
  "Drilldown Earliest 6": null,
  "Drilldown Latest 6": null,
  "Drilldown Name 7": "",
  "Drilldown Search 7": "",
  "Drilldown Earliest 7": null,
  "Drilldown Latest 7": null,
  "Drilldown Name 8": "",
  "Drilldown Search 8": "",
  "Drilldown Earliest 8": null,
  "Drilldown Latest 8": null,
  "Drilldown Name 9": "",
  "Drilldown Search 9": "",
  "Drilldown Earliest 9": null,
  "Drilldown Latest 9": null,
  "Drilldown Name 10": "",
  "Drilldown Search 10": "",
  "Drilldown Earliest 10": null,
  "Drilldown Latest 10": null,
  "Drilldown Name 11": "",
  "Drilldown Search 11": "",
  "Drilldown Earliest 11": null,
  "Drilldown Latest 11": null,
  "Drilldown Name 12": "",
  "Drilldown Search 12": "",
  "Drilldown Earliest 12": null,
  "Drilldown Latest 12": null,
  "Drilldown Name 13": "",
  "Drilldown Search 13": "",
  "Drilldown Earliest 13": null,
  "Drilldown Latest 13": null,
  "Drilldown Name 14": "",
  "Drilldown Search 14": "",
  "Drilldown Earliest 14": null,
  "Drilldown Latest 14": null,
  "Drilldown Name 15": "",
  "Drilldown Search 15": "",
  "Drilldown Earliest 15": null,
  "Drilldown Latest 15": null,
  "Proposed Test Plan": ""
}