{
  "schema_version": "1.2",
  "file_name": "network_windows_ad_rogue_domain_controller_network_activity.json",
  "Roles": [
    {
      "Role": "Requestor",
      "Name": "",
      "Title": ""
    },
    {
      "Role": "Business Owner",
      "Name": "",
      "Title": ""
    },
    {
      "Role": "Technical Owner",
      "Name": "Dean Luxton",
      "Title": ""
    }
  ],
  "Description": "The following analytic identifies unauthorized replication RPC calls from non-domain controller devices. It leverages Zeek wire data to detect specific RPC operations like DrsReplicaAdd and DRSGetNCChanges, filtering out legitimate domain controllers. This activity is significant as it may indicate an attempt to introduce a rogue domain controller, which can compromise the integrity of the Active Directory environment. If confirmed malicious, this could allow attackers to manipulate directory data, escalate privileges, and persist within the network, posing a severe security risk.",
  "Assumptions": "Assumptions:\nRun zeek on domain controllers to capture the DCE RPC calls, ensure the domain controller categories are defined in Assets and Identities.\n\nPotential Impact:\nCritical - Rogue domain controller introduction can lead to AD compromise, privilege escalation, and persistence.",
  "origin": "custom",
  "Detection Name": "Windows AD Rogue Domain Controller Network Activity",
  "Objective": "Detect unauthorized AD replication RPC calls from non-domain controller devices to identify potential rogue domain controller attacks.",
  "Severity/Priority": "critical",
  "Analyst Next Steps": "1. Verify the source device category and whether it is a legitimate DC.\n2. Investigate the RPC operations being performed.\n3. Check for other indicators of DCShadow or rogue DC attacks.\n4. Isolate the suspicious device immediately if confirmed malicious.",
  "Blind_Spots_False_Positives": "Known False Positives: None.",
  "Required_Data_Sources": "Zeek RPC logs, Assets and Identities with domain controller categories",
  "First Created": "2023-11-07T00:00:00.000Z",
  "Last Modified": "2025-05-02T00:00:00.000Z",
  "Search String": "`zeek_rpc` DrsReplicaAdd OR DRSGetNCChanges | where NOT (dest_category=\"Domain Controller\") OR NOT (src_category=\"Domain Controller\") | fillnull value=\"Unknown\" src_category, dest_category | table _time endpoint operation src src_category dest dest_category | `windows_ad_rogue_domain_controller_network_activity_filter`",
  "Splunk_App_Context": "",
  "Search_Duration": "",
  "Cron Schedule": "",
  "Schedule Window": "",
  "Schedule Priority": "default",
  "Trigger Condition": "",
  "Throttling": {
    "enabled": 0,
    "fields": "",
    "period": ""
  },
  "Risk": [
    {
      "risk_object_field": "dest",
      "risk_object_type": "system",
      "risk_score": 100
    }
  ],
  "Notable Title": "Windows AD Rogue Domain Controller Network Activity",
  "Notable Description": "Rogue DC Activity Detected from $src_category$ device $src$ to $dest$ ($dest_category$)",
  "Security Domain": "network",
  "Drilldown Name (Legacy)": "View Events Associated to this Notable on ",
  "Drilldown Search (Legacy)": "",
  "Drilldown Earliest Offset (Legacy)": "2592000",
  "Drilldown Latest Offset (Legacy)": "86400",
  "Mitre ID": [
    "T1207"
  ],
  "Drilldown Name 1": "",
  "Drilldown Search 1": "",
  "Drilldown Earliest 1": null,
  "Drilldown Latest 1": null,
  "Drilldown Name 2": "",
  "Drilldown Search 2": "",
  "Drilldown Earliest 2": null,
  "Drilldown Latest 2": null,
  "Drilldown Name 3": "",
  "Drilldown Search 3": "",
  "Drilldown Earliest 3": null,
  "Drilldown Latest 3": null,
  "Drilldown Name 4": "",
  "Drilldown Search 4": "",
  "Drilldown Earliest 4": null,
  "Drilldown Latest 4": null,
  "Drilldown Name 5": "",
  "Drilldown Search 5": "",
  "Drilldown Earliest 5": null,
  "Drilldown Latest 5": null,
  "Drilldown Name 6": "",
  "Drilldown Search 6": "",
  "Drilldown Earliest 6": null,
  "Drilldown Latest 6": null,
  "Drilldown Name 7": "",
  "Drilldown Search 7": "",
  "Drilldown Earliest 7": null,
  "Drilldown Latest 7": null,
  "Drilldown Name 8": "",
  "Drilldown Search 8": "",
  "Drilldown Earliest 8": null,
  "Drilldown Latest 8": null,
  "Drilldown Name 9": "",
  "Drilldown Search 9": "",
  "Drilldown Earliest 9": null,
  "Drilldown Latest 9": null,
  "Drilldown Name 10": "",
  "Drilldown Search 10": "",
  "Drilldown Earliest 10": null,
  "Drilldown Latest 10": null,
  "Drilldown Name 11": "",
  "Drilldown Search 11": "",
  "Drilldown Earliest 11": null,
  "Drilldown Latest 11": null,
  "Drilldown Name 12": "",
  "Drilldown Search 12": "",
  "Drilldown Earliest 12": null,
  "Drilldown Latest 12": null,
  "Drilldown Name 13": "",
  "Drilldown Search 13": "",
  "Drilldown Earliest 13": null,
  "Drilldown Latest 13": null,
  "Drilldown Name 14": "",
  "Drilldown Search 14": "",
  "Drilldown Earliest 14": null,
  "Drilldown Latest 14": null,
  "Drilldown Name 15": "",
  "Drilldown Search 15": "",
  "Drilldown Earliest 15": null,
  "Drilldown Latest 15": null,
  "Proposed Test Plan": ""
}