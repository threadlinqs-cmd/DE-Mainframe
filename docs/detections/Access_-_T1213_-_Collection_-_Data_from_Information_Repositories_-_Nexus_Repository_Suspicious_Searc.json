{
  "schema_version": "1.2",
  "file_name": "Access_-_T1213_-_Collection_-_Data_from_Information_Repositories_-_Nexus_Repository_Suspicious_Searc.json",
  "Roles": [
    {
      "Role": "Requestor",
      "Name": "",
      "Title": ""
    },
    {
      "Role": "Business Owner",
      "Name": "",
      "Title": ""
    },
    {
      "Role": "Technical Owner",
      "Name": "",
      "Title": ""
    }
  ],
  "Description": "Detects suspicious or automated search activity in Nexus repositories that may indicate adversary reconnaissance, data harvesting, or scraping attempts.\n\nThis detection monitors for abnormal access patterns including:\n- High-volume scraping: More than 200 requests with 100+ unique paths in 5 minutes\n- Broad repository enumeration: Accessing more than 10 different repositories\n- Repeated targeted access: High request count to limited paths (potential credential stuffing or brute force)\n- General suspicious patterns: Elevated request counts or path enumeration above baseline\n\nAdversaries target software repositories to harvest sensitive artifacts such as credentials stored in configuration files, proprietary source code, API keys, or internal tools. This technique is commonly observed in supply chain attacks and insider threat scenarios.\n\nTechnical context: Nexus Repository Manager logs all HTTP requests including method, path, user, source IP, and response status. This detection aggregates successful GET requests over 5-minute windows to identify anomalous access volumes.",
  "Assumptions": "Assumptions:\n\nPotential Impact:",
  "origin": "custom",
  "Detection Name": "Access - T1213 - Collection - Data from Information Repositories - Nexus Repository Suspicious Search or Automated Access",
  "Objective": "Identify users or systems performing abnormal Nexus repository access patterns indicative of automated scraping, enumeration, or data harvesting activities.",
  "Severity/Priority": "High",
  "Analyst Next Steps": "1. Identify if the user account is a service account associated with CI/CD pipelines by checking the username format and correlating with your service account inventory - common patterns include jenkins-svc, gitlab-runner, or build-agent prefixes\n2. Review the user_agent field for automation indicators such as curl, wget, python-requests, go-http-client, or custom scripts versus legitimate tools like Maven, Gradle, npm, or IDE plugins\n3. Examine the accessed_paths values to determine if sensitive repositories were targeted including those containing secrets, credentials, configuration files, internal tools, or proprietary source code\n4. Check if the src_ip belongs to known infrastructure by querying your CMDB or asset inventory - determine if it is a build server, developer workstation, or unknown/external system\n5. Correlate with authentication logs to identify how the user authenticated and whether there are signs of credential compromise such as password spraying, impossible travel, or unusual login times\n6. Investigate the behavior classification context - high_volume_scraping suggests automated exfiltration, broad_repo_enumeration indicates reconnaissance, repeated_targeted_access may indicate brute force or targeted theft\n7. Query historical access patterns for this user over the past 30 days to determine if this volume is anomalous compared to their baseline activity\n8. Check for concurrent suspicious activity from the same src_ip targeting other systems or applications in your environment\n9. Review any recent account changes, permission grants, or role modifications for the affected user account\n10. Contact the user or system owner directly to validate the activity is expected and authorized\n11. If malicious activity is confirmed, disable the user account, rotate any credentials that may have been exposed, and preserve Nexus access logs for forensic analysis\n12. Document findings and escalate to incident response if data exfiltration or supply chain compromise is suspected",
  "Blind_Spots_False_Positives": "Known Detection Gaps:\n- Low-and-slow enumeration staying below threshold values over extended periods\n- Access via internal proxies or load balancers masking true source IP\n- Direct database access bypassing web request logging\n- Legitimate service accounts with stolen credentials appearing as normal CI/CD activity\n- Unauthenticated/anonymous access to public repositories may not populate user field\n\nFalse Positive Scenarios:\n- CI/CD build pipelines (Jenkins, GitLab CI, Azure DevOps) downloading dependencies during large builds\n- Legitimate repository mirroring or backup processes\n- Maven/Gradle/npm dependency resolution for projects with many dependencies\n- Security scanning tools (Nexus IQ, Snyk, WhiteSource) auditing repositories\n- Developer IDE plugins pre-fetching artifacts for autocomplete\n- New project onboarding with first-time dependency downloads\n\nTuning Advice: Create allowlist for known CI/CD service accounts and build server IP ranges. Adjust thresholds based on 30-day baseline analysis.",
  "Required_Data_Sources": "index:nexus sourcetype:nexus:request_log",
  "First Created": "2026-01-24T02:46:33.000Z",
  "Last Modified": "2026-01-26T16:42:53.642Z",
  "Search String": "index=\"nexus\" sourcetype=\"nexus:request_log\" method=GET status=200\n| bin _time span=5m\n| stats count as request_count\n        dc(url_path) as unique_paths\n        dc(scope) as unique_repos\n        sum(bytes) as total_bytes\n        values(url_path) as accessed_paths\n        latest(user_agent) as user_agent\n        by _time, user, src_ip, host\n| where request_count > 50 OR unique_paths > 30 OR unique_repos > 5\n| eval behavior=case(\n    request_count > 200 AND unique_paths > 100, \"high_volume_scraping\",\n    unique_repos > 10, \"broad_repo_enumeration\",\n    request_count > 50 AND unique_paths < 5, \"repeated_targeted_access\",\n    1=1, \"suspicious_search_pattern\"\n)\n| eval bytes_mb=round(total_bytes/1024/1024, 2)\n| eval dest=host\n| table _time, user, src_ip, dest, request_count, unique_paths, unique_repos, bytes_mb, behavior, user_agent",
  "Splunk_App_Context": "search",
  "Search_Duration": "-15m",
  "Cron Schedule": "*/15 * * * *",
  "Schedule Window": "5",
  "Schedule Priority": "default",
  "Trigger Condition": "Number of results is greater than 0",
  "Throttling": {
    "enabled": 1,
    "fields": "user,src_ip",
    "period": "1h"
  },
  "Risk": [
    {
      "risk_object_field": "$user$",
      "risk_object_type": "user",
      "risk_score": 75
    },
    {
      "risk_object_field": "$dest$",
      "risk_object_type": "system",
      "risk_score": 75
    }
  ],
  "Notable Title": "Suspicious Nexus Repository Access: $behavior$ by $user$ from $src_ip$",
  "Notable Description": "User $user$ from source IP $src_ip$ exhibited suspicious repository access behavior classified as $behavior$ on $dest$. In a 5-minute window, the user made $request_count$ requests accessing $unique_paths$ unique paths across $unique_repos$ repositories, downloading approximately $bytes_mb$ MB of data. User agent: $user_agent$. Investigate for potential data harvesting, credential theft, or supply chain reconnaissance.",
  "Security Domain": "access",
  "Drilldown Name (Legacy)": "View Events Associated to this Notable on ",
  "Drilldown Search (Legacy)": "",
  "Drilldown Earliest Offset (Legacy)": "2592000",
  "Drilldown Latest Offset (Legacy)": "86400",
  "Mitre ID": [
    "T1213"
  ],
  "Proposed Test Plan": "1. Manual validation: Use curl/wget to make 60+ GET requests to repository paths within 5 minutes from test account\n2. Automated test: Deploy script enumerating 10+ different repository scopes to trigger broad_repo_enumeration\n3. Targeted access test: Make 75 requests to same 3 paths to trigger repeated_targeted_access behavior\n4. High-volume test: Execute scraping script downloading 250+ unique artifacts to validate high_volume_scraping detection\n5. Negative test: Verify normal developer activity (10-20 requests) does not trigger alert\n6. Service account test: Confirm allowlisted CI/CD accounts are properly excluded after tuning",
  "Drilldown Name 1": "Comprehensive User Investigation - Nexus Repository Activity",
  "Drilldown Search 1": "index=\"nexus\" sourcetype=\"nexus:request_log\" user=\"$user$\"\n| eval investigation_category=case(\n    status=200 AND method=\"GET\" AND (match(url_path, \"(?i)(secret|credential|password|key|token|config)\") OR match(scope, \"(?i)(internal|private|secure)\")), \"1_SENSITIVE_REPO_ACCESS\",\n    status IN (401, 403), \"2_ACCESS_DENIED_ATTEMPTS\",\n    status=404, \"3_PATH_ENUMERATION_404S\",\n    match(user_agent, \"(?i)(curl|wget|python|go-http|powershell|httpie|requests)\"), \"4_AUTOMATION_TOOL_ACCESS\",\n    match(user_agent, \"(?i)(maven|gradle|npm|pip|nuget|docker)\"), \"5_PACKAGE_MANAGER_ACCESS\",\n    method IN (\"PUT\", \"POST\", \"DELETE\"), \"6_WRITE_OPERATIONS\",\n    status=200 AND method=\"GET\", \"7_STANDARD_READ_ACCESS\",\n    1=1, \"9_OTHER_ACTIVITY\"\n)\n| eval key_indicator=case(\n    investigation_category==\"1_SENSITIVE_REPO_ACCESS\", \"SENSITIVE: \".url_path.\" (\".bytes.\" bytes)\",\n    investigation_category==\"2_ACCESS_DENIED_ATTEMPTS\", \"DENIED: \".status.\" - \".url_path,\n    investigation_category==\"3_PATH_ENUMERATION_404S\", \"NOT FOUND: \".url_path,\n    investigation_category==\"4_AUTOMATION_TOOL_ACCESS\", user_agent.\" -> \".url_path,\n    investigation_category==\"6_WRITE_OPERATIONS\", method.\": \".url_path,\n    1=1, method.\" \".url_path.\" [\".status.\"]\"\n)\n| stats\n    earliest(_time) as first_seen,\n    latest(_time) as last_seen,\n    count as event_count,\n    sum(bytes) as total_bytes,\n    dc(url_path) as unique_paths,\n    dc(scope) as unique_repos,\n    dc(src_ip) as unique_source_ips,\n    values(key_indicator) as indicators,\n    values(user_agent) as user_agents,\n    values(src_ip) as source_ips\n    by investigation_category, user\n| eval first_seen=strftime(first_seen, \"%Y-%m-%d %H:%M:%S\"),\n       last_seen=strftime(last_seen, \"%Y-%m-%d %H:%M:%S\"),\n       total_bytes_mb=round(total_bytes/1024/1024, 2)\n| sort investigation_category\n| rename\n    investigation_category as \"Investigation Category\",\n    user as \"Username\",\n    first_seen as \"First Seen\",\n    last_seen as \"Last Seen\",\n    event_count as \"Event Count\",\n    total_bytes_mb as \"Total MB Downloaded\",\n    unique_paths as \"Unique Paths\",\n    unique_repos as \"Unique Repositories\",\n    unique_source_ips as \"Unique Source IPs\",\n    indicators as \"Key Indicators\",\n    user_agents as \"User Agents\",\n    source_ips as \"Source IPs\"",
  "Drilldown Earliest 1": "-7d",
  "Drilldown Latest 1": "now",
  "Drilldown Name 2": "Cross-Source Correlation - Source IP Activity Across Environment",
  "Drilldown Search 2": "index IN (nexus, proxy, firewall, auth, web) src_ip=\"$src_ip$\"\n| eval investigation_category=case(\n    index=\"nexus\" AND sourcetype=\"nexus:request_log\", \"1_NEXUS_REPOSITORY_ACCESS\",\n    index=\"auth\" OR sourcetype=\"*auth*\" OR sourcetype=\"*login*\", \"2_AUTHENTICATION_EVENTS\",\n    index=\"proxy\" OR sourcetype=\"*proxy*\", \"3_PROXY_WEB_TRAFFIC\",\n    index=\"firewall\" OR sourcetype=\"*firewall*\", \"4_FIREWALL_CONNECTIONS\",\n    index=\"web\" OR sourcetype=\"*access*\", \"5_OTHER_WEB_APPLICATIONS\",\n    1=1, \"9_OTHER_ACTIVITY\"\n)\n| eval key_indicator=case(\n    investigation_category==\"1_NEXUS_REPOSITORY_ACCESS\", user.\" accessed \".url_path,\n    investigation_category==\"2_AUTHENTICATION_EVENTS\", coalesce(user, account).\" - \".coalesce(action, status),\n    investigation_category==\"3_PROXY_WEB_TRAFFIC\", coalesce(url, dest).\" [\".coalesce(category, \"uncategorized\").\"]\",\n    investigation_category==\"4_FIREWALL_CONNECTIONS\", src_ip.\" -> \".dest_ip.\":\".dest_port.\" (\".action.\")\",\n    1=1, sourcetype.\" event\"\n)\n| eval normalized_user=coalesce(user, account, src_user, \"unknown\")\n| stats\n    earliest(_time) as first_seen,\n    latest(_time) as last_seen,\n    count as event_count,\n    dc(index) as data_sources,\n    dc(host) as unique_hosts_touched,\n    values(key_indicator) as indicators,\n    values(normalized_user) as associated_users,\n    values(index) as indexes_seen\n    by investigation_category, src_ip\n| eval first_seen=strftime(first_seen, \"%Y-%m-%d %H:%M:%S\"),\n       last_seen=strftime(last_seen, \"%Y-%m-%d %H:%M:%S\")\n| sort investigation_category\n| rename\n    investigation_category as \"Investigation Category\",\n    src_ip as \"Source IP\",\n    first_seen as \"First Seen\",\n    last_seen as \"Last Seen\",\n    event_count as \"Event Count\",\n    data_sources as \"Data Sources\",\n    unique_hosts_touched as \"Unique Hosts\",\n    indicators as \"Key Indicators\",\n    associated_users as \"Associated Users\",\n    indexes_seen as \"Indexes\"",
  "Drilldown Earliest 2": "-7d",
  "Drilldown Latest 2": "now",
  "Drilldown Name 3": "User Baseline Comparison - Deviation Analysis",
  "Drilldown Search 3": "index=\"nexus\" sourcetype=\"nexus:request_log\" method=GET status=200 earliest=-30d\n| bin _time span=1d\n| stats count as daily_requests dc(url_path) as daily_unique_paths dc(scope) as daily_unique_repos by _time, user\n| stats avg(daily_requests) as avg_requests stdev(daily_requests) as stdev_requests avg(daily_unique_paths) as avg_paths avg(daily_unique_repos) as avg_repos latest(daily_requests) as latest_requests latest(daily_unique_paths) as latest_paths by user\n| eval deviation_score=round((latest_requests - avg_requests) / max(stdev_requests, 1), 2)\n| eval risk_level=case(deviation_score > 5, \"CRITICAL\", deviation_score > 3, \"HIGH\", deviation_score > 2, \"MEDIUM\", 1=1, \"LOW\")\n| where user=\"$user$\" OR deviation_score > 3\n| sort -deviation_score\n| rename user as \"Username\", avg_requests as \"Avg Daily Requests\", latest_requests as \"Latest Daily Requests\", deviation_score as \"Deviation Score\", risk_level as \"Risk Level\"",
  "Drilldown Earliest 3": "-7d",
  "Drilldown Latest 3": "now",
  "Drilldown Name 4": "Sensitive Repository Path Analysis",
  "Drilldown Search 4": "index=\"nexus\" sourcetype=\"nexus:request_log\" user=\"$user$\" status=200\n    (url_path=\"*secret*\" OR url_path=\"*credential*\" OR url_path=\"*password*\" OR url_path=\"*config*\" OR url_path=\"*key*\" OR url_path=\"*token*\" OR url_path=\"*internal*\" OR url_path=\"*private*\")\n| stats count as access_count sum(bytes) as total_bytes earliest(_time) as first_access latest(_time) as last_access values(src_ip) as source_ips by url_path, scope, user\n| eval first_access=strftime(first_access, \"%Y-%m-%d %H:%M:%S\"), last_access=strftime(last_access, \"%Y-%m-%d %H:%M:%S\"), total_mb=round(total_bytes/1024/1024, 2)\n| sort -access_count\n| rename url_path as \"Sensitive Path\", scope as \"Repository\", access_count as \"Access Count\", total_mb as \"MB Downloaded\", first_access as \"First Access\", last_access as \"Last Access\", source_ips as \"Source IPs\"",
  "Drilldown Earliest 4": "-7d",
  "Drilldown Latest 4": "now",
  "Drilldown Name 5": "User Agent and Automation Tool Analysis",
  "Drilldown Search 5": "index=\"nexus\" sourcetype=\"nexus:request_log\" user=\"$user$\"\n| eval tool_category=case(\n    match(user_agent, \"(?i)(curl|wget|httpie)\"), \"CLI_DOWNLOAD_TOOLS\",\n    match(user_agent, \"(?i)(python|requests|urllib)\"), \"PYTHON_AUTOMATION\",\n    match(user_agent, \"(?i)(go-http|golang)\"), \"GO_AUTOMATION\",\n    match(user_agent, \"(?i)(powershell|invoke-webrequest)\"), \"POWERSHELL_AUTOMATION\",\n    match(user_agent, \"(?i)(maven|gradle|ant)\"), \"JAVA_BUILD_TOOLS\",\n    match(user_agent, \"(?i)(npm|yarn|node)\"), \"NODEJS_PACKAGE_MANAGERS\",\n    match(user_agent, \"(?i)(pip|conda|poetry)\"), \"PYTHON_PACKAGE_MANAGERS\",\n    match(user_agent, \"(?i)(docker|containerd)\"), \"CONTAINER_TOOLS\",\n    match(user_agent, \"(?i)(intellij|eclipse|vscode)\"), \"IDE_PLUGINS\",\n    match(user_agent, \"(?i)(jenkins|gitlab|azure|bamboo|teamcity)\"), \"CI_CD_SYSTEMS\",\n    1=1, \"OTHER_UNKNOWN\"\n)\n| stats count as request_count dc(url_path) as unique_paths sum(bytes) as total_bytes values(user_agent) as user_agents by tool_category, user\n| eval total_mb=round(total_bytes/1024/1024, 2)\n| sort -request_count\n| rename tool_category as \"Tool Category\", request_count as \"Requests\", unique_paths as \"Unique Paths\", total_mb as \"MB Downloaded\", user_agents as \"User Agent Strings\"",
  "Drilldown Earliest 5": "-7d",
  "Drilldown Latest 5": "now",
  "Drilldown Name 6": "",
  "Drilldown Search 6": "",
  "Drilldown Earliest 6": null,
  "Drilldown Latest 6": null,
  "Drilldown Name 7": "",
  "Drilldown Search 7": "",
  "Drilldown Earliest 7": null,
  "Drilldown Latest 7": null,
  "Drilldown Name 8": "",
  "Drilldown Search 8": "",
  "Drilldown Earliest 8": null,
  "Drilldown Latest 8": null,
  "Drilldown Name 9": "",
  "Drilldown Search 9": "",
  "Drilldown Earliest 9": null,
  "Drilldown Latest 9": null,
  "Drilldown Name 10": "",
  "Drilldown Search 10": "",
  "Drilldown Earliest 10": null,
  "Drilldown Latest 10": null,
  "Drilldown Name 11": "",
  "Drilldown Search 11": "",
  "Drilldown Earliest 11": null,
  "Drilldown Latest 11": null,
  "Drilldown Name 12": "",
  "Drilldown Search 12": "",
  "Drilldown Earliest 12": null,
  "Drilldown Latest 12": null,
  "Drilldown Name 13": "",
  "Drilldown Search 13": "",
  "Drilldown Earliest 13": null,
  "Drilldown Latest 13": null,
  "Drilldown Name 14": "",
  "Drilldown Search 14": "",
  "Drilldown Earliest 14": null,
  "Drilldown Latest 14": null,
  "Drilldown Name 15": "",
  "Drilldown Search 15": "",
  "Drilldown Earliest 15": null,
  "Drilldown Latest 15": null
}